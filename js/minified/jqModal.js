(e=>{"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)})(function(r){r.fn.jqm=function(e){var t={overlay:50,closeoverlay:!0,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:h,ajaxText:"",target:h,modal:h,toTop:h,onShow:h,onHide:h,onLoad:h};return this.each(function(){if(this._jqm)return c[this._jqm].c=r.extend({},c[this._jqm].c,e);o++,this._jqm=o,c[o]={c:r.extend(t,r.jqm.params,e),a:h,w:r(this).addClass("jqmID"+o),s:o},t.trigger&&r(this).jqmAddTrigger(t.trigger)})},r.fn.jqmAddClose=function(e){return i(this,e,"jqmHide")},r.fn.jqmAddTrigger=function(e){return i(this,e,"jqmShow")},r.fn.jqmShow=function(e){return this.each(function(){r.jqm.open(this._jqm,e)})},r.fn.jqmHide=function(e){return this.each(function(){r.jqm.close(this._jqm,e)})},r.jqm={hash:{},open:function(e,t){var o=c[e],n=o.c,i="."+n.closeClass,s=0<(s=parseInt(o.w.css("z-index")))?s:3e3,a=r("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":s-1,opacity:n.overlay/100});return o.a||(o.t=t,o.a=!0,o.w.css("z-index",s),n.modal?(d[0]||setTimeout(function(){new u("bind")},1),d.push(e)):0<n.overlay?n.closeoverlay&&o.w.jqmAddClose(a):a=h,o.o=a?a.addClass(n.overlayClass).prependTo("body"):h,n.ajax?(s=n.target||o.w,e=n.ajax,s="string"==typeof s?r(s,o.w):r(s),e="@"===e.substr(0,1)?r(t).attr(e.substring(1)):e,s.html(n.ajaxText).load(e,function(){n.onLoad&&n.onLoad.call(this,o),i&&o.w.jqmAddClose(r(i,o.w)),f(o)})):i&&o.w.jqmAddClose(r(i,o.w)),n.toTop&&o.o&&o.w.before('<span id="jqmP'+o.w[0]._jqm+'"></span>').insertAfter(o.o),n.onShow?n.onShow(o):o.w.show(),f(o)),h},close:function(e){e=c[e];return e.a&&(e.a=h,d[0]&&(d.pop(),d[0]||new u("unbind")),e.c.toTop&&e.o&&r("#jqmP"+e.w[0]._jqm).after(e.w).remove(),e.c.onHide?e.c.onHide(e):(e.w.hide(),e.o&&e.o.remove())),h},params:{}};var o=0,c=r.jqm.hash,d=[],h=!1,f=function(e){void 0===e.c.focusField&&(e.c.focusField=0),0<=e.c.focusField&&t(e)},t=function(e){try{r(":input:visible",e.w)[parseInt(e.c.focusField,10)].focus()}catch(e){}},u=function(e){r(document)[e]("keypress",n)[e]("keydown",n)[e]("mousedown",n)},n=function(o){var e=c[d[d.length-1]],n=!r(o.target).parents(".jqmID"+e.s)[0];return n&&r(".jqmID"+e.s).each(function(){var e=r(this),t=e.offset();if(t.top<=o.pageY&&o.pageY<=t.top+e.height()&&t.left<=o.pageX&&o.pageX<=t.left+e.width())return n=!1}),!n},i=function(e,t,o){return e.each(function(){var e=this._jqm;r(t).each(function(){this[o]||(this[o]=[],r(this).click(function(){for(var e in{jqmShow:1,jqmHide:1})for(var t in this[e])c[this[e][t]]&&c[this[e][t]].w[e](this);return h})),this[o].push(e)})})}});