(r=>{"function"==typeof define&&define.amd?define(["jquery","./grid.base"],r):r(jQuery)})(function(z){z.jgrid.extend({setupFrozenRows:function(r){var g=z.extend({first:0,last:0,rowids:[],saveFirstLastId:!1,classes:""},r||{});return this.each(function(){if(!(!0===this.p.subGrid||!0===this.p.treeGrid||!0===this.p.cellEdit||this.p.scroll||!0===this.p.frozenColumns||!0===this.p.frozenRows||!0===this.p.grouping||g.first<=0&&g.last<=0&&0===g.rowids.length)){var r,s,i,o=this,e="border-box"===z("#"+z.jgrid.jqID(o.p.id)).css("box-sizing")?1:0,t="#"+z.jgrid.jqID(o.p.id),n="#gview_"+z.jgrid.jqID(o.p.id),d=document.getElementById("gbox_"+o.p.id).getBoundingClientRect().top,f=document.getElementById(o.p.id).getBoundingClientRect().top,h=z(n).width(),l=[],f=z('<div style="position:absolute;left:0px;top:'+(f-d-e)+'px;height:0px;overflow-x:hidden;" class="frozen-rdiv ui-jqgrid-rdiv"></div>');if(z(n).append(f),z(".frozen-rdiv",n).css("width",h-(z.jgrid.scrollbarWidth()+2)),l.push(z(".jqgfirstrow",t).clone(!0)),g.rowids&&0<g.rowids.length){for(r=0;r<g.rowids.length;r++)for(s=o.rows.length;s--;)if(o.rows[s].id===g.rowids[r]){l.push(z(o.rows[s]).clone(!0)),z(o.rows[s]).insertBefore(o.rows[r+1]);break}}else if(0<g.first)for(r=0;r<g.first;r++)l.push(z(o.rows[r+1]).clone(!0)),g.saveFirstLastId&&(g.rowids||(g.rowids=[]),g.rowids.push(o.rows[r+1].id));else{if(!(0<g.last))return;for(s=o.rows.length,r=0;r<g.last;r++)l.splice(1,0,z(o.rows[s-1]).clone(!0)),g.saveFirstLastId&&(g.rowids||(g.rowids=[]),g.rowids.unshift(o.rows[s-1].id)),z(o.rows[s-1]).insertBefore(o.rows[1])}f.css("height","auto");var w=z(t).clone(!0);for(w.children("tbody").empty(),s=0,i=l.length;s<i;s++)l[s].addClass(g.classes).appendTo(w);w.appendTo(f);var p=o.p.id+"_fr",d=(z(t,f).attr("id",p),p="#"+z.jgrid.jqID(p),z.jgrid.getMethod("getStyleUI")),e=o.p.styleUI+".common",c=d(e,"highlight",!0),a=d(e,"hover",!0);if(z(".frozen-rdiv",n).on("click","tr",function(){o.p.selrow&&z(o).jqGrid("resetSelection",o.p.selrow);var r=z(this).index();z(this).addClass(c).siblings().removeClass(c),o.p.selrow=this.id,z(".frozen-rdiv tr").eq(r).addClass(c).siblings().removeClass(c)}),z(p).on("click",function(){z(".frozen-rdiv tbody").children("tr").each(function(){z(this).removeClass(c)})}),z(n+" .ui-jqgrid-bdiv").first().on("scroll",function(){var r=this.scrollLeft;z(".frozen-rdiv").scrollLeft(r)}),z(".frozen-rdiv tr").hover(function(){var r=z(this).index();z(".frozen-rdiv tr").eq(r).addClass(a)},function(){var r=z(this).index();z(".frozen-rdiv tr").eq(r).removeClass(a)}),o.p.rownumbers){var u=!1;try{if(z(o.rows[0].cells).each(function(r){if(z(this).hasClass("jqgrid-rownumber"))return u=r,!1}),!1!==u){for(s=o.rows.length,r=1;r<s;)z(o.rows[r].cells[u]).html(r),r++;for(s=z(p)[0].rows.length,r=1;r<s;)z(p)[0].rows[r].cells[u].innerHTML=r,r++}}catch(r){}}o.grid.frbDiv=f,o.p.frozenRows=!0,o.p.frozenRowsPrm=g}})},destroyFrozenRows:function(r){return this.each(function(){this.grid.frbDiv.remove(),this.p.frozenRows=!1,r&&(this.p.frozenRowsPrm=null)})},setFrozenRows:function(r){return this.each(function(){0<this.p.records&&z(this).jqGrid("setupFrozenRows",r),z(this).on("jqGridAfterGridComplete.setFrozenRows",function(){this.p.frozenRowsPrm&&!z.isEmptyObject(this.p.frozenRowsPrm)?(z(this).jqGrid("destroyFrozenRows"),z(this).jqGrid("setupFrozenRows",this.p.frozenRowsPrm)):z(this).jqGrid("setupFrozenRows",r)}),z(this).on("jqGridResizeStop.setFrozenRows",function(){if(this.p.frozenRowsPrm)try{z(this).jqGrid("destroyFrozenRows");var r=0<this.p.frozenRowsPrm.last&&!this.p.frozenRowsPrm.saveFirstLastId&&0===this.p.frozenRowsPrm.first;r&&(this.p.frozenRowsPrm.first=this.p.frozenRowsPrm.last),z(this).jqGrid("setupFrozenRows",this.p.frozenRowsPrm),r&&(this.p.frozenRowsPrm.first=0)}catch(r){}})})}})});