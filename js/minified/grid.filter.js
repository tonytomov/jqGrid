!function(e){"function"==typeof define&&define.amd?define(["jquery","./grid.base","./grid.common"],e):e(jQuery)}(function(T){T.fn.jqFilter=function(e){if("string"==typeof e){var t,r=T.fn.jqFilter[e];if(r)return t=T.makeArray(arguments).slice(1),r.apply(this,t);throw"jqFilter - No such method: "+e}var O=T.extend(!0,{filter:null,columns:[],sortStrategy:null,onChange:null,afterRedraw:null,checkValues:null,error:!1,errmsg:"",errorcheck:!0,showQuery:!0,sopt:null,ops:[],operands:null,numopts:["eq","ne","lt","le","gt","ge","nu","nn","in","ni"],stropts:["eq","ne","bw","bn","ew","en","cn","nc","nu","nn","in","ni"],strarr:["text","string","blob"],groupOps:[{op:"AND",text:"AND"},{op:"OR",text:"OR"}],groupButton:!0,ruleButtons:!0,uniqueSearchFields:!1,direction:"ltr",addsubgrup:"Add subgroup",addrule:"Add rule",delgroup:"Delete group",delrule:"Delete rule",autoencode:!1,unaryOperations:[]},T.jgrid.filter,e||{});return this.each(function(){if(!this.filter){this.p=O,null!==this.p.filter&&void 0!==this.p.filter||(this.p.filter={groupOp:this.p.groupOps[0].op,rules:[],groups:[]}),null!=this.p.sortStrategy&&T.jgrid.isFunction(this.p.sortStrategy)&&this.p.columns.sort(this.p.sortStrategy);var e,t,r=this.p.columns.length,b=/msie/i.test(navigator.userAgent)&&!window.opera;if(this.p.initFilter=T.extend(!0,{},this.p.filter),r){for(e=0;e<r;e++)(t=this.p.columns[e]).stype?t.inputtype=t.stype:t.inputtype||(t.inputtype="text"),t.sorttype?t.searchtype=t.sorttype:t.searchtype||(t.searchtype="string"),void 0===t.hidden&&(t.hidden=!1),t.label||(t.label=t.name),t.index&&(t.name=t.index),t.hasOwnProperty("searchoptions")||(t.searchoptions={}),t.hasOwnProperty("searchrules")||(t.searchrules={}),void 0===t.search?t.inlist=!0:t.inlist=t.search;var S=function(){return T("#"+T.jgrid.jqID(O.id))[0]||null},s=S(),F=T.jgrid.styleUI[s.p.styleUI||"jQueryUI"].filter,x=T.jgrid.styleUI[s.p.styleUI||"jQueryUI"].common,o=(this.p.showQuery&&T(this).append("<table class='queryresult "+F.table_widget+"' style='display:block;max-width:440px;border:0px none;' dir='"+this.p.direction+"'><tbody><tr><td class='query'></td></tr></tbody></table>"),function(e,t){var r=[!0,""],s=S();if(T.jgrid.isFunction(t.searchrules))r=t.searchrules.call(s,e,t);else if(T.jgrid&&T.jgrid.checkValues)try{r=T.jgrid.checkValues.call(s,e,-1,t.searchrules,t.label)}catch(e){}r&&r.length&&!1===r[0]&&(O.error=!r[0],O.errmsg=r[1])});this.onchange=function(){return this.p.error=!1,this.p.errmsg="",!!T.jgrid.isFunction(this.p.onChange)&&this.p.onChange.call(this,this.p)},this.reDraw=function(){T(this).find("table.group").first().remove();var e=this.createTableForGroup(O.filter,null);T(this).append(e),T.jgrid.isFunction(this.p.afterRedraw)&&this.p.afterRedraw.call(this,this.p)},this.createTableForGroup=function(s,e){var a=this,t=T("<table class='group "+F.table_widget+" ui-search-table' style='border:0px none;'><tbody></tbody></table>"),r="left",i=("rtl"===this.p.direction&&(r="right",t.attr("dir","rtl")),null===e&&t.append("<tr class='error' style='display:none;'><th colspan='5' class='"+x.error+"' align='"+r+"'></th></tr>"),T("<tr></tr>")),r=(t.append(i),T("<th colspan='5' align='"+r+"'></th>"));if(i.append(r),!0===this.p.ruleButtons){for(var o,l=T("<select size='1' name='select_group_op' class='opsel "+F.srSelect+"'></select>"),n=(r.append(l),""),p=0;p<O.groupOps.length;p++)o=s.groupOp===a.p.groupOps[p].op?" selected='selected'":"",n+="<option value='"+a.p.groupOps[p].op+"'"+o+">"+a.p.groupOps[p].text+"</option>";l.append(n).on("change",function(){s.groupOp=T(l).val(),a.onchange()})}var c,i="<span></span>";if(this.p.groupButton&&(i=T("<input type='button' value='+ {}' title='"+a.p.addsubgrup+"' class='add-group "+x.button+"' name='newsubgroup'/>")).on("click",function(){return void 0===s.groups&&(s.groups=[]),s.groups.push({groupOp:O.groupOps[0].op,rules:[],groups:[]}),a.reDraw(),a.onchange(),!1}),r.append(i),!0===this.p.ruleButtons&&((i=T("<input type='button' value='+' title='"+a.p.addrule+"' class='add-rule ui-add "+x.button+"'/ name='newrule'>")).on("click",function(){for(void 0===s.rules&&(s.rules=[]),p=0;p<a.p.columns.length;p++){var e=void 0===a.p.columns[p].search||a.p.columns[p].search,t=!0===a.p.columns[p].hidden;if(!0===a.p.columns[p].searchoptions.searchhidden&&e||e&&!t){c=a.p.columns[p];break}}var r;return c&&(r=c.searchoptions.sopt||a.p.sopt||(-1!==T.inArray(c.searchtype,a.p.strarr)?a.p.stropts:a.p.numopts),s.rules.push({field:c.name,op:r[0],data:""}),a.reDraw()),!1}),r.append(i)),null!==e&&(i=T("<input type='button' value='-' title='"+a.p.delgroup+"' class='delete-group "+x.button+"'/ name='delgroup'>"),r.append(i),i.on("click",function(){for(p=0;p<e.groups.length;p++)if(e.groups[p]===s){e.groups.splice(p,1);break}return a.reDraw(),a.onchange(),!1})),void 0!==s.groups)for(p=0;p<s.groups.length;p++){var d=T("<tr></tr>"),u=(t.append(d),T("<td class='first'></td>")),u=(d.append(u),T("<td colspan='4'></td>"));u.append(this.createTableForGroup(s.groups[p],s)),d.append(u)}void 0===s.groupOp&&(s.groupOp=a.p.groupOps[0].op);var h=a.p.ruleButtons&&a.p.uniqueSearchFields;if(h)for(f=0;f<a.p.columns.length;f++)a.p.columns[f].inlist&&(a.p.columns[f].search=!0);if(void 0!==s.rules)for(p=0;p<s.rules.length;p++)if(t.append(this.createTableRowForRule(s.rules[p],s)),h)for(var g=s.rules[p].field,f=0;f<a.p.columns.length;f++)if(g===a.p.columns[f].name){a.p.columns[f].search=!1;break}return t},this.createTableRowForRule=function(i,e){for(var o,l,n,t,p,c=this,d=S(),r=T("<tr></tr>"),s="",a=(r.append("<td class='first'></td>"),T("<td class='columns'></td>")),u=(r.append(a),T("<select size='1' name='select_field' class='"+F.srSelect+"'></select>")),h=[],g=(a.append(u),u.on("change",function(){var e;for(c.p.ruleButtons&&c.p.uniqueSearchFields&&(t=parseInt(T(this).data("curr"),10),e=this.selectedIndex,0<=t)&&(c.p.columns[t].search=!0,T(this).data("curr",e),c.p.columns[e].search=!1),i.field=T(u).val(),l=T(this).parents("tr").first(),T(".data",l).empty(),f=0;f<c.p.columns.length;f++)if(c.p.columns[f].name===i.field){n=c.p.columns[f];break}if(n){n.searchoptions.id=T.jgrid.randId(),n.searchoptions.name=i.field,n.searchoptions.oper="filter",!b||"text"!==n.inputtype||n.searchoptions.size||(n.searchoptions.size=10);var t,r=T.jgrid.createEl.call(d,n.inputtype,n.searchoptions,"",!0,c.p.ajaxSelectOptions||{},!0),s=(T(r).addClass("input-elm "+("select"===n.inputtype?F.srSelect:F.srInput)),o=n.searchoptions.sopt||c.p.sopt||(-1!==T.inArray(n.searchtype,c.p.strarr)?c.p.stropts:c.p.numopts),""),a=0;for(h=[],T.each(c.p.ops,function(){h.push(this.oper)}),f=0;f<o.length;f++)-1!==(p=T.inArray(o[f],h))&&(0===a&&(i.op=c.p.ops[p].oper),s+="<option value='"+c.p.ops[p].oper+"'>"+c.p.ops[p].text+"</option>",a++);T(".selectopts",l).empty().append(s),T(".selectopts",l)[0].selectedIndex=0,T.jgrid.msie()&&T.jgrid.msiever()<9&&(t=parseInt(T("select.selectopts",l)[0].offsetWidth,10)+1,T(".selectopts",l).width(t),T(".selectopts",l).css("width","auto")),T(".data",l).append(r),T.jgrid.bindEv.call(d,r,n.searchoptions),T(".input-elm",l).on("change",function(e){e=e.target;"custom"===n.inputtype&&T.jgrid.isFunction(n.searchoptions.custom_value)?i.data=n.searchoptions.custom_value.call(d,T(".customelement",this),"get"):i.data=T(e).val(),"select"===n.inputtype&&n.searchoptions.multiple&&(i.data=i.data.join(",")),c.onchange()}),setTimeout(function(){i.data=T(r).val(),("nu"===i.op||"nn"===i.op||0<=T.inArray(i.op,c.p.unaryOperations))&&(T(r).attr("readonly","true"),T(r).attr("disabled","true")),"select"===n.inputtype&&n.searchoptions.multiple&&Array.isArray(i.data)&&(i.data=i.data.join(",")),c.onchange()},0)}}),0),f=0;f<c.p.columns.length;f++){var m=void 0===c.p.columns[f].search||c.p.columns[f].search,y=!0===c.p.columns[f].hidden;(!0===c.p.columns[f].searchoptions.searchhidden&&m||m&&!y)&&(t="",i.field===c.p.columns[f].name&&(t=" selected='selected'",g=f),s+="<option value='"+c.p.columns[f].name+"'"+t+">"+c.p.columns[f].label+"</option>")}u.append(s),u.data("curr",g);var a=T("<td class='operators'></td>"),v=(r.append(a),(n=O.columns[g]).searchoptions.id=T.jgrid.randId(),!b||"text"!==n.inputtype||n.searchoptions.size||(n.searchoptions.size=10),n.searchoptions.name=i.field,n.searchoptions.oper="filter",T.jgrid.createEl.call(d,n.inputtype,n.searchoptions,i.data,!0,c.p.ajaxSelectOptions||{},!0)),j=(("nu"===i.op||"nn"===i.op||0<=T.inArray(i.op,c.p.unaryOperations))&&(T(v).attr("readonly","true"),T(v).attr("disabled","true")),T("<select size='1' name='select_oper' class='selectopts "+F.srSelect+"'></select>"));for(a.append(j),j.on("change",function(){i.op=T(j).val(),l=T(this).parents("tr").first();var e=T(".input-elm",l)[0];"nu"===i.op||"nn"===i.op||0<=T.inArray(i.op,c.p.unaryOperations)?(i.data="","SELECT"!==e.tagName.toUpperCase()&&(e.value=""),e.setAttribute("readonly","true"),e.setAttribute("disabled","true")):("SELECT"===e.tagName.toUpperCase()&&(i.data=e.value),e.removeAttribute("readonly"),e.removeAttribute("disabled")),c.onchange()}),o=n.searchoptions.sopt||c.p.sopt||(-1!==T.inArray(n.searchtype,c.p.strarr)?c.p.stropts:c.p.numopts),s="",T.each(c.p.ops,function(){h.push(this.oper)}),f=0;f<o.length;f++)-1!==(p=T.inArray(o[f],h))&&(t=i.op===c.p.ops[p].oper?" selected='selected'":"",s+="<option value='"+c.p.ops[p].oper+"'"+t+">"+c.p.ops[p].text+"</option>");j.append(s);a=T("<td class='data'></td>"),r.append(a),a.append(v),T.jgrid.bindEv.call(d,v,n.searchoptions),T(v).addClass("input-elm "+("select"===n.inputtype?F.srSelect:F.srInput)).on("change",function(){i.data="custom"===n.inputtype?n.searchoptions.custom_value.call(d,T(".customelement",this),"get"):T(this).val(),c.onchange()}),a=T("<td></td>");return r.append(a),!0===this.p.ruleButtons&&(v=T("<input type='button' value='-' title='"+c.p.delrule+"' class='delete-rule ui-del "+x.button+"'/ name='delrule'>"),a.append(v),v.on("click",function(){for(f=0;f<e.rules.length;f++)if(e.rules[f]===i){e.rules.splice(f,1);break}return c.reDraw(),c.onchange(),!1})),r},this.getStringForGroup=function(e){var t,r="(";if(void 0!==e.groups)for(t=0;t<e.groups.length;t++){1<r.length&&(r+=" "+e.groupOp+" ");try{r+=this.getStringForGroup(e.groups[t])}catch(e){alert(e)}}if(void 0!==e.rules)try{for(t=0;t<e.rules.length;t++)1<r.length&&(r+=" "+e.groupOp+" "),r+=this.getStringForRule(e.rules[t])}catch(e){alert(e)}return"()"===(r+=")")?"":r},this.getStringForRule=function(e){for(var t,r,s="",a="",i=0;i<this.p.ops.length;i++)if(this.p.ops[i].oper===e.op){s=this.p.operands.hasOwnProperty(e.op)?this.p.operands[e.op]:"",a=this.p.ops[i].oper;break}for(i=0;i<this.p.columns.length;i++)if(this.p.columns[i].name===e.field){t=this.p.columns[i];break}return void 0===t?"":(r=this.p.autoencode?T.jgrid.htmlEncode(e.data):e.data,"bw"!==a&&"bn"!==a||(r+="%"),"ew"!==a&&"en"!==a||(r="%"+r),"cn"!==a&&"nc"!==a||(r="%"+r+"%"),"in"!==a&&"ni"!==a||(r=" ("+r+")"),O.errorcheck&&o(e.data,t),-1!==T.inArray(t.searchtype,["int","integer","float","number","currency"])||"nn"===a||"nu"===a||0<=T.inArray(e.op,this.p.unaryOperations)?e.field+" "+s+" "+r:e.field+" "+s+' "'+r+'"')},this.resetFilter=function(){this.p.filter=T.extend(!0,{},this.p.initFilter),this.reDraw(),this.onchange()},this.hideError=function(){T("th."+x.error,this).html(""),T("tr.error",this).hide()},this.showError=function(){T("th."+x.error,this).html(T.jgrid.stripScript(this.p.errmsg)),T("tr.error",this).show()},this.toUserFriendlyString=function(){return this.getStringForGroup(O.filter)},this.toString=function(){var a=this;return function e(t){var r,s="(";if(void 0!==t.groups)for(r=0;r<t.groups.length;r++)1<s.length&&(s+="OR"===t.groupOp?" || ":" && "),s+=e(t.groups[r]);if(void 0!==t.rules)for(r=0;r<t.rules.length;r++)1<s.length&&(s+="OR"===t.groupOp?" || ":" && "),s+=function(e){if(a.p.errorcheck){for(var t,r=0;r<a.p.columns.length;r++)if(a.p.columns[r].name===e.field){t=a.p.columns[r];break}t&&o(e.data,t)}return e.op+"(item."+e.field+",'"+e.data+"')"}(t.rules[r]);return"()"==(s+=")")?"":s}(this.p.filter)},this.reDraw(),this.p.showQuery&&this.onchange(),this.filter=!0}}})},T.extend(T.fn.jqFilter,{toSQLString:function(){var e="";return this.each(function(){e=this.toUserFriendlyString()}),e},filterData:function(){var e;return this.each(function(){e=this.p.filter}),e},getParameter:function(r){var s=null;return void 0!==r&&this.each(function(e,t){t.p.hasOwnProperty(r)&&(s=t.p[r])}),s||this[0].p},resetFilter:function(){return this.each(function(){this.resetFilter()})},addFilter:function(e){"string"==typeof e&&(e=T.jgrid.parse(e)),this.each(function(){this.p.filter=e,this.reDraw(),this.onchange()})}}),T.extend(T.jgrid,{filterRefactor:function(e){var t,r,s,a,i,o,l={};try{if((l="string"==typeof e.ruleGroup?T.jgrid.parse(e.ruleGroup):e.ruleGroup).rules&&l.rules.length)for(t=l.rules,r=0;r<t.length;r++)o=(s=t[r]).field,-1<T.inArray(o,e.ssfield)&&1<(a=s.data.split(e.splitSelect)).length&&(void 0===l.groups&&(l.groups=[]),i={groupOp:e.groupOpSelect,groups:[],rules:[]},l.groups.push(i),T.each(a,function(e){a[e]&&i.rules.push({data:a[e],op:s.op,field:s.field})}),t.splice(r,1),r--)}catch(e){}return l}}),T.jgrid.extend({filterToolbar:function(G){var s=T.jgrid.getRegional(this[0],"search");return G=T.extend({autosearch:!0,autosearchDelay:500,searchOnEnter:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,onClearSearchValue:null,url:"",stringResult:!1,groupOp:"AND",defaultSearch:"bw",searchOperators:!1,resetIcon:"x",splitSelect:",",groupOpSelect:"OR",errorcheck:!0,operands:{eq:"==",ne:"!",lt:"<",le:"<=",gt:">",ge:">=",bw:"^",bn:"!^",in:"=",ni:"!=",ew:"|",en:"!@",cn:"~",nc:"!~",nu:"#",nn:"!#",bt:"..."},disabledKeys:[9,16,17,18,19,20,33,34,35,36,37,38,39,40,30,45,112,113,114,115,116,117,118,119,120,121,122,123,144,145]},s,G||{}),this.each(function(){var w=this,I=[];if(!w.p.filterToolbar){if(T(w).data("filterToolbar")||T(w).data("filterToolbar",G),w.p.force_regional&&(G=T.extend(G,s)),void 0!==w.p.customFilterDef)for(var e in w.p.customFilterDef)w.p.customFilterDef.hasOwnProperty(e)&&!G.operands.hasOwnProperty(e)&&(G.odata.push({oper:e,text:w.p.customFilterDef[e].text}),G.operands[e]=w.p.customFilterDef[e].operand,!0===w.p.customFilterDef[e].unary)&&I.push(e);var u,h,t,g,f=T.jgrid.styleUI[w.p.styleUI||"jQueryUI"].filter,p=T.jgrid.styleUI[w.p.styleUI||"jQueryUI"].common,m=T.jgrid.styleUI[w.p.styleUI||"jQueryUI"].base,y=function(e){void 0===e&&(e=1);var r,s,a,i,o={},l=0,n={},p=!1,c=[],d=[],u={},h=[],g=!1,f=[!0,"",""],m=!1;if(T.each(w.p.colModel,function(){var e,t=!1;if(s=this.index||this.name,i=this.searchoptions||{},!0===this.frozen&&!0===w.p.frozenColumns?(e=T("#gs_"+w.p.idPrefix+T.jgrid.jqID(this.name),w.grid.fhDiv),t=!0):e=T("#gs_"+w.p.idPrefix+T.jgrid.jqID(this.name),w.grid.hDiv),void 0===e[0]&&(e=T("#gs_"+w.p.idPrefix+T.jgrid.jqID(this.name),w.grid.hDiv)),a=G.searchOperators&&i.searchOperMenu?e.parents("table.ui-search-table").find("td.ui-search-oper").children("a").attr("soper")||G.defaultSearch:i.sopt?i.sopt[0]:"select"===this.stype?"eq":G.defaultSearch,"custom"===this.stype&&T.jgrid.isFunction(i.custom_value)&&0<e.length?(r=i.custom_value.call(w,e,"get"),h.push(s)):r=e.val(),"select"===this.stype&&i.multiple&&Array.isArray(r)?r=0<r.length?(p=!0,c.push(s),1===r.length?r[0]:r):"":"bt"!==a&&"text"===this.stype&&!0===i.splitSearchWord&&d.push(s),this.searchrules&&G.errorcheck&&(T.jgrid.isFunction(this.searchrules)?f=this.searchrules.call(w,r,this):T.jgrid&&T.jgrid.checkValues&&(f=T.jgrid.checkValues.call(w,r,-1,this.searchrules,this.label||this.name)),f)&&f.length&&!1===f[0])return this.searchrules.hasOwnProperty("validationError")&&(m=this.searchrules.validationError),!1;if("bt"===a&&(g=!0),t&&"cb"!==s&&"rn"!==s&&"subgrid"!==s&&"sc"!==s&&(u[s]=r),r||"nu"===a||"nn"===a||0<=T.inArray(a,I))o[s]=r,n[s]=a,l++;else try{delete w.p.postData[s]}catch(e){}}),!1===f[0])T.jgrid.isFunction(m)?m.call(w,f[1]):(y=T.jgrid.getRegional(w,"errors"),T.jgrid.info_dialog(y.errcap,f[1],"",{styleUI:w.p.styleUI}));else{var t,y=0<l;if(!0===G.stringResult||"local"===w.p.datatype||!0===G.searchOperators){var v,j,b,S,F,x,O='{"groupOp":"'+G.groupOp+'","rules":[',D=0;if(T.each(o,function(e,t){0<D&&(O+=","),O=(O=(O+='{"field":"'+e+'",')+'"op":"'+n[e]+'",')+'"data":"'+(t+="").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',D++}),O+="]}",p&&(v=T.jgrid.filterRefactor({ruleGroup:O,ssfield:c,splitSelect:G.splitSelect,groupOpSelect:G.groupOpSelect})),g&&(v=T.isPlainObject(v)?v:T.jgrid.parse(O)).rules&&v.rules.length)for(j=v.rules,b=0;b<j.length;b++)"bt"===(S=j[b]).op&&1<(F=S.data.split("...")).length&&(void 0===v.groups&&(v.groups=[]),x={groupOp:"AND",groups:[],rules:[]},v.groups.push(x),T.each(F,function(e){F[e]&&x.rules.push({data:F[e],op:0===e?"ge":"le",field:S.field})}),j.splice(b,1),b--);d.length&&(v=T.jgrid.filterRefactor({ruleGroup:O,ssfield:d,splitSelect:i.splitSearchSeparator||";",groupOpSelect:"OR"})),(g||p||d.length)&&(O=JSON.stringify(v)),!0===w.p.mergeSearch&&w.p.searchModules.hasOwnProperty("filterToolbar")&&!1!==w.p.searchModules.filterToolbar?(w.p.searchModules.filterToolbar=0<D?O:null,y=!0,T.extend(w.p.postData,{filters:T.jgrid.splitSearch(w.p.searchModules)})):T.extend(w.p.postData,{filters:O}),T.each(["searchField","searchString","searchOper"],function(e,t){w.p.postData.hasOwnProperty(t)&&delete w.p.postData[t]})}else T.extend(w.p.postData,o);G.url&&(t=w.p.url,T(w).jqGrid("setGridParam",{url:G.url}));var q="stop"===T(w).triggerHandler("jqGridToolbarBeforeSearch");(q=!q&&T.jgrid.isFunction(G.beforeSearch)?G.beforeSearch.call(w):q)||T(w).jqGrid("setGridParam",{search:y}).trigger("reloadGrid",[{page:e}]),t&&T(w).jqGrid("setGridParam",{url:t}),T(w).triggerHandler("jqGridToolbarAfterSearch"),T.jgrid.isFunction(G.afterSearch)&&G.afterSearch.call(w),w.p.frozenColumns&&_(u,n,c,h)}},_=function(e,i,t,o){var l=T(".ui-search-toolbar",w.grid.hDiv),n=T(".ui-search-toolbar",w.grid.fhDiv);T.each(e,function(e,t){var r,s,a;G.searchOperators&&(r=i[e])&&(T(".ui-search-table .ui-search-oper [colname='"+e+"']",l).attr({soper:r}).text(G.operands[r]),T(".ui-search-table .ui-search-oper [colname='"+e+"']",n).attr({soper:r}).text(G.operands[r])),-1<T.inArray(e,o)?(r=T.jgrid.getElemByAttrVal(w.p.colModel,"name",e))&&r.searchoptions&&(r=r.searchoptions||{},T.jgrid.isFunction(r.custom_value))&&(s=T("#gs_"+w.p.idPrefix+T.jgrid.jqID(e),w.grid.fhDiv),a=T("#gs_"+w.p.idPrefix+T.jgrid.jqID(e),w.grid.hDiv),r.custom_value.call(w,s,"set",t),r.custom_value.call(w,a,"set",t)):(T("#gs_"+w.p.idPrefix+T.jgrid.jqID(e),l).val(t),T("#gs_"+w.p.idPrefix+T.jgrid.jqID(e),n).val(t).focus())})},v=T("<tr class='ui-search-toolbar' role='row'></tr>"),j=(G.restoreFromFilters&&(t=!0===w.p.mergeSearch&&w.p.searchModules.hasOwnProperty("filterToolbar")&&!1!==w.p.searchModules.filterToolbar?w.p.searchModules.filterToolbar:w.p.postData.filters)&&("string"==typeof t&&(t=T.jgrid.parse(t)),h=!(!t.rules||!t.rules.length)&&t.rules),new Set(G.disabledKeys));if(j.size!==G.disabledKeys.length)for(var r=0;r<G.disabledKeys.length;r++)(j=new Set).add(G.disabledKeys[r]);s.filterFor&&(g=s.filterFor),w.p.colSpanHeader.length&&T(w).jqGrid("destroyColSpanHeader",!1),T.each(w.p.colModel,function(e){var t,r,s,a=this,i="",o="=",l=T("<th role='columnheader' class='"+m.headerBox+" ui-th-"+w.p.direction+" "+(a.labelClasses||"")+"' id='gsh_"+w.p.id+"_"+a.name+"'></th>"),n=T('<div><span aria-label="empty" style="display: none;">empty</span></div>'),p=T("<table class='ui-search-table' cellspacing='0'><tr><td class='ui-search-oper' headers=''></td><td class='ui-search-input' headers=''></td><td class='ui-search-clear' headers=''></td></tr></table>");if(!0===this.hidden&&T(l).css("display","none"),this.search=!1!==this.search,void 0===this.stype&&(this.stype="text"),this.searchoptions=this.searchoptions||{},void 0===this.searchoptions.searchOperMenu&&(this.searchoptions.searchOperMenu=!0),e=void 0!==g?g+" "+w.p.colNames[e]:w.p.colNames[e],t=T.extend({},this.searchoptions,{name:a.index||a.name,id:"gs_"+w.p.idPrefix+a.name,oper:"search",title:e}),this.search){if(G.restoreFromFilters&&h)for(var c=!1,d=0;d<h.length;d++)if(h[d].field)if((a.index||a.name)===h[d].field){c=h[d];break}if(G.searchOperators){for(r=t.sopt?t.sopt[0]:"select"===a.stype?"eq":G.defaultSearch,G.restoreFromFilters&&c&&(r=c.op),s=0;s<G.odata.length;s++)if(G.odata[s].oper===r){o=G.operands[r]||"";break}e=null!=t.searchtitle?t.searchtitle:G.operandTitle,i=this.searchoptions.searchOperMenu?"<a title='"+e+"' soper='"+r+"' class='soptclass' colname='"+this.name+"'>"+o+"</a>":""}switch(T("td",p).eq(0).attr("columname",a.name).append(i),void 0===t.clearSearch&&(t.clearSearch=!0),t.clearSearch?(e=G.resetTitle||"Clear Search Value",T("td",p).eq(2).append("<a title='"+e+"' tabindex='0' style='padding-right: 0.3em;padding-left: 0.3em;' class='clearsearchclass'>"+G.resetIcon+"</a>")):T("td",p).eq(2).hide(),this.surl&&(t.dataUrl=this.surl),e="",t.defaultValue&&(e=T.jgrid.isFunction(t.defaultValue)?t.defaultValue.call(w):t.defaultValue),G.restoreFromFilters&&c&&(e=c.data),e=T.jgrid.createEl.call(w,this.stype,t,e,!1,T.extend({},T.jgrid.ajaxOptions,w.p.ajaxSelectOptions||{})),"custom"!==this.stype&&("select"===this.stype?T(e).addClass(f.srSelect):T(e).addClass(f.srInput)),T("td",p).eq(1).append(e),T(n).append(p),null==t.dataEvents&&(t.dataEvents=[]),this.stype){case"select":!0===G.autosearch&&t.dataEvents.push({type:"change",fn:function(){return y(),!1}});break;case"text":case"custom":!0===G.autosearch&&(G.searchOnEnter?t.dataEvents.push({type:"keypress",fn:function(e){return 13===(e.charCode||e.keyCode||0)?(e.preventDefault(),y(),!1):this}}):t.dataEvents.push({type:"keydown",fn:function(e){var t=e.which;if(!j.has(t)){if(13===t)return e.preventDefault(),!1;u&&clearTimeout(u),u=setTimeout(function(){y()},G.autosearchDelay)}}}))}T.jgrid.bindEv.call(w,e,t)}T(l).append(n),T(v).append(l),G.searchOperators&&""!==i||T("td",p).eq(0).hide()}),T("table thead",w.grid.hDiv).append(v),G.searchOperators&&(T(".soptclass",v).click(function(e){var t=T(this).offset();!function(s,e,t){T("#sopt_menu").remove(),e=parseInt(e,10),t=parseInt(t,10)+18;var r,a='<ul id="sopt_menu" class="ui-search-menu modal-content" role="menu" tabindex="0" style="font-size:'+(T(".ui-jqgrid").css("font-size")||"11px")+";left:"+e+"px;top:"+t+'px;">',i=T(s).attr("soper"),o=[],e=T(s).attr("colname"),l=T.jgrid.getElemByAttrVal(w.p.colModel,"name",e,!0);if(-1!==l){var t=w.p.colModel[l],n=T.extend({},t.searchoptions);for(n.sopt||(n.sopt=[],n.sopt[0]="select"===t.stype?"eq":G.defaultSearch),T.each(G.odata,function(){o.push(this.oper)}),l=0;l<n.sopt.length;l++)-1!==(r=T.inArray(n.sopt[l],o))&&(a+='<li class="ui-menu-item '+(i===G.odata[r].oper?p.highlight:"")+'" role="presentation"><a class="'+p.cornerall+' g-menu-item" tabindex="0" role="menuitem" value="'+G.odata[r].oper+'" oper="'+G.operands[G.odata[r].oper]+'"><table class="ui-common-table"><tr><td class="opersign">'+G.operands[G.odata[r].oper]+"</td><td>"+G.odata[r].text+"</td></tr></table></a></li>");a+="</ul>",T("body").append(a),T("#sopt_menu").addClass("ui-menu "+f.menu_widget),T("#sopt_menu > li > a").hover(function(){T(this).addClass(p.hover)},function(){T(this).removeClass(p.hover)}).click(function(){var e,t=T(this).attr("value"),r=T(this).attr("oper");T(w).triggerHandler("jqGridToolbarSelectOper",[t,r,s]),T("#sopt_menu").hide(),T(s).text(r).attr("soper",t),w.p.frozenColumns&&T(s).parents("div.frozen-div").length&&0<=(e=T(s).parents("th").index())&&T("#gview_"+T.jgrid.jqID(w.p.id)+" .ui-jqgrid-hdiv .ui-search-toolbar th").eq(e).find("a.soptclass").text(r).attr("soper",t),!0===G.autosearch&&(e=T(s).parent().next().children()[0],T(e).val()||"nu"===t||"nn"===t||0<=T.inArray(t,I))&&y()})}}(this,t.left,t.top),e.stopPropagation()}),T("body").on("click",function(e){"soptclass"!==e.target.className&&T("#sopt_menu").remove()})),T(".clearsearchclass",v).click(function(){var e,t=T(this).parents("tr").first(),r=T("td.ui-search-oper",t).attr("columname"),s=T("td.ui-search-oper a",t).attr("soper");if(-1===(r=T.jgrid.getElemByAttrVal(w.p.colModel,"name",r,!0)))return!1;var a=w.p.colModel[r],i=T.extend({},a.searchoptions||{}),o=i.defaultValue||"",l=("select"===a.stype?(l=T("td.ui-search-input select",t),o?l.val(o):l[0].selectedIndex=0):(l=T("td.ui-search-input input",t)).val(o),T(w).triggerHandler("jqGridToolbarClearVal",[l[0],r,i,o]),T.jgrid.isFunction(G.onClearSearchValue)&&G.onClearSearchValue.call(w,l[0],r,i,o),"");("nu"===s||"nn"===s||0<=T.inArray(s,I))&&(e=i.sopt?i.sopt[0]:"select"===a.stype?"eq":G.defaultSearch,l=null!=w.p.customFilterDef&&null!=w.p.customFilterDef[e]?w.p.customFilterDef[e].operand:G.operands[e]||"",(e===s?T("td.ui-search-oper a",t).attr("soper","dummy"):T("td.ui-search-oper a",t).attr("soper",e)).text(l)),!0===G.autosearch&&(y(),e===s)&&T("td.ui-search-oper a",t).attr("soper",e).text(l)}),T(".clearsearchclass",v).keydown(function(e){13===e.keyCode&&(e.preventDefault(),T(".clearsearchclass",v).trigger("click"))}),T(w.grid.hDiv).on("scroll",function(e){w.grid.hScroll||(w.grid.bScroll=!0,w.grid.bDiv.scrollLeft=w.grid.hDiv.scrollLeft,w.p.footerrow&&(w.grid.sDiv.scrollLeft=w.grid.bDiv.scrollLeft),w.p.headerrow&&(w.grid.hrDiv.scrollLeft=w.grid.bDiv.scrollLeft)),w.grid.hScroll=!1}),w.p.colSpanHeader.length&&setTimeout(function(){T(w).jqGrid("setColSpanHeader")},0),this.p.filterToolbar=!0,this.triggerToolbar=y,this.clearToolbar=function(e){var t,r,s,a,i,o,l={},n={},p=0,c=(e="boolean"!=typeof e||e,T.each(w.p.colModel,function(){switch(r=T("#gs_"+w.p.idPrefix+T.jgrid.jqID(this.name),!0===this.frozen&&!0===w.p.frozenColumns?w.grid.fhDiv:w.grid.hDiv),s=this.searchoptions&&void 0!==this.searchoptions.defaultValue?this.searchoptions.defaultValue:void 0,t=this.index||this.name,n[t]=this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:G.defaultSearch||"eq",this.stype){case"select":if(r.find("option").each(function(e){if(0===e&&(this.selected=!0),T(this).val()===s)return!(this.selected=!0)}),void 0!==s)l[t]=s,p++;else try{delete w.p.postData[t]}catch(e){}break;case"text":if(r.val(s||""),void 0!==s)l[t]=s,p++;else try{delete w.p.postData[t]}catch(e){}break;case"custom":T.jgrid.isFunction(this.searchoptions.custom_value)&&0<r.length&&this.searchoptions.custom_value.call(w,r,"set",s||"")}}),0<p),d=((w.p.resetsearch=!0)===G.stringResult||"local"===w.p.datatype?(a='{"groupOp":"'+G.groupOp+'","rules":[',i=0,T.each(l,function(e,t){0<i&&(a+=","),a=(a=(a+='{"field":"'+e+'",')+'"op":"'+n[e]+'",')+'"data":"'+(t+="").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',i++,G.searchOperators&&(r=T("#gs_"+w.p.idPrefix+T.jgrid.jqID(e),!0===this.frozen&&!0===w.p.frozenColumns?w.grid.fhDiv:w.grid.hDiv)).parents("table.ui-search-table").find("td.ui-search-oper").children("a").attr("soper",n[e]).html(G.operands[n[e]])}),a+="]}",!0===w.p.mergeSearch&&w.p.searchModules.hasOwnProperty("filterToolbar")&&!1!==w.p.searchModules.filterToolbar?(w.p.searchModules.filterToolbar=0<i?a:null,c=!0,T.extend(w.p.postData,{filters:T.jgrid.splitSearch(w.p.searchModules)})):T.extend(w.p.postData,{filters:a}),T.each(["searchField","searchString","searchOper"],function(e,t){w.p.postData.hasOwnProperty(t)&&delete w.p.postData[t]})):T.extend(w.p.postData,l),G.url&&(o=w.p.url,T(w).jqGrid("setGridParam",{url:G.url})),"stop"===T(w).triggerHandler("jqGridToolbarBeforeClear"));(d=!d&&T.jgrid.isFunction(G.beforeClear)?G.beforeClear.call(w):d)||e&&T(w).jqGrid("setGridParam",{search:c}).trigger("reloadGrid",[{page:1}]),o&&T(w).jqGrid("setGridParam",{url:o}),T(w).triggerHandler("jqGridToolbarAfterClear"),T.jgrid.isFunction(G.afterClear)&&G.afterClear()},this.toggleToolbar=function(){var e=T("tr.ui-search-toolbar",w.grid.hDiv);!0===w.p.frozenColumns&&T(w).jqGrid("destroyFrozenColumns"),"none"===e.css("display")?e.show():e.hide(),!0===w.p.frozenColumns&&T(w).jqGrid("setFrozenColumns")}}})},destroyFilterToolbar:function(){return this.each(function(){this.p.filterToolbar&&(this.triggerToolbar=null,this.clearToolbar=null,this.toggleToolbar=null,this.p.filterToolbar=!1,T(this.grid.hDiv).find("table thead tr.ui-search-toolbar").remove())})},refreshFilterToolbar:function(g){return g=T.extend(!0,{filters:"",onClearVal:null,onSetVal:null},g||{}),this.each(function(){var a,i,o,e,l,n,p,c=this,d=c.p.colModel,u=c.p.colModel.length,h=[];if(c.p.filterToolbar){for(i=T(c).data("filterToolbar"),a=0;a<u;a++){switch(h.push(d[a].index||d[a].name),o=T("#gs_"+c.p.idPrefix+T.jgrid.jqID(d[a].name)),d[a].stype){case"select":case"text":o.val("")}T.jgrid.isFunction(g.onClearVal)&&g.onClearVal.call(c,o,d[a].name)}"string"==typeof g.filters&&(g.filters.length?e=g.filters:c.p.postData.hasOwnProperty("filters")&&(e=c.p.postData.filters),e=T.jgrid.parse(e)),T.isPlainObject(e)&&!function e(t){if(t&&t.rules){for(l=t.rules,u=l.length,a=0;a<u;a++){var r;n=l[a],-1!==(p=T.inArray(n.field,h))&&0<(o=T("#gs_"+c.p.idPrefix+T.jgrid.jqID(d[p].name))).length&&("select"===d[p].stype?o.find("option[value='"+T.jgrid.jqID(n.data)+"']").prop("selected",!0):"text"===d[p].stype&&o.val(n.data),T.jgrid.isFunction(g.onSetVal)&&g.onSetVal.call(c,o,d[p].name),i)&&i.searchOperators&&(r=o.parent().prev()).hasClass("ui-search-oper")&&(T(".soptclass",r).attr("soper",n.op),i.operands.hasOwnProperty(n.op))&&T(".soptclass",r).html(T.jgrid.stripScript(i.operands[n.op]))}if(t.groups)for(var s=0;s<t.groups.length;s++)e(t.groups[s])}}(e)}})},searchGrid:function(C){var e=T.jgrid.getRegional(this[0],"search");return C=T.extend(!0,{recreateFilter:!1,drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,sortStrategy:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,jqModal:!0,modal:!1,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,onReset:null,toTop:!0,overlay:30,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,splitSelect:",",groupOpSelect:"OR",operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE",in:"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"ISNOT NULL"},buttons:[]},e,C||{}),this.each(function(){var s=this;if(s.grid){var t,r,a="fbox_"+s.p.id,i=!0,o=!0,l={themodal:"searchmod"+a,modalhead:"searchhd"+a,modalcontent:"searchcnt"+a,scrollelm:a},e=[],n=T.jgrid.styleUI[s.p.styleUI||"jQueryUI"].filter,p=T.jgrid.styleUI[s.p.styleUI||"jQueryUI"].common;if(C.styleUI=s.p.styleUI,"string"==typeof(t=T.isPlainObject(s.p._savedFilter)&&!T.isEmptyObject(s.p._savedFilter)?s.p._savedFilter:(!0===s.p.mergeSearch&&s.p.searchModules.hasOwnProperty("searchGrid")&&!1!==s.p.searchModules.searchGrid&&T.extend(s.p.postData,{filters:T.jgrid.splitSearch(s.p.searchModules)}),s.p.postData[C.sFilter]))&&(t=T.jgrid.parse(t)),!0===C.recreateFilter&&T("#"+T.jgrid.jqID(l.themodal)).remove(),void 0!==T("#"+T.jgrid.jqID(l.themodal))[0])G(T("#fbox_"+T.jgrid.jqID(s.p.id)));else{var c,d,u=T("<div><div id='"+a+"' class='searchFilter' style='overflow:auto'></div></div>").insertBefore("#gview_"+T.jgrid.jqID(s.p.id)),h="left",g="",f=("rtl"===s.p.direction&&(h="right",g=" style='text-align:left'",u.attr("dir","rtl")),T.extend([],s.p.colModel)),m="<a id='"+a+"_search' class='fm-button "+p.button+" fm-button-icon-right ui-search'><span class='"+p.icon_base+" "+n.icon_search+"'></span>"+C.Find+"</a>",y="<a id='"+a+"_reset' class='fm-button "+p.button+" fm-button-icon-left ui-reset'><span class='"+p.icon_base+" "+n.icon_reset+"'></span>"+C.Reset+"</a>",v="",j="",b=!1,S=-1,F=!1,x=[],m=(C.showQuery&&(v="<a id='"+a+"_query' class='fm-button "+p.button+" fm-button-icon-left'><span class='"+p.icon_base+" "+n.icon_query+"'></span>Query</a>"),T.jgrid.buildButtons(C.buttons,v+m,p)),O=null;if(T(s).jqGrid("isGroupHeaderOn")&&(_=T("table.ui-jqgrid-htable",s.grid.hDiv).find(".jqg-second-row-header"),d=s.p.groupHeader.length,void 0!==_[0])&&(O=s.p.groupHeader[d-1]),C.columns.length)f=C.columns,c=f[S=0].index||f[0].name;else{if(null!==O)for(var D=0;D<f.length;D++){var q=T.jgrid.inColumnHeader(f[D].name,O.groupHeaders);if(0<=q){f[D].label=O.groupHeaders[q].titleText+"::"+s.p.colNames[D];for(var w=1;w<=O.groupHeaders[q].numberOfColumns-1;w++)f[D+w].label=O.groupHeaders[q].titleText+"::"+s.p.colNames[D+w];D=D+O.groupHeaders[q].numberOfColumns-1}}T.each(f,function(e,t){var r;t.label||(t.label=s.p.colNames[e]),!b&&(r=void 0===t.search||t.search,t.searchoptions&&!0===t.searchoptions.searchhidden&&r||r&&!(!0===t.hidden))&&(b=!0,c=t.index||t.name,S=e),"select"===t.stype&&t.searchoptions&&t.searchoptions.multiple&&(F=!0,x.push(t.index||t.name))})}if((!t&&c||!1===C.multipleSearch)&&(_="eq",0<=S&&f[S].searchoptions&&f[S].searchoptions.sopt?_=f[S].searchoptions.sopt[0]:C.sopt&&C.sopt.length&&(_=C.sopt[0]),t={groupOp:"AND",rules:[{field:c,op:_,data:""}]}),b=!1,C.tmplNames&&C.tmplNames.length&&(b=!0,j=(j="<tr><td class='ui-search-label'>"+C.tmplLabel+"</td>")+"<td><select size='1' name='select_template' class='ui-template "+n.srSelect+"'><option value='default'>Default</option>",T.each(C.tmplNames,function(e,t){j+="<option value='"+e+"'>"+t+"</option>"}),j+="</select></td></tr>"),void 0!==s.p.customFilterDef)for(var I in s.p.customFilterDef)s.p.customFilterDef.hasOwnProperty(I)&&!C.operands.hasOwnProperty(I)&&(C.odata.push({oper:I,text:s.p.customFilterDef[I].text}),C.operands[I]=s.p.customFilterDef[I].operand,!0===s.p.customFilterDef[I].unary)&&e.push(I);d="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+a+"_2'><tbody><tr><td colspan='2'><hr class='"+p.content+"' style='margin:1px'/></td></tr>"+j+"<tr><td class='EditButton' style='text-align:"+h+"'>"+y+"</td><td class='EditButton' "+g+">"+m+"</td></tr></tbody></table>",a=T.jgrid.jqID(a),T("#"+a).jqFilter({columns:f,sortStrategy:C.sortStrategy,filter:C.loadDefaults?t:null,showQuery:C.showQuery,errorcheck:C.errorcheck,sopt:C.sopt,groupButton:C.multipleGroup,ruleButtons:C.multipleSearch,uniqueSearchFields:C.uniqueSearchFields,afterRedraw:C.afterRedraw,ops:C.odata,operands:C.operands,ajaxSelectOptions:s.p.ajaxSelectOptions,groupOps:C.groupOps,addsubgrup:C.addsubgrup,addrule:C.addrule,delgroup:C.delgroup,delrule:C.delrule,autoencode:s.p.autoencode,unaryOperations:e,onChange:function(){this.p.showQuery&&T(".query",this).text(this.toUserFriendlyString()),T.jgrid.isFunction(C.afterChange)&&C.afterChange.call(s,T("#"+a),C)},direction:s.p.direction,id:s.p.id}),u.append(d),T("#"+a+"_2").find("[data-index]").each(function(){var t=parseInt(T(this).attr("data-index"),10);0<=t&&T(this).on("click",function(e){C.buttons[t].click.call(s,T("#"+a),C,e)})}),b&&C.tmplFilters&&C.tmplFilters.length&&T(".ui-template",u).on("change",function(){var e=T(this).val();return"default"===e?T("#"+a).jqFilter("addFilter",t):T("#"+a).jqFilter("addFilter",C.tmplFilters[parseInt(e,10)]),!1}),!0===C.multipleGroup&&(C.multipleSearch=!0),T(s).triggerHandler("jqGridFilterInitialize",[T("#"+a)]),T.jgrid.isFunction(C.onInitializeSearch)&&C.onInitializeSearch.call(s,T("#"+a)),C.gbox="#gbox_"+T.jgrid.jqID(s.p.id);var _=T(".ui-jqgrid").css("font-size")||"11px";C.layer?T.jgrid.createModal(l,u,C,"#gview_"+T.jgrid.jqID(s.p.id),T("#gbox_"+T.jgrid.jqID(s.p.id))[0],"string"==typeof C.layer?"#"+T.jgrid.jqID(C.layer):C.layer,"string"==typeof C.layer?{position:"relative","font-size":_}:{"font-size":_}):T.jgrid.createModal(l,u,C,"#gview_"+T.jgrid.jqID(s.p.id),T("#gbox_"+T.jgrid.jqID(s.p.id))[0],null,{"font-size":_}),(C.searchOnEnter||C.closeOnEscape)&&T("#"+T.jgrid.jqID(l.themodal)).keydown(function(e){var t=T(e.target);return!C.searchOnEnter||13!==e.which||t.hasClass("add-group")||t.hasClass("add-rule")||t.hasClass("delete-group")||t.hasClass("delete-rule")||t.hasClass("fm-button")&&t.is("[id$=_query]")?C.closeOnEscape&&27===e.which?(T("#"+T.jgrid.jqID(l.modalhead)).find(".ui-jqdialog-titlebar-close").click(),!1):void 0:(e.preventDefault(),T("#"+a+"_search").click(),!1)}),v&&T("#"+a+"_query").on("click",function(){return T(".queryresult",u).toggle(),!1}),void 0===C.stringResult&&(C.stringResult=C.multipleSearch),T("#"+a+"_search").on("click",function(){var e,t={};return(r=T("#"+a)).find(".input-elm:focus").change(),F&&C.multipleSearch?(s.p._savedFilter={},e=T.jgrid.filterRefactor({ruleGroup:T.extend(!0,{},r.jqFilter("filterData")),ssfield:x,splitSelect:C.splitSelect,groupOpSelect:C.groupOpSelect}),s.p._savedFilter=T.extend(!0,{},r.jqFilter("filterData"))):e=r.jqFilter("filterData"),C.errorcheck&&(r[0].hideError(),C.showQuery||r.jqFilter("toSQLString"),r[0].p.error)?r[0].showError():(C.stringResult?(t[C.sFilter]=JSON.stringify(e),T.each([C.sField,C.sValue,C.sOper],function(){t[this]=""})):C.multipleSearch?(t[C.sFilter]=e,T.each([C.sField,C.sValue,C.sOper],function(){t[this]=""})):(t[C.sField]=e.rules[0].field,t[C.sValue]=e.rules[0].data,t[C.sOper]=e.rules[0].op,t[C.sFilter]=""),"string"!=typeof t[C.sFilter]&&(t[C.sFilter]=JSON.stringify(t[C.sFilter])),(s.p.search=!0)===s.p.mergeSearch&&s.p.searchModules.hasOwnProperty("searchGrid")&&!1!==s.p.searchModules.searchGrid&&C.multipleSearch?(""!==t[C.sFilter]?s.p.searchModules.searchGrid=t[C.sFilter]:s.p.searchModules.searchGrid=null,T.extend(s.p.postData,{filters:T.jgrid.splitSearch(s.p.searchModules)})):T.extend(s.p.postData,t),!1!==(o=(o=void 0===(o=T(s).triggerHandler("jqGridFilterSearch"))?!0:o)&&T.jgrid.isFunction(C.onSearch)?C.onSearch.call(s,s.p.filters):o)&&T(s).trigger("reloadGrid",[{page:1}]),C.closeAfterSearch&&T.jgrid.hideModal("#"+T.jgrid.jqID(l.themodal),{gb:"#gbox_"+T.jgrid.jqID(s.p.id),jqm:C.jqModal,onClose:C.onClose})),!1}),T("#"+a+"_reset").on("click",function(){var e={},t=T("#"+a);return s.p.search=!1,!(s.p.resetsearch=!0)===C.multipleSearch?e[C.sField]=e[C.sValue]=e[C.sOper]="":e[C.sFilter]="",t[0].resetFilter(),b&&T(".ui-template",u).val("default"),!0===s.p.mergeSearch&&s.p.searchModules.hasOwnProperty("searchGrid")&&!1!==s.p.searchModules.searchGrid?(s.p.searchModules.searchGrid=null,T.extend(s.p.postData,{filters:T.jgrid.splitSearch(s.p.searchModules)}),s.p.search=!0):T.extend(s.p.postData,e),!1!==(o=(o=void 0===(o=T(s).triggerHandler("jqGridFilterReset"))?!0:o)&&T.jgrid.isFunction(C.onReset)?C.onReset.call(s):o)&&T(s).trigger("reloadGrid",[{page:1}]),C.closeAfterReset&&T.jgrid.hideModal("#"+T.jgrid.jqID(l.themodal),{gb:"#gbox_"+T.jgrid.jqID(s.p.id),jqm:C.jqModal,onClose:C.onClose}),!1}),G(T("#"+a)),T(".fm-button:not(."+p.disabled+")",u).hover(function(){T(this).addClass(p.hover)},function(){T(this).removeClass(p.hover)})}}function G(e){(i=(i=void 0===(i=T(s).triggerHandler("jqGridFilterBeforeShow",[e]))?!0:i)&&T.jgrid.isFunction(C.beforeShowSearch)?C.beforeShowSearch.call(s,e):i)&&(T.jgrid.viewModal("#"+T.jgrid.jqID(l.themodal),{gbox:"#gbox_"+T.jgrid.jqID(s.p.id),jqm:C.jqModal,modal:C.modal,overlay:C.overlay,toTop:C.toTop}),T(s).triggerHandler("jqGridFilterAfterShow",[e]),T.jgrid.isFunction(C.afterShowSearch))&&C.afterShowSearch.call(s,e)}})},filterInput:function(o,l){return l=T.extend(!0,{defaultSearch:"cn",groupOp:"OR",searchAll:!1,beforeSearch:null,afterSearch:null,selectFirstFound:!1,firstFoundTimeout:30},l||{}),this.each(function(){var e,t,r,s,a,i=this;i.grid&&(t='{"groupOp":"'+l.groupOp+'","rules":[',r=0,o+="",T.each(i.p.colModel,function(){e=this.index||this.name,s=this.searchoptions||{},s=l.defaultSearch||(s.sopt?s.sopt[0]:l.defaultSearch),(void 0===this.search||this.search||l.searchAll)&&""!==o&&(0<r&&(t+=","),t=(t=t+'{"field":"'+e+'","op":"'+s+'",')+'"data":"'+o.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',r++)}),t+="]}",!0===i.p.mergeSearch&&i.p.searchModules.hasOwnProperty("filterInput")&&!1!==i.p.searchModules.filterInput?(i.p.searchModules.filterInput=0<r?t:null,T.extend(i.p.postData,{filters:T.jgrid.splitSearch(i.p.searchModules)})):T.extend(i.p.postData,{filters:t}),T.each(["searchField","searchString","searchOper"],function(e,t){i.p.postData.hasOwnProperty(t)&&delete i.p.postData[t]}),(a=!(a="stop"===T(i).triggerHandler("jqGridFilterInputBeforeSearch"))&&T.jgrid.isFunction(l.beforeSearch)?l.beforeSearch.call(i):a)||T(i).jqGrid("setGridParam",{search:!0}).trigger("reloadGrid",[{page:1}]),l.selectFirstFound&&setTimeout(function(){var e=T(i).jqGrid("getGridRowByIndex",1);T(i).jqGrid("setSelection",e.id,!1)},l.firstFoundTimeout),T(i).triggerHandler("jqGridFilterInputAfterSearch"),T.jgrid.isFunction(l.afterSearch))&&l.afterSearch.call(i)})},autoSelect:function(n){return n=T.extend(!0,{field:"",direction:"asc",src_date:"Y-m-d",allValues:"All",count_item:!0,create_value:!0},n||{}),this.each(function(){var e,t=this,r="";if(n.field&&t.p.data&&Array.isArray(t.p.data)){var s,a,i,o,l=[];try{o=(i=T.jgrid.from.call(t,t.p.data).groupBy(n.field,n.direction,"text",n.src_date)).length}catch(e){}if(i&&i.length){for(a=T("#gsh_"+t.p.id+"_"+n.field).find("td.ui-search-input > select"),o=i.length,n.allValues&&(r="<option value=''>"+n.allValues+"</option>",l.push(":"+n.allValues));o--;)e=i[o],s=n.count_item?" ("+e.items.length+")":"",r+="<option value='"+e.unique+"'>"+e.unique+s+"</option>",l.push(e.unique+":"+e.unique+s);a.append(r),a.on("change",function(){t.triggerToolbar()}),n.create_value&&(a=T.jgrid.getElemByAttrVal(t.p.colModel,"name",n.field,!1),T.isEmptyObject(a)||(a.searchoptions?T.extend(a.searchoptions,{value:l.join(";")}):(a.searchoptions={},a.searchoptions.value=l.join(";"))))}}})}})});