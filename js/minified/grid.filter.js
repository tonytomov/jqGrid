/**
*
* @license Guriddo jqGrid JS - v4.8.0 
* Copyright(c) 2008, Tony Tomov, tony@trirand.com
* 
* License: http://guriddo.net/?page_id=103334
*/
!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./grid.common"],a):a(jQuery)}(function(a){"use strict";a.fn.jqFilter=function(b){if("string"==typeof b){var c=a.fn.jqFilter[b];if(!c)throw"jqFilter - No such method: "+b;var d=a.makeArray(arguments).slice(1);return c.apply(this,d)}var e=a.extend(!0,{filter:null,columns:[],onChange:null,afterRedraw:null,checkValues:null,error:!1,errmsg:"",errorcheck:!0,showQuery:!0,sopt:null,ops:[],operands:null,numopts:["eq","ne","lt","le","gt","ge","nu","nn","in","ni"],stropts:["eq","ne","bw","bn","ew","en","cn","nc","nu","nn","in","ni"],strarr:["text","string","blob"],groupOps:[{op:"AND",text:"AND"},{op:"OR",text:"OR"}],groupButton:!0,ruleButtons:!0,direction:"ltr"},a.jgrid.filter,b||{});return this.each(function(){if(!this.filter){this.p=e,(null===this.p.filter||void 0===this.p.filter)&&(this.p.filter={groupOp:this.p.groupOps[0].op,rules:[],groups:[]});var b,c,d=this.p.columns.length,f=/msie/i.test(navigator.userAgent)&&!window.opera;if(this.p.initFilter=a.extend(!0,{},this.p.filter),d){for(b=0;d>b;b++)c=this.p.columns[b],c.stype?c.inputtype=c.stype:c.inputtype||(c.inputtype="text"),c.sorttype?c.searchtype=c.sorttype:c.searchtype||(c.searchtype="string"),void 0===c.hidden&&(c.hidden=!1),c.label||(c.label=c.name),c.index&&(c.name=c.index),c.hasOwnProperty("searchoptions")||(c.searchoptions={}),c.hasOwnProperty("searchrules")||(c.searchrules={});this.p.showQuery&&a(this).append("<table class='queryresult ui-widget ui-widget-content' style='display:block;max-width:440px;border:0px none;' dir='"+this.p.direction+"'><tbody><tr><td class='query'></td></tr></tbody></table>");var g=function(){return a("#"+a.jgrid.jqID(e.id))[0]||null},h=function(b,c){var d=[!0,""],f=g();if(a.isFunction(c.searchrules))d=c.searchrules.call(f,b,c);else if(a.jgrid&&a.jgrid.checkValues)try{d=a.jgrid.checkValues.call(f,b,-1,c.searchrules,c.label)}catch(h){}d&&d.length&&d[0]===!1&&(e.error=!d[0],e.errmsg=d[1])};this.onchange=function(){return this.p.error=!1,this.p.errmsg="",a.isFunction(this.p.onChange)?this.p.onChange.call(this,this.p):!1},this.reDraw=function(){a("table.group:first",this).remove();var b=this.createTableForGroup(e.filter,null);a(this).append(b),a.isFunction(this.p.afterRedraw)&&this.p.afterRedraw.call(this,this.p)},this.createTableForGroup=function(b,c){var d,f=this,g=a("<table class='group ui-widget ui-widget-content ui-search-table' style='border:0px none;'><tbody></tbody></table>"),h="left";"rtl"===this.p.direction&&(h="right",g.attr("dir","rtl")),null===c&&g.append("<tr class='error' style='display:none;'><th colspan='5' class='ui-state-error' align='"+h+"'></th></tr>");var i=a("<tr></tr>");g.append(i);var j=a("<th colspan='5' align='"+h+"'></th>");if(i.append(j),this.p.ruleButtons===!0){var k=a("<select class='opsel ui-widget-content ui-corner-all'></select>");j.append(k);var l,m="";for(d=0;d<e.groupOps.length;d++)l=b.groupOp===f.p.groupOps[d].op?" selected='selected'":"",m+="<option value='"+f.p.groupOps[d].op+"'"+l+">"+f.p.groupOps[d].text+"</option>";k.append(m).bind("change",function(){b.groupOp=a(k).val(),f.onchange()})}var n="<span></span>";if(this.p.groupButton&&(n=a("<input type='button' value='+ {}' title='Add subgroup' class='add-group ui-widget-content ui-corner-all'/>"),n.bind("click",function(){return void 0===b.groups&&(b.groups=[]),b.groups.push({groupOp:e.groupOps[0].op,rules:[],groups:[]}),f.reDraw(),f.onchange(),!1})),j.append(n),this.p.ruleButtons===!0){var o,p=a("<input type='button' value='+' title='Add rule' class='add-rule ui-add ui-widget-content ui-corner-all'/>");p.bind("click",function(){for(void 0===b.rules&&(b.rules=[]),d=0;d<f.p.columns.length;d++){var c=void 0===f.p.columns[d].search?!0:f.p.columns[d].search,e=f.p.columns[d].hidden===!0,g=f.p.columns[d].searchoptions.searchhidden===!0;if(g&&c||c&&!e){o=f.p.columns[d];break}}var h;return h=o.searchoptions.sopt?o.searchoptions.sopt:f.p.sopt?f.p.sopt:-1!==a.inArray(o.searchtype,f.p.strarr)?f.p.stropts:f.p.numopts,b.rules.push({field:o.name,op:h[0],data:""}),f.reDraw(),!1}),j.append(p)}if(null!==c){var q=a("<input type='button' value='-' title='Delete group' class='delete-group ui-widget-content ui-corner-all'/>");j.append(q),q.bind("click",function(){for(d=0;d<c.groups.length;d++)if(c.groups[d]===b){c.groups.splice(d,1);break}return f.reDraw(),f.onchange(),!1})}if(void 0!==b.groups)for(d=0;d<b.groups.length;d++){var r=a("<tr></tr>");g.append(r);var s=a("<td class='first'></td>");r.append(s);var t=a("<td colspan='4'></td>");t.append(this.createTableForGroup(b.groups[d],b)),r.append(t)}if(void 0===b.groupOp&&(b.groupOp=f.p.groupOps[0].op),void 0!==b.rules)for(d=0;d<b.rules.length;d++)g.append(this.createTableRowForRule(b.rules[d],b));return g},this.createTableRowForRule=function(b,c){var d,h,i,j,k,l=this,m=g(),n=a("<tr></tr>"),o="";n.append("<td class='first'></td>");var p=a("<td class='columns'></td>");n.append(p);var q,r=a("<select class='ui-widget-content ui-corner-all'></select>"),s=[];p.append(r),r.bind("change",function(){for(b.field=a(r).val(),i=a(this).parents("tr:first"),d=0;d<l.p.columns.length;d++)if(l.p.columns[d].name===b.field){j=l.p.columns[d];break}if(j){j.searchoptions.id=a.jgrid.randId(),j.searchoptions.name=b.field,j.searchoptions.oper="filter",f&&"text"===j.inputtype&&(j.searchoptions.size||(j.searchoptions.size=10));var c=a.jgrid.createEl.call(m,j.inputtype,j.searchoptions,"",!0,l.p.ajaxSelectOptions||{},!0);a(c).addClass("input-elm ui-widget-content ui-corner-all"),h=j.searchoptions.sopt?j.searchoptions.sopt:l.p.sopt?l.p.sopt:-1!==a.inArray(j.searchtype,l.p.strarr)?l.p.stropts:l.p.numopts;var e="",g=0;for(s=[],a.each(l.p.ops,function(){s.push(this.oper)}),d=0;d<h.length;d++)q=a.inArray(h[d],s),-1!==q&&(0===g&&(b.op=l.p.ops[q].oper),e+="<option value='"+l.p.ops[q].oper+"'>"+l.p.ops[q].text+"</option>",g++);if(a(".selectopts",i).empty().append(e),a(".selectopts",i)[0].selectedIndex=0,a.jgrid.msie&&a.jgrid.msiever()<9){var k=parseInt(a("select.selectopts",i)[0].offsetWidth,10)+1;a(".selectopts",i).width(k),a(".selectopts",i).css("width","auto")}a(".data",i).empty().append(c),a.jgrid.bindEv.call(m,c,j.searchoptions),a(".input-elm",i).bind("change",function(c){var d=c.target;b.data="SPAN"===d.nodeName.toUpperCase()&&j.searchoptions&&a.isFunction(j.searchoptions.custom_value)?j.searchoptions.custom_value.call(m,a(d).children(".customelement:first"),"get"):d.value,l.onchange()}),setTimeout(function(){b.data=a(c).val(),l.onchange()},0)}});var t=0;for(d=0;d<l.p.columns.length;d++){var u=void 0===l.p.columns[d].search?!0:l.p.columns[d].search,v=l.p.columns[d].hidden===!0,w=l.p.columns[d].searchoptions.searchhidden===!0;(w&&u||u&&!v)&&(k="",b.field===l.p.columns[d].name&&(k=" selected='selected'",t=d),o+="<option value='"+l.p.columns[d].name+"'"+k+">"+l.p.columns[d].label+"</option>")}r.append(o);var x=a("<td class='operators'></td>");n.append(x),j=e.columns[t],j.searchoptions.id=a.jgrid.randId(),f&&"text"===j.inputtype&&(j.searchoptions.size||(j.searchoptions.size=10)),j.searchoptions.name=b.field,j.searchoptions.oper="filter";var y=a.jgrid.createEl.call(m,j.inputtype,j.searchoptions,b.data,!0,l.p.ajaxSelectOptions||{},!0);("nu"===b.op||"nn"===b.op)&&(a(y).attr("readonly","true"),a(y).attr("disabled","true"));var z=a("<select class='selectopts ui-widget-content ui-corner-all'></select>");for(x.append(z),z.bind("change",function(){b.op=a(z).val(),i=a(this).parents("tr:first");var c=a(".input-elm",i)[0];"nu"===b.op||"nn"===b.op?(b.data="","SELECT"!==c.tagName.toUpperCase()&&(c.value=""),c.setAttribute("readonly","true"),c.setAttribute("disabled","true")):("SELECT"===c.tagName.toUpperCase()&&(b.data=c.value),c.removeAttribute("readonly"),c.removeAttribute("disabled")),l.onchange()}),h=j.searchoptions.sopt?j.searchoptions.sopt:l.p.sopt?l.p.sopt:-1!==a.inArray(j.searchtype,l.p.strarr)?l.p.stropts:l.p.numopts,o="",a.each(l.p.ops,function(){s.push(this.oper)}),d=0;d<h.length;d++)q=a.inArray(h[d],s),-1!==q&&(k=b.op===l.p.ops[q].oper?" selected='selected'":"",o+="<option value='"+l.p.ops[q].oper+"'"+k+">"+l.p.ops[q].text+"</option>");z.append(o);var A=a("<td class='data'></td>");n.append(A),A.append(y),a.jgrid.bindEv.call(m,y,j.searchoptions),a(y).addClass("input-elm ui-widget-content ui-corner-all").bind("change",function(){b.data="custom"===j.inputtype?j.searchoptions.custom_value.call(m,a(this).children(".customelement:first"),"get"):a(this).val(),l.onchange()});var B=a("<td></td>");if(n.append(B),this.p.ruleButtons===!0){var C=a("<input type='button' value='-' title='Delete rule' class='delete-rule ui-del ui-widget-content ui-corner-all'/>");B.append(C),C.bind("click",function(){for(d=0;d<c.rules.length;d++)if(c.rules[d]===b){c.rules.splice(d,1);break}return l.reDraw(),l.onchange(),!1})}return n},this.getStringForGroup=function(a){var b,c="(";if(void 0!==a.groups)for(b=0;b<a.groups.length;b++){c.length>1&&(c+=" "+a.groupOp+" ");try{c+=this.getStringForGroup(a.groups[b])}catch(d){alert(d)}}if(void 0!==a.rules)try{for(b=0;b<a.rules.length;b++)c.length>1&&(c+=" "+a.groupOp+" "),c+=this.getStringForRule(a.rules[b])}catch(e){alert(e)}return c+=")","()"===c?"":c},this.getStringForRule=function(b){var c,d,f,g,i="",j="",k=["int","integer","float","number","currency"];for(c=0;c<this.p.ops.length;c++)if(this.p.ops[c].oper===b.op){i=this.p.operands.hasOwnProperty(b.op)?this.p.operands[b.op]:"",j=this.p.ops[c].oper;break}for(c=0;c<this.p.columns.length;c++)if(this.p.columns[c].name===b.field){d=this.p.columns[c];break}return void 0===d?"":(g=b.data,("bw"===j||"bn"===j)&&(g+="%"),("ew"===j||"en"===j)&&(g="%"+g),("cn"===j||"nc"===j)&&(g="%"+g+"%"),("in"===j||"ni"===j)&&(g=" ("+g+")"),e.errorcheck&&h(b.data,d),f=-1!==a.inArray(d.searchtype,k)||"nn"===j||"nu"===j?b.field+" "+i+" "+g:b.field+" "+i+' "'+g+'"')},this.resetFilter=function(){this.p.filter=a.extend(!0,{},this.p.initFilter),this.reDraw(),this.onchange()},this.hideError=function(){a("th.ui-state-error",this).html(""),a("tr.error",this).hide()},this.showError=function(){a("th.ui-state-error",this).html(this.p.errmsg),a("tr.error",this).show()},this.toUserFriendlyString=function(){return this.getStringForGroup(e.filter)},this.toString=function(){function a(a){if(c.p.errorcheck){var b,d;for(b=0;b<c.p.columns.length;b++)if(c.p.columns[b].name===a.field){d=c.p.columns[b];break}d&&h(a.data,d)}return a.op+"(item."+a.field+",'"+a.data+"')"}function b(c){var d,e="(";if(void 0!==c.groups)for(d=0;d<c.groups.length;d++)e.length>1&&(e+="OR"===c.groupOp?" || ":" && "),e+=b(c.groups[d]);if(void 0!==c.rules)for(d=0;d<c.rules.length;d++)e.length>1&&(e+="OR"===c.groupOp?" || ":" && "),e+=a(c.rules[d]);return e+=")","()"===e?"":e}var c=this;return b(this.p.filter)},this.reDraw(),this.p.showQuery&&this.onchange(),this.filter=!0}}})},a.extend(a.fn.jqFilter,{toSQLString:function(){var a="";return this.each(function(){a=this.toUserFriendlyString()}),a},filterData:function(){var a;return this.each(function(){a=this.p.filter}),a},getParameter:function(a){return void 0!==a&&this.p.hasOwnProperty(a)?this.p[a]:this.p},resetFilter:function(){return this.each(function(){this.resetFilter()})},addFilter:function(b){"string"==typeof b&&(b=a.jgrid.parse(b)),this.each(function(){this.p.filter=b,this.reDraw(),this.onchange()})}}),a.jgrid.extend({filterToolbar:function(b){var c=a.jgrid.getRegional(this[0],"search");return b=a.extend({autosearch:!0,autosearchDelay:500,searchOnEnter:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:!1,groupOp:"AND",defaultSearch:"bw",searchOperators:!1,resetIcon:"x",operands:{eq:"==",ne:"!",lt:"<",le:"<=",gt:">",ge:">=",bw:"^",bn:"!^","in":"=",ni:"!=",ew:"|",en:"!@",cn:"~",nc:"!~",nu:"#",nn:"!#"}},c,b||{}),this.each(function(){var d=this;if(!d.p.filterToolbar){a(d).data("filterToolbar")||a(d).data("filterToolbar",b),d.p.force_regional&&(b=a.extend(b,c));var e,f=function(){var c,e,f,g={},h=0,i={};a.each(d.p.colModel,function(){var j=a("#gs_"+d.p.idPrefix+a.jgrid.jqID(this.name),this.frozen===!0&&d.p.frozenColumns===!0?d.grid.fhDiv:d.grid.hDiv);if(e=this.index||this.name,f=b.searchOperators?j.parent().prev().children("a").attr("soper")||b.defaultSearch:this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:"select"===this.stype?"eq":b.defaultSearch,c="custom"===this.stype&&a.isFunction(this.searchoptions.custom_value)&&j.length>0&&"SPAN"===j[0].nodeName.toUpperCase()?this.searchoptions.custom_value.call(d,j.children(".customelement:first"),"get"):j.val(),c||"nu"===f||"nn"===f)g[e]=c,i[e]=f,h++;else try{delete d.p.postData[e]}catch(k){}});var j=h>0?!0:!1;if(b.stringResult===!0||"local"===d.p.datatype||b.searchOperators===!0){var k='{"groupOp":"'+b.groupOp+'","rules":[',l=0;a.each(g,function(a,b){l>0&&(k+=","),k+='{"field":"'+a+'",',k+='"op":"'+i[a]+'",',b+="",k+='"data":"'+b.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',l++}),k+="]}",a.extend(d.p.postData,{filters:k}),a.each(["searchField","searchString","searchOper"],function(a,b){d.p.postData.hasOwnProperty(b)&&delete d.p.postData[b]})}else a.extend(d.p.postData,g);var m;d.p.searchurl&&(m=d.p.url,a(d).jqGrid("setGridParam",{url:d.p.searchurl}));var n="stop"===a(d).triggerHandler("jqGridToolbarBeforeSearch")?!0:!1;!n&&a.isFunction(b.beforeSearch)&&(n=b.beforeSearch.call(d)),n||a(d).jqGrid("setGridParam",{search:j}).trigger("reloadGrid",[{page:1}]),m&&a(d).jqGrid("setGridParam",{url:m}),a(d).triggerHandler("jqGridToolbarAfterSearch"),a.isFunction(b.afterSearch)&&b.afterSearch.call(d)},g=function(c){var e,f={},g=0;c="boolean"!=typeof c?!0:c,a.each(d.p.colModel,function(){var b,c=a("#gs_"+d.p.idPrefix+a.jgrid.jqID(this.name),this.frozen===!0&&d.p.frozenColumns===!0?d.grid.fhDiv:d.grid.hDiv);switch(this.searchoptions&&void 0!==this.searchoptions.defaultValue&&(b=this.searchoptions.defaultValue),e=this.index||this.name,this.stype){case"select":if(c.find("option").each(function(c){return 0===c&&(this.selected=!0),a(this).val()===b?(this.selected=!0,!1):void 0}),void 0!==b)f[e]=b,g++;else try{delete d.p.postData[e]}catch(h){}break;case"text":if(c.val(b||""),void 0!==b)f[e]=b,g++;else try{delete d.p.postData[e]}catch(i){}break;case"custom":a.isFunction(this.searchoptions.custom_value)&&c.length>0&&"SPAN"===c[0].nodeName.toUpperCase()&&this.searchoptions.custom_value.call(d,c.children(".customelement:first"),"set",b||"")}});var h=g>0?!0:!1;if(d.p.resetsearch=!0,b.stringResult===!0||"local"===d.p.datatype){var i='{"groupOp":"'+b.groupOp+'","rules":[',j=0;a.each(f,function(a,b){j>0&&(i+=","),i+='{"field":"'+a+'",',i+='"op":"eq",',b+="",i+='"data":"'+b.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',j++}),i+="]}",a.extend(d.p.postData,{filters:i}),a.each(["searchField","searchString","searchOper"],function(a,b){d.p.postData.hasOwnProperty(b)&&delete d.p.postData[b]})}else a.extend(d.p.postData,f);var k;d.p.searchurl&&(k=d.p.url,a(d).jqGrid("setGridParam",{url:d.p.searchurl}));var l="stop"===a(d).triggerHandler("jqGridToolbarBeforeClear")?!0:!1;!l&&a.isFunction(b.beforeClear)&&(l=b.beforeClear.call(d)),l||c&&a(d).jqGrid("setGridParam",{search:h}).trigger("reloadGrid",[{page:1}]),k&&a(d).jqGrid("setGridParam",{url:k}),a(d).triggerHandler("jqGridToolbarAfterClear"),a.isFunction(b.afterClear)&&b.afterClear()},h=function(){var b=a("tr.ui-search-toolbar",d.grid.hDiv),c=d.p.frozenColumns===!0?a("tr.ui-search-toolbar",d.grid.fhDiv):!1;"none"===b.css("display")?(b.show(),c&&c.show()):(b.hide(),c&&c.hide())},i=function(c,e,g){a("#sopt_menu").remove(),e=parseInt(e,10),g=parseInt(g,10)+18;for(var h,i,j=a(".ui-jqgrid-view").css("font-size")||"11px",k='<ul id="sopt_menu" class="ui-search-menu" role="menu" tabindex="0" style="font-size:'+j+";left:"+e+"px;top:"+g+'px;">',l=a(c).attr("soper"),m=[],n=0,o=a(c).attr("colname"),p=d.p.colModel.length;p>n&&d.p.colModel[n].name!==o;)n++;var q=d.p.colModel[n],r=a.extend({},q.searchoptions);for(r.sopt||(r.sopt=[],r.sopt[0]="select"===q.stype?"eq":b.defaultSearch),a.each(b.odata,function(){m.push(this.oper)}),n=0;n<r.sopt.length;n++)i=a.inArray(r.sopt[n],m),-1!==i&&(h=l===b.odata[i].oper?"ui-state-highlight":"",k+='<li class="ui-menu-item '+h+'" role="presentation"><a class="ui-corner-all g-menu-item" tabindex="0" role="menuitem" value="'+b.odata[i].oper+'" oper="'+b.operands[b.odata[i].oper]+'"><table cellspacing="0" cellpadding="0" border="0"><tr><td width="25px">'+b.operands[b.odata[i].oper]+"</td><td>"+b.odata[i].text+"</td></tr></table></a></li>");k+="</ul>",a("body").append(k),a("#sopt_menu").addClass("ui-menu ui-widget ui-widget-content ui-corner-all"),a("#sopt_menu > li > a").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).click(function(){var e=a(this).attr("value"),g=a(this).attr("oper");if(a(d).triggerHandler("jqGridToolbarSelectOper",[e,g,c]),a("#sopt_menu").hide(),a(c).text(g).attr("soper",e),b.autosearch===!0){var h=a(c).parent().next().children()[0];(a(h).val()||"nu"===e||"nn"===e)&&f()}})},j=a("<tr class='ui-search-toolbar' role='row'></tr>");a.each(d.p.colModel,function(c){var g,h,i,k,l,m,n,o=this,p="",q="=",r=a("<th role='columnheader' class='ui-state-default ui-th-"+d.p.direction+"' id='gsh_"+d.p.id+"_"+o.name+"' ></th>"),s=a("<div></div>"),t=a("<table class='ui-search-table' cellspacing='0'><tr><td class='ui-search-oper' headers=''></td><td class='ui-search-input' headers=''></td><td class='ui-search-clear' headers=''></td></tr></table>");if(this.hidden===!0&&a(r).css("display","none"),this.search=this.search===!1?!1:!0,void 0===this.stype&&(this.stype="text"),g=a.extend({},this.searchoptions||{},{name:o.index||o.name,id:"gs_"+d.p.idPrefix+o.name,oper:"search"}),this.search){if(b.searchOperators){for(h=g.sopt?g.sopt[0]:"select"===o.stype?"eq":b.defaultSearch,i=0;i<b.odata.length;i++)if(b.odata[i].oper===h){q=b.operands[h]||"";break}k=null!=g.searchtitle?g.searchtitle:b.operandTitle,p="<a title='"+k+"' style='padding-right: 0.5em;' soper='"+h+"' class='soptclass' colname='"+this.name+"'>"+q+"</a>"}switch(a("td:eq(0)",t).attr("colindex",c).append(p),void 0===g.clearSearch&&(g.clearSearch=!0),g.clearSearch?(l=b.resetTitle||"Clear Search Value",a("td:eq(2)",t).append("<a title='"+l+"' style='padding-right: 0.3em;padding-left: 0.3em;' class='clearsearchclass'>"+b.resetIcon+"</a>")):a("td:eq(2)",t).hide(),this.surl&&(g.dataUrl=this.surl),m="",g.defaultValue&&(m=a.isFunction(g.defaultValue)?g.defaultValue.call(d):g.defaultValue),n=a.jgrid.createEl.call(d,this.stype,g,m,!1,a.extend({},a.jgrid.ajaxOptions,d.p.ajaxSelectOptions||{})),a(n).css({width:"100%"}).addClass("ui-widget-content ui-corner-all"),a("td:eq(1)",t).append(n),a(s).append(t),this.stype){case"select":b.autosearch===!0&&(g.dataEvents=[{type:"change",fn:function(){return f(),!1}}]);break;case"text":b.autosearch===!0&&(g.dataEvents=b.searchOnEnter?[{type:"keypress",fn:function(a){var b=a.charCode||a.keyCode||0;return 13===b?(f(),!1):this}}]:[{type:"keydown",fn:function(a){var c=a.which;switch(c){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:e&&clearTimeout(e),e=setTimeout(function(){f()},b.autosearchDelay)}}}])}a.jgrid.bindEv.call(d,n,g)}a(r).append(s),a(j).append(r),b.searchOperators||a("td:eq(0)",t).hide()}),a("table thead",d.grid.hDiv).append(j),b.searchOperators&&(a(".soptclass",j).click(function(b){var c=a(this).offset(),d=c.left,e=c.top;i(this,d,e),b.stopPropagation()}),a("body").on("click",function(b){"soptclass"!==b.target.className&&a("#sopt_menu").hide()})),a(".clearsearchclass",j).click(function(){var c=a(this).parents("tr:first"),e=parseInt(a("td.ui-search-oper",c).attr("colindex"),10),g=a.extend({},d.p.colModel[e].searchoptions||{}),h=g.defaultValue?g.defaultValue:"";"select"===d.p.colModel[e].stype?h?a("td.ui-search-input select",c).val(h):a("td.ui-search-input select",c)[0].selectedIndex=0:a("td.ui-search-input input",c).val(h),b.autosearch===!0&&f()}),this.p.filterToolbar=!0,this.triggerToolbar=f,this.clearToolbar=g,this.toggleToolbar=h}})},destroyFilterToolbar:function(){return this.each(function(){this.p.filterToolbar&&(this.triggerToolbar=null,this.clearToolbar=null,this.toggleToolbar=null,this.p.filterToolbar=!1,a(this.grid.hDiv).find("table thead tr.ui-search-toolbar").remove())})},searchGrid:function(b){var c=a.jgrid.getRegional(this[0],"search");return b=a.extend(!0,{recreateFilter:!1,drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,jqModal:!0,modal:!1,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,onReset:null,toTop:!0,overlay:30,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE","in":"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"ISNOT NULL"}},c,b||{}),this.each(function(){function c(c){g=a(d).triggerHandler("jqGridFilterBeforeShow",[c]),void 0===g&&(g=!0),g&&a.isFunction(b.beforeShowSearch)&&(g=b.beforeShowSearch.call(d,c)),g&&(a.jgrid.viewModal("#"+a.jgrid.jqID(i.themodal),{gbox:"#gbox_"+a.jgrid.jqID(f),jqm:b.jqModal,modal:b.modal,overlay:b.overlay,toTop:b.toTop}),a(d).triggerHandler("jqGridFilterAfterShow",[c]),a.isFunction(b.afterShowSearch)&&b.afterShowSearch.call(d,c))}var d=this;if(d.grid){var e,f="fbox_"+d.p.id,g=!0,h=!0,i={themodal:"searchmod"+f,modalhead:"searchhd"+f,modalcontent:"searchcnt"+f,scrollelm:f},j=d.p.postData[b.sFilter];if("string"==typeof j&&(j=a.jgrid.parse(j)),b.recreateFilter===!0&&a("#"+a.jgrid.jqID(i.themodal)).remove(),void 0!==a("#"+a.jgrid.jqID(i.themodal))[0])c(a("#fbox_"+a.jgrid.jqID(d.p.id)));else{var k=a("<div><div id='"+f+"' class='searchFilter' style='overflow:auto'></div></div>").insertBefore("#gview_"+a.jgrid.jqID(d.p.id)),l="left",m="";"rtl"===d.p.direction&&(l="right",m=" style='text-align:left'",k.attr("dir","rtl"));var n,o,p=a.extend([],d.p.colModel),q="<a id='"+f+"_search' class='fm-button ui-state-default ui-corner-all fm-button-icon-right ui-reset'><span class='ui-icon ui-icon-search'></span>"+b.Find+"</a>",r="<a id='"+f+"_reset' class='fm-button ui-state-default ui-corner-all fm-button-icon-left ui-search'><span class='ui-icon ui-icon-arrowreturnthick-1-w'></span>"+b.Reset+"</a>",s="",t="",u=!1,v=-1;if(b.showQuery&&(s="<a id='"+f+"_query' class='fm-button ui-state-default ui-corner-all fm-button-icon-left'><span class='ui-icon ui-icon-comment'></span>Query</a>"),b.columns.length?(p=b.columns,v=0,n=p[0].index||p[0].name):a.each(p,function(a,b){if(b.label||(b.label=d.p.colNames[a]),!u){var c=void 0===b.search?!0:b.search,e=b.hidden===!0,f=b.searchoptions&&b.searchoptions.searchhidden===!0;(f&&c||c&&!e)&&(u=!0,n=b.index||b.name,v=a)}}),!j&&n||b.multipleSearch===!1){var w="eq";v>=0&&p[v].searchoptions&&p[v].searchoptions.sopt?w=p[v].searchoptions.sopt[0]:b.sopt&&b.sopt.length&&(w=b.sopt[0]),j={groupOp:"AND",rules:[{field:n,op:w,data:""}]}}u=!1,b.tmplNames&&b.tmplNames.length&&(u=!0,t=b.tmplLabel,t+="<select class='ui-template'>",t+="<option value='default'>Default</option>",a.each(b.tmplNames,function(a,b){t+="<option value='"+a+"'>"+b+"</option>"}),t+="</select>"),o="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+f+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='EditButton' style='text-align:"+l+"'>"+r+t+"</td><td class='EditButton' "+m+">"+s+q+"</td></tr></tbody></table>",f=a.jgrid.jqID(f),a("#"+f).jqFilter({columns:p,filter:b.loadDefaults?j:null,showQuery:b.showQuery,errorcheck:b.errorcheck,sopt:b.sopt,groupButton:b.multipleGroup,ruleButtons:b.multipleSearch,afterRedraw:b.afterRedraw,ops:b.odata,operands:b.operands,ajaxSelectOptions:d.p.ajaxSelectOptions,groupOps:b.groupOps,onChange:function(){this.p.showQuery&&a(".query",this).html(this.toUserFriendlyString()),a.isFunction(b.afterChange)&&b.afterChange.call(d,a("#"+f),b)},direction:d.p.direction,id:d.p.id}),k.append(o),u&&b.tmplFilters&&b.tmplFilters.length&&a(".ui-template",k).bind("change",function(){var c=a(this).val();return"default"===c?a("#"+f).jqFilter("addFilter",j):a("#"+f).jqFilter("addFilter",b.tmplFilters[parseInt(c,10)]),!1}),b.multipleGroup===!0&&(b.multipleSearch=!0),a(d).triggerHandler("jqGridFilterInitialize",[a("#"+f)]),a.isFunction(b.onInitializeSearch)&&b.onInitializeSearch.call(d,a("#"+f)),b.gbox="#gbox_"+f,b.layer?a.jgrid.createModal(i,k,b,"#gview_"+a.jgrid.jqID(d.p.id),a("#gbox_"+a.jgrid.jqID(d.p.id))[0],"#"+a.jgrid.jqID(b.layer),{position:"relative"}):a.jgrid.createModal(i,k,b,"#gview_"+a.jgrid.jqID(d.p.id),a("#gbox_"+a.jgrid.jqID(d.p.id))[0]),(b.searchOnEnter||b.closeOnEscape)&&a("#"+a.jgrid.jqID(i.themodal)).keydown(function(c){var d=a(c.target);return!b.searchOnEnter||13!==c.which||d.hasClass("add-group")||d.hasClass("add-rule")||d.hasClass("delete-group")||d.hasClass("delete-rule")||d.hasClass("fm-button")&&d.is("[id$=_query]")?b.closeOnEscape&&27===c.which?(a("#"+a.jgrid.jqID(i.modalhead)).find(".ui-jqdialog-titlebar-close").click(),!1):void 0:(a("#"+f+"_search").click(),!1)}),s&&a("#"+f+"_query").bind("click",function(){return a(".queryresult",k).toggle(),!1}),void 0===b.stringResult&&(b.stringResult=b.multipleSearch),a("#"+f+"_search").bind("click",function(){var c,g,j={};if(e=a("#"+f),e.find(".input-elm:focus").change(),g=e.jqFilter("filterData"),b.errorcheck&&(e[0].hideError(),b.showQuery||e.jqFilter("toSQLString"),e[0].p.error))return e[0].showError(),!1;if(b.stringResult){try{c=JSON.stringify(g)}catch(k){}"string"==typeof c&&(j[b.sFilter]=c,a.each([b.sField,b.sValue,b.sOper],function(){j[this]=""}))}else b.multipleSearch?(j[b.sFilter]=g,a.each([b.sField,b.sValue,b.sOper],function(){j[this]=""})):(j[b.sField]=g.rules[0].field,j[b.sValue]=g.rules[0].data,j[b.sOper]=g.rules[0].op,j[b.sFilter]="");return d.p.search=!0,a.extend(d.p.postData,j),h=a(d).triggerHandler("jqGridFilterSearch"),void 0===h&&(h=!0),h&&a.isFunction(b.onSearch)&&(h=b.onSearch.call(d,d.p.filters)),h!==!1&&a(d).trigger("reloadGrid",[{page:1}]),b.closeAfterSearch&&a.jgrid.hideModal("#"+a.jgrid.jqID(i.themodal),{gb:"#gbox_"+a.jgrid.jqID(d.p.id),jqm:b.jqModal,onClose:b.onClose}),!1}),a("#"+f+"_reset").bind("click",function(){var c={},e=a("#"+f);return d.p.search=!1,d.p.resetsearch=!0,b.multipleSearch===!1?c[b.sField]=c[b.sValue]=c[b.sOper]="":c[b.sFilter]="",e[0].resetFilter(),u&&a(".ui-template",k).val("default"),a.extend(d.p.postData,c),h=a(d).triggerHandler("jqGridFilterReset"),void 0===h&&(h=!0),h&&a.isFunction(b.onReset)&&(h=b.onReset.call(d)),h!==!1&&a(d).trigger("reloadGrid",[{page:1}]),b.closeAfterReset&&a.jgrid.hideModal("#"+a.jgrid.jqID(i.themodal),{gb:"#gbox_"+a.jgrid.jqID(d.p.id),jqm:b.jqModal,onClose:b.onClose}),!1}),c(a("#"+f)),a(".fm-button:not(.ui-state-disabled)",k).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")})}}})}})});