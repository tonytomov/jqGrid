!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./grid.common"],e):e(jQuery)}(function(Z){"use strict";var $={};Z.jgrid.extend({editGridRow:function(X,Y){var e=Z.jgrid.getRegional(this[0],"edit"),t=this[0].p.styleUI,J=Z.jgrid.styleUI[t].formedit,K=Z.jgrid.styleUI[t].common;return Y=Z.extend(!0,{top:0,left:0,width:"500",datawidth:"auto",height:"auto",dataheight:"auto",modal:!1,overlay:30,drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:!1,jqModal:!0,closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:K.overlay,removemodal:!0,form:"edit",template:null,focusField:!0,editselected:!1,html5Check:!1,buttons:[]},e,Y||{}),$[Z(this)[0].p.id]=Y,this.each(function(){var u=this;if(u.grid&&X){u.p.savedData={};var h,m,i,e,f=u.p.id,g="FrmGrid_"+f,t="TblGrid_"+f,j="#"+Z.jgrid.jqID(t),v={themodal:"editmod"+f,modalhead:"edithd"+f,modalcontent:"editcnt"+f,scrollelm:g},a=!0,d=1,r=0,o="string"==typeof $[u.p.id].template&&0<$[u.p.id].template.length,b=Z.jgrid.getRegional(this,"errors"),M=($[u.p.id].styleUI=u.p.styleUI||"jQueryUI",Z.jgrid.isMobile()&&($[u.p.id].resize=!1),"new"===X?(X="_empty",m="add",Y.caption=$[u.p.id].addCaption):(Y.caption=$[u.p.id].editCaption,m="edit"),Y.recreateForm||Z(u).data("formProp")&&Z.extend($[Z(this)[0].p.id],Z(u).data("formProp")),!0),n=(Y.checkOnUpdate&&Y.jqModal&&!Y.modal&&(M=!1),isNaN($[Z(this)[0].p.id].dataheight)?$[Z(this)[0].p.id].dataheight:$[Z(this)[0].p.id].dataheight+"px"),s=isNaN($[Z(this)[0].p.id].datawidth)?$[Z(this)[0].p.id].datawidth:$[Z(this)[0].p.id].datawidth+"px",w=Z("<form name='FormPost' id='"+g+"' class='FormGrid' onSubmit='return false;' style='width:"+s+";height:"+n+";'></form>").data("disabled",!1),l=o?(s=$[Z(this)[0].p.id].template,n="",i=n="string"==typeof s?s.replace(/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,function(e,t){return'<span id="'+t+'" ></span>'}):n,j):(i=Z("<table id='"+t+"' class='EditTable ui-common-table'><tbody></tbody></table>"),j+"_2"),g="#"+Z.jgrid.jqID(g);if(Z(w).append("<div class='FormError "+K.error+"' style='display:none;'></div>"),Z(w).append("<div class='tinfo topinfo'>"+$[u.p.id].topinfo+"</div>"),Z(u.p.colModel).each(function(){var e=this.formoptions;d=Math.max(d,e&&e.colpos||0),r=Math.max(r,e&&e.rowpos||0)}),Z(w).append(i),!1!==(a=(a=void 0===(a=Z(u).triggerHandler("jqGridAddEditBeforeInitData",[w,m]))?!0:a)&&Z.jgrid.isFunction($[u.p.id].beforeInitData)?$[u.p.id].beforeInitData.call(u,w,m):a)){if("_empty"!==X&&void 0!==u.p.savedRow&&0<u.p.savedRow.length&&Z.jgrid.isFunction(Z.fn.jqGrid.restoreRow))for(e=0;e<u.p.savedRow.length;e++)if(u.p.savedRow[e].id===X){Z(u).jqGrid("restoreRow",X);break}for(var c,p,D,y,B,q,R,x=X,_=u,I=i,k=d,C=0,F=!1,T="",U=1;U<=k;U++)T+="<td class='CaptionTD'></td><td class='DataTD'></td>";"_empty"!==x&&(F=Z(_).jqGrid("getInd",x)),Z(_.p.colModel).each(function(t){if(c=this.name,p=(!this.editrules||!0!==this.editrules.edithidden)&&!0===this.hidden,B=p?"style='display:none'":"","cb"!==c&&"subgrid"!==c&&!0===this.editable&&"rn"!==c&&"sc"!==c){if(!1===F)y="";else if(c===_.p.ExpandColumn&&!0===_.p.treeGrid)y=Z("td[role='gridcell']",_.rows[F]).eq(t).text();else{try{y=Z.unformat.call(_,Z("td[role='gridcell']",_.rows[F]).eq(t),{rowId:x,colModel:this},t)}catch(e){y=this.edittype&&"textarea"===this.edittype?Z("td[role='gridcell']",_.rows[F]).eq(t).text():Z("td[role='gridcell']",_.rows[F]).eq(t).html()}y&&"&nbsp;"!==y&&"&#160;"!==y&&(1!==y.length||160!==y.charCodeAt(0))||(y="")}var e,i=Z.extend({},this.editoptions||{},{id:c,name:c,rowId:x,oper:m,module:"form",checkUpdate:$[u.p.id].checkOnSubmit||$[u.p.id].checkOnUpdate}),a=Z.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),d=parseInt(a.rowpos,10)||C+1,r=parseInt(2*(parseInt(a.colpos,10)||1),10);"_empty"===x&&i.defaultValue&&(y=Z.jgrid.isFunction(i.defaultValue)?i.defaultValue.call(u):i.defaultValue),this.edittype||(this.edittype="text"),u.p.autoencode&&(y=Z.jgrid.htmlDecode(y)),q=Z.jgrid.createEl.call(u,this.edittype,i,y,!1,Z.extend({},Z.jgrid.ajaxOptions,_.p.ajaxSelectOptions||{})),"select"===this.edittype&&(y=Z(q).val(),"select-multiple"===Z(q).get(0).type)&&(y=y&&y.join(",")),"checkbox"===this.edittype&&(y=Z(q).is(":checked")?Z(q).val():Z(q).attr("offval")),Z(q).addClass("FormElement"),"select"===this.edittype?Z(q).addClass(J.selectClass):-1<Z.inArray(this.edittype,["text","textarea","password","color","date","datetime","datetime-local","email","month","number","range","search","tel","time","url","week"])&&Z(q).addClass(J.inputClass),R=!0,o?(e=Z(w).find("#"+c)).length?e.replaceWith(q):R=!1:(D=Z(I).find("tr[rowpos="+d+"]"),a.rowabove&&(e=Z("<tr><td class='contentinfo' colspan='"+2*k+"'>"+a.rowcontent+"</td></tr>"),Z(I).append(e),e[0].rp=d),0===D.length&&(D=Z(1<k?"<tr rowpos='"+d+"'></tr>":"<tr "+B+" rowpos='"+d+"'></tr>").addClass("FormData").attr("id","tr_"+c),Z(D).append(T),Z(I).append(D),D[0].rp=d),Z("td",D[0]).eq(r-2).html("<label for='"+c+"' class='"+J.labelClass+"'>"+(void 0===a.label?_.p.colNames[t]:a.label)+"</label>"),Z("td",D[0]).eq(r-1).append(a.elmprefix).append(q).append(a.elmsuffix),1<k&&p&&(Z("td",D[0]).eq(r-2).hide(),Z("td",D[0]).eq(r-1).hide())),($[u.p.id].checkOnSubmit||$[u.p.id].checkOnUpdate)&&R&&(u.p.savedData[c]=y),"custom"===this.edittype&&Z.jgrid.isFunction(i.custom_value)&&i.custom_value.call(u,Z("#"+c,q),"set",y),Z.jgrid.bindEv.call(u,q,i),C,C++}}),0<C&&((o?(O="<div class='FormData' style='display:none'><input class='FormElement' id='id_g' type='text' name='"+_.p.id+"_id' value='"+x+"'/>",Z(w)):((O=Z("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(2*k-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+_.p.id+"_id' value='"+x+"'/></td></tr>"))[0].rp=C+999,Z(I))).append(O),$[u.p.id].checkOnSubmit||$[u.p.id].checkOnUpdate)&&(u.p.savedData[_.p.id+"_id"]=x);var G,s="rtl"===u.p.direction,n="<a id='"+(s?"nData":"pData")+"' class='fm-button "+K.button+"'><span class='"+K.icon_base+" "+J.icon_prev+"'></span></a>",a="<a id='"+(s?"pData":"nData")+"' class='fm-button "+K.button+"'><span class='"+K.icon_base+" "+J.icon_next+"'></span></a>",O="<a id='sData' class='fm-button "+K.button+"'>"+Y.bSubmit+"</a>",P="<a id='cData' class='fm-button "+K.button+"'>"+Y.bCancel+"</a>",S=Array.isArray($[u.p.id].buttons)?Z.jgrid.buildButtons($[u.p.id].buttons,O+P,K):O+P,S="<table style='height:auto' class='EditTable ui-common-table' id='"+t+"_2'><tbody><tr><td colspan='2'><hr class='"+K.content+"' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(s?a+n:n+a)+"</td><td class='EditButton'>"+S+"</td></tr>",N=(S+="</tbody></table>",0<r&&(G=[],Z.each(Z(i)[0].rows,function(e,t){G[e]=t}),G.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),Z.each(G,function(e,t){Z("tbody",i).append(t)})),Y.gbox="#gbox_"+Z.jgrid.jqID(f),!1),t=(!0===Y.closeOnEscape&&(Y.closeOnEscape=!1,N=!0),n=o?(Z(w).find("#pData").replaceWith(n),Z(w).find("#nData").replaceWith(a),Z(w).find("#sData").replaceWith(O),Z(w).find("#cData").replaceWith(P),Z("<div id="+t+"></div>").append(w)):Z("<div></div>").append(w).append(S),Z(w).append("<div class='binfo topinfo bottominfo'>"+$[u.p.id].bottominfo+"</div>"),Z(".ui-jqgrid").css("font-size")||"11px"),t=(Z.jgrid.createModal(v,n,$[Z(this)[0].p.id],"#gview_"+Z.jgrid.jqID(u.p.id),Z("#gbox_"+Z.jgrid.jqID(u.p.id))[0],null,{"font-size":t}),s&&(Z("#pData, #nData",j+"_2").css("float","right"),Z(".EditButton",j+"_2").css("text-align","left")),$[u.p.id].topinfo&&Z(".tinfo",g).show(),$[u.p.id].bottominfo&&Z(".binfo",g).show(),n=null,Z("#"+Z.jgrid.jqID(v.themodal)).keydown(function(e){var t=e.target;return!0!==Z(g).data("disabled")&&(!0===$[u.p.id].savekey[0]&&e.which===$[u.p.id].savekey[1]&&"TEXTAREA"!==t.tagName?(Z("#sData",j+"_2").trigger("click"),!1):27===e.which?(A()&&N&&Z.jgrid.hideModal("#"+Z.jgrid.jqID(v.themodal),{gb:Y.gbox,jqm:Y.jqModal,onClose:$[u.p.id].onClose,removemodal:$[u.p.id].removemodal,formprop:!$[u.p.id].recreateForm,form:$[u.p.id].form}),!1):!0===$[u.p.id].navkeys[0]?"_empty"===Z("#id_g",j).val()||(e.which===$[u.p.id].navkeys[1]?(Z("#pData",l).trigger("click"),!1):e.which===$[u.p.id].navkeys[2]?(Z("#nData",l).trigger("click"),!1):void 0):void 0)}),Y.checkOnUpdate&&(Z("a.ui-jqdialog-titlebar-close span","#"+Z.jgrid.jqID(v.themodal)).removeClass("jqmClose"),Z("a.ui-jqdialog-titlebar-close","#"+Z.jgrid.jqID(v.themodal)).off("click").click(function(){return A()&&Z.jgrid.hideModal("#"+Z.jgrid.jqID(v.themodal),{gb:"#gbox_"+Z.jgrid.jqID(f),jqm:Y.jqModal,onClose:$[u.p.id].onClose,removemodal:$[u.p.id].removemodal,formprop:!$[u.p.id].recreateForm,form:$[u.p.id].form}),!1})),Y.saveicon=Z.extend([!0,"left",J.icon_save],Y.saveicon),Y.closeicon=Z.extend([!0,"left",J.icon_close],Y.closeicon),!0===Y.saveicon[0]&&Z("#sData",l).addClass("right"===Y.saveicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+K.icon_base+" "+Y.saveicon[2]+"'></span>"),!0===Y.closeicon[0]&&Z("#cData",l).addClass("right"===Y.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+K.icon_base+" "+Y.closeicon[2]+"'></span>"),($[u.p.id].checkOnSubmit||$[u.p.id].checkOnUpdate)&&(O="<a id='sNew' class='fm-button "+K.button+"' style='z-index:1002'>"+Y.bYes+"</a>",a="<a id='nNew' class='fm-button "+K.button+"' style='z-index:1002;margin-left:5px'>"+Y.bNo+"</a>",P="<a id='cNew' class='fm-button "+K.button+"' style='z-index:1002;margin-left:5px;'>"+Y.bExit+"</a>",S=Y.zIndex||999,S++,Z("#"+v.themodal).append("<div class='"+Y.overlayClass+" jqgrid-overlay confirm' style='z-index:"+S+";display:none;position:absolute;'>&#160;</div><div class='confirm ui-jqconfirm "+K.content+"' style='z-index:"+(1+S)+"'>"+Y.saveData+"<br/><br/>"+O+a+P+"</div>"),Z("#sNew","#"+Z.jgrid.jqID(v.themodal)).click(function(){return H(),Z(g).data("disabled",!1),Z(".confirm","#"+Z.jgrid.jqID(v.themodal)).hide(),!1}),Z("#nNew","#"+Z.jgrid.jqID(v.themodal)).click(function(){return Z(".confirm","#"+Z.jgrid.jqID(v.themodal)).hide(),Z(g).data("disabled",!1),setTimeout(function(){Z(":input:visible",g)[0].focus()},0),!1}),Z("#cNew","#"+Z.jgrid.jqID(v.themodal)).click(function(){return Z(".confirm","#"+Z.jgrid.jqID(v.themodal)).hide(),Z(g).data("disabled",!1),Z.jgrid.hideModal("#"+Z.jgrid.jqID(v.themodal),{gb:"#gbox_"+Z.jgrid.jqID(f),jqm:Y.jqModal,onClose:$[u.p.id].onClose,removemodal:$[u.p.id].removemodal,formprop:!$[u.p.id].recreateForm,form:$[u.p.id].form}),!1})),Z(u).triggerHandler("jqGridAddEditInitializeForm",[Z(g),m]),Z.jgrid.isFunction($[u.p.id].onInitializeForm)&&$[u.p.id].onInitializeForm.call(u,Z(g),m),"_empty"!==X&&$[u.p.id].viewPagerButtons?Z("#pData,#nData",l).show():Z("#pData,#nData",l).hide(),Z(u).triggerHandler("jqGridAddEditBeforeShowForm",[Z(g),m]),Z.jgrid.isFunction($[u.p.id].beforeShowForm)&&$[u.p.id].beforeShowForm.call(u,Z(g),m),Q(),Z("#"+Z.jgrid.jqID(v.themodal)).data("onClose",$[u.p.id].onClose),Z.jgrid.viewModal("#"+Z.jgrid.jqID(v.themodal),{gbox:"#gbox_"+Z.jgrid.jqID(f),jqm:Y.jqModal,overlay:Y.overlay,modal:Y.modal,overlayClass:Y.overlayClass,focusField:Y.focusField,onHide:function(e){var t=Z("#editmod"+f)[0].style.width,i=Z("#editmod"+f)[0].style.height,i=["100%","auto"].includes(i)?i:Z.jgrid.floatNum(i,200),t=["100%","auto"].includes(t)?t:Z.jgrid.floatNum(t,300);Z(u).data("formProp",{top:Z.jgrid.floatNum(Z(e.w).css("top")),left:parseFloat(Z(e.w).css("left")),width:t,height:i,dataheight:Z(g).height(),datawidth:Z(g).width()}),e.w.remove(),e.o&&e.o.remove()}}),M||Z("."+Z.jgrid.jqID(Y.overlayClass)).click(function(){return A()&&Z.jgrid.hideModal("#"+Z.jgrid.jqID(v.themodal),{gb:"#gbox_"+Z.jgrid.jqID(f),jqm:Y.jqModal,onClose:$[u.p.id].onClose,removemodal:$[u.p.id].removemodal,formprop:!$[u.p.id].recreateForm,form:$[u.p.id].form}),!1}),Z(".fm-button","#"+Z.jgrid.jqID(v.themodal)).hover(function(){Z(this).addClass(K.hover)},function(){Z(this).removeClass(K.hover)}),Z("#sData",l).click(function(){return h={},Z(".FormError",g).hide(),z(),"_empty"!==h[u.p.id+"_id"]&&!0===Y.checkOnSubmit&&V(h,u.p.savedData)?(Z(g).data("disabled",!0),Z(".confirm","#"+Z.jgrid.jqID(v.themodal)).show()):H(),!1}),Z("#cData",l).click(function(){return A()&&Z.jgrid.hideModal("#"+Z.jgrid.jqID(v.themodal),{gb:"#gbox_"+Z.jgrid.jqID(f),jqm:Y.jqModal,onClose:$[u.p.id].onClose,removemodal:$[u.p.id].removemodal,formprop:!$[u.p.id].recreateForm,form:$[u.p.id].form}),!1}),Z(l).find("[data-index]").each(function(){var t=parseInt(Z(this).attr("data-index"),10);0<=t&&Y.buttons[t].hasOwnProperty("click")&&Z(this).on("click",function(e){Y.buttons[t].click.call(u,Z(g)[0],$[u.p.id],e)})}),Z("#nData",l).click(function(){if(A()){Z(".FormError",g).hide();var e,t=W();if(t[0]=parseInt(t[0],10),-1!==t[0]&&t[1][t[0]+1]){if(Z(u).triggerHandler("jqGridAddEditClickPgButtons",["next",Z(g),t[1][t[0]]]),Z.jgrid.isFunction(Y.onclickPgButtons)&&void 0!==(e=Y.onclickPgButtons.call(u,"next",Z(g),t[1][t[0]]))&&!1===e)return!1;if(Z("#"+Z.jgrid.jqID(t[1][t[0]+1])).hasClass(K.disabled))return!1;E(t[1][t[0]+1],u,g),u.p.multiselect&&$[u.p.id].editselected||Z(u).jqGrid("setSelection",t[1][t[0]+1]),Z(u).triggerHandler("jqGridAddEditAfterClickPgButtons",["next",Z(g),t[1][t[0]]]),Z.jgrid.isFunction(Y.afterclickPgButtons)&&Y.afterclickPgButtons.call(u,"next",Z(g),t[1][t[0]+1]),Q(),L(t[0]+1,t)}}return!1}),Z("#pData",l).click(function(){if(A()){Z(".FormError",g).hide();var e,t=W();if(-1!==t[0]&&t[1][t[0]-1]){if(Z(u).triggerHandler("jqGridAddEditClickPgButtons",["prev",Z(g),t[1][t[0]]]),Z.jgrid.isFunction(Y.onclickPgButtons)&&void 0!==(e=Y.onclickPgButtons.call(u,"prev",Z(g),t[1][t[0]]))&&!1===e)return!1;if(Z("#"+Z.jgrid.jqID(t[1][t[0]-1])).hasClass(K.disabled))return!1;E(t[1][t[0]-1],u,g),u.p.multiselect&&$[u.p.id].editselected||Z(u).jqGrid("setSelection",t[1][t[0]-1]),Z(u).triggerHandler("jqGridAddEditAfterClickPgButtons",["prev",Z(g),t[1][t[0]]]),Z.jgrid.isFunction(Y.afterclickPgButtons)&&Y.afterclickPgButtons.call(u,"prev",Z(g),t[1][t[0]-1]),Q(),L(t[0]-1,t)}}return!1}),Z(u).triggerHandler("jqGridAddEditAfterShowForm",[Z(g),m]),Z.jgrid.isFunction($[u.p.id].afterShowForm)&&$[u.p.id].afterShowForm.call(u,Z(g),m),W());L(t[0],t),this.refreshEditForm=function(e,t){!(t=void 0===t?!1:t)&&X!==e||E(e,this,g),t&&(X=e)}}}function z(){var e,t,a={};for(e in Z(j).find(".FormElement").each(function(){var e,t=Z(".customelement",this);if(t.length){var t=t[0],i=Z(t).attr("name");Z.each(u.p.colModel,function(){if(this.name===i&&this.editoptions&&Z.jgrid.isFunction(this.editoptions.custom_value)){try{var e=this.editoptions.custom_value.call(u,Z("#"+Z.jgrid.jqID(i),j),"get");if("#ignoreme#"!==e){if(void 0===crv)throw"e1";h[i]=e}}catch(e){"e1"===e?Z.jgrid.info_dialog(b.errcap,"function 'custom_value' "+$[Z(this)[0]].p.msg.novalue,$[Z(this)[0]].p.bClose,{styleUI:$[Z(this)[0]].p.styleUI}):Z.jgrid.info_dialog(b.errcap,e.message,$[Z(this)[0]].p.bClose,{styleUI:$[Z(this)[0]].p.styleUI})}return!0}})}else{switch(Z(this).get(0).type){case"checkbox":Z(this).is(":checked")?h[this.name]=Z(this).val():(e=Z(this).attr("offval"),h[this.name]=e);break;case"select-one":h[this.name]=Z(this).val();break;case"select-multiple":h[this.name]=Z(this).val(),h[this.name]=h[this.name]?h[this.name].join(","):"";break;case"radio":if(a.hasOwnProperty(this.name))return!0;a[this.name]=void 0===Z(this).attr("offval")?"off":Z(this).attr("offval");break;default:h[this.name]=Z(this).val()}u.p.autoencode&&(h[this.name]=Z.jgrid.htmlEncode(h[this.name]))}}),a)a.hasOwnProperty(e)&&(t=Z('input[name="'+e+'"]:checked',j).val(),h[e]=void 0!==t?t:a[e],u.p.autoencode)&&(h[e]=Z.jgrid.htmlEncode(h[e]))}function E(i,a,d){var r,o,e,t,n,s,l=0,c=(($[u.p.id].checkOnSubmit||$[u.p.id].checkOnUpdate)&&(u.p.savedData={},u.p.savedData[a.p.id+"_id"]=i),a.p.colModel);"_empty"===i?(Z(c).each(function(){r=this.name,n=Z.extend({},this.editoptions||{}),(e=Z("#"+Z.jgrid.jqID(r),d))&&e.length&&null!==e[0]&&(t="","custom"===this.edittype&&Z.jgrid.isFunction(n.custom_value)?n.custom_value.call(u,Z("#"+r,d),"set",t):n.defaultValue?(t=Z.jgrid.isFunction(n.defaultValue)?n.defaultValue.call(u):n.defaultValue,"checkbox"===e[0].type?(n=t.toLowerCase()).search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==n?(e[0].checked=!0,e[0].defaultChecked=!0,e[0].value=t):(e[0].checked=!1,e[0].defaultChecked=!1):e.val(t)):"checkbox"===e[0].type?(e[0].checked=!1,e[0].defaultChecked=!1,t=Z(e).attr("offval")):e[0].type&&"select"===e[0].type.substr(0,6)?e[0].selectedIndex=0:e.val(t),!0!==$[u.p.id].checkOnSubmit&&!$[u.p.id].checkOnUpdate||(u.p.savedData[r]=t))}),Z("#id_g",d).val(i)):(s=Z(a).jqGrid("getInd",i,!0))&&(Z('td[role="gridcell"]',s).each(function(t){if("cb"!==(r=c[t].name)&&"subgrid"!==r&&"rn"!==r&&!0===c[t].editable&&"sc"!==r){if(r===a.p.ExpandColumn&&!0===a.p.treeGrid)o=Z(this).text();else try{o=Z.unformat.call(a,Z(this),{rowId:i,colModel:c[t]},t)}catch(e){o="textarea"===c[t].edittype?Z(this).text():Z(this).html()}switch(u.p.autoencode&&(o=Z.jgrid.htmlDecode(o)),!0!==$[u.p.id].checkOnSubmit&&!$[u.p.id].checkOnUpdate||(u.p.savedData[r]=o),r=Z.jgrid.jqID(r),c[t].edittype){case"select":var e=o.split(","),e=Z.map(e,function(e){return Z.jgrid.trim(e)});Z("#"+r+" option",d).each(function(){!(c[t].editoptions.multiple||Z.jgrid.trim(o)!==Z.jgrid.trim(Z(this).text())&&e[0]!==Z.jgrid.trim(Z(this).text())&&e[0]!==Z.jgrid.trim(Z(this).val()))||c[t].editoptions.multiple&&(-1<Z.inArray(Z.jgrid.trim(Z(this).text()),e)||-1<Z.inArray(Z.jgrid.trim(Z(this).val()),e))?this.selected=!0:this.selected=!1}),!0!==$[u.p.id].checkOnSubmit&&!$[u.p.id].checkOnUpdate||(o=Z("#"+r,d).val(),c[t].editoptions.multiple&&(o=o.join(",")),u.p.savedData[r]=o);break;case"checkbox":o=String(o),c[t].editoptions&&c[t].editoptions.value?c[t].editoptions.value.split(":")[0]===o?Z("#"+r,d)[u.p.useProp?"prop":"attr"]({checked:!0,defaultChecked:!0}):Z("#"+r,d)[u.p.useProp?"prop":"attr"]({checked:!1,defaultChecked:!1}):(o=o.toLowerCase()).search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==o?(Z("#"+r,d)[u.p.useProp?"prop":"attr"]("checked",!0),Z("#"+r,d)[u.p.useProp?"prop":"attr"]("defaultChecked",!0)):(Z("#"+r,d)[u.p.useProp?"prop":"attr"]("checked",!1),Z("#"+r,d)[u.p.useProp?"prop":"attr"]("defaultChecked",!1)),!0!==$[u.p.id].checkOnSubmit&&!$[u.p.id].checkOnUpdate||(o=Z("#"+r,d).is(":checked")?Z("#"+r,d).val():Z("#"+r,d).attr("offval"),u.p.savedData[r]=o);break;case"custom":try{if(!c[t].editoptions||!Z.jgrid.isFunction(c[t].editoptions.custom_value))throw"e1";c[t].editoptions.custom_value.call(u,Z("#"+r,d),"set",o)}catch(e){"e1"===e?Z.jgrid.info_dialog(b.errcap,"function 'custom_value' "+$[Z(this)[0]].p.msg.nodefined,Z.rp_ge[Z(this)[0]].p.bClose,{styleUI:$[Z(this)[0]].p.styleUI}):Z.jgrid.info_dialog(b.errcap,e.message,Z.rp_ge[Z(this)[0]].p.bClose,{styleUI:$[Z(this)[0]].p.styleUI})}break;default:("&nbsp;"===o||"&#160;"===o||1===o.length&&160===o.charCodeAt(0))&&(o=""),Z("#"+r,d).val(o)}l++}}),0<l)&&(Z("#id_g",j).val(i),!0!==$[u.p.id].checkOnSubmit&&!$[u.p.id].checkOnUpdate||(u.p.savedData[a.p.id+"_id"]=i))}function H(){var d,r,o,e,t,n,i,s=[!0,"",""],a={},l=u.p.prmNames,c=Z(u).triggerHandler("jqGridAddEditBeforeCheckValues",[h,Z(g),m]);if(c&&"object"==typeof c&&(h=c),Z.jgrid.isFunction($[u.p.id].beforeCheckValues)&&(c=$[u.p.id].beforeCheckValues.call(u,h,Z(g),m))&&"object"==typeof c&&(h=c),!$[u.p.id].html5Check||Z.jgrid.validateForm(w[0])){for(e in h)if(h.hasOwnProperty(e)&&!1===(s=Z.jgrid.checkValues.call(u,h[e],e))[0])break;if(Z.each(u.p.colModel,function(e,t){t.editoptions&&!0===t.editoptions.NullIfEmpty&&h.hasOwnProperty(t.name)&&""===h[t.name]&&(h[t.name]="null")}),(s=s[0]&&(void 0===(a=Z(u).triggerHandler("jqGridAddEditClickSubmit",[$[u.p.id],h,m]))&&Z.jgrid.isFunction($[u.p.id].onclickSubmit)&&(a=$[u.p.id].onclickSubmit.call(u,$[u.p.id],h,m)||{}),(s=void 0===(s=Z(u).triggerHandler("jqGridAddEditBeforeSubmit",[h,Z(g),m]))?[!0,"",""]:s)[0])&&Z.jgrid.isFunction($[u.p.id].beforeSubmit)?$[u.p.id].beforeSubmit.call(u,h,Z(g),m):s)[0]&&!$[u.p.id].processing){if($[u.p.id].processing=!0,Z("#sData",j+"_2").addClass(K.active),c=$[u.p.id].url||Z(u).jqGrid("getGridParam","editurl"),o=l.oper,r="clientArray"===c||"storage"===c?u.p.keyName:l.id,h[o]="_empty"===Z.jgrid.trim(h[u.p.id+"_id"])?l.addoper:l.editoper,(h[o]!==l.addoper||void 0===h[r])&&(h[r]=h[u.p.id+"_id"]),delete h[u.p.id+"_id"],h=Z.extend(h,$[u.p.id].editData,a),!0===u.p.treeGrid)for(t in h[o]===l.addoper&&(n=Z(u).jqGrid("getGridParam","selrow"),a="adjacency"===u.p.treeGridModel?u.p.treeReader.parent_id_field:"parent_id",h[a]=n),u.p.treeReader)u.p.treeReader.hasOwnProperty(t)&&(i=u.p.treeReader[t],!h.hasOwnProperty(i)||h[o]===l.addoper&&"parent_id_field"===t||delete h[i]);h[r]=Z.jgrid.stripPref(u.p.idPrefix,h[r]);var p=Z.extend({url:c,type:$[u.p.id].mtype,data:Z.jgrid.isFunction($[u.p.id].serializeEditData)?$[u.p.id].serializeEditData.call(u,h):h,success:function(e,t,i){if(Z("#sData",j+"_2").removeClass(K.active),h[r]=u.p.idPrefix+h[r],300<=i.status&&304!==i.status?(s[0]=!1,s[1]=Z(u).triggerHandler("jqGridAddEditErrorTextFormat",[i,m]),Z.jgrid.isFunction($[u.p.id].errorTextFormat)?s[1]=$[u.p.id].errorTextFormat.call(u,i,m):s[1]=t+" Status: '"+i.statusText+"'. Error code: "+i.status):(s=void 0===(s=Z(u).triggerHandler("jqGridAddEditAfterSubmit",[i,h,m]))?[!0,"",""]:s)[0]&&Z.jgrid.isFunction($[u.p.id].afterSubmit)&&(s=$[u.p.id].afterSubmit.call(u,i,h,m)),!1===s[0])Z(".FormError",g).html(s[1]),Z(".FormError",g).show();else if(u.p.autoencode&&Z.each(h,function(e,t){h[e]=Z.jgrid.htmlDecode(t)}),h[o]===l.addoper?(s[2]||(s[2]=Z.jgrid.randId()),null==h[r]||h[r]===u.p.idPrefix+"_empty"||""===h[r]?h[r]=s[2]:s[2]=h[r],$[u.p.id].reloadAfterSubmit?Z(u).trigger("reloadGrid"):!0===u.p.treeGrid?Z(u).jqGrid("addChildNode",s[2],n,h):Z(u).jqGrid("addRowData",s[2],h,Y.addedrow),$[u.p.id].closeAfterAdd?(!0!==u.p.treeGrid&&Z(u).jqGrid("setSelection",s[2]),Z.jgrid.hideModal("#"+Z.jgrid.jqID(v.themodal),{gb:"#gbox_"+Z.jgrid.jqID(f),jqm:Y.jqModal,onClose:$[u.p.id].onClose,removemodal:$[u.p.id].removemodal,formprop:!$[u.p.id].recreateForm,form:$[u.p.id].form})):$[u.p.id].clearAfterAdd&&E("_empty",u,g)):($[u.p.id].reloadAfterSubmit?(Z(u).trigger("reloadGrid"),$[u.p.id].closeAfterEdit||setTimeout(function(){Z(u).jqGrid("setSelection",h[r])},1e3)):!0===u.p.treeGrid?Z(u).jqGrid("setTreeRow",h[r],h):Z(u).jqGrid("setRowData",h[r],h),$[u.p.id].closeAfterEdit&&Z.jgrid.hideModal("#"+Z.jgrid.jqID(v.themodal),{gb:"#gbox_"+Z.jgrid.jqID(f),jqm:Y.jqModal,onClose:$[u.p.id].onClose,removemodal:$[u.p.id].removemodal,formprop:!$[u.p.id].recreateForm,form:$[u.p.id].form})),(Z.jgrid.isFunction($[u.p.id].afterComplete)||Object.prototype.hasOwnProperty.call(Z._data(Z(u)[0],"events"),"jqGridAddEditAfterComplete"))&&(d=i,setTimeout(function(){Z(u).triggerHandler("jqGridAddEditAfterComplete",[d,h,Z(g),m]);try{$[u.p.id].afterComplete.call(u,d,h,Z(g),m)}catch(e){}d=null},500)),($[u.p.id].checkOnSubmit||$[u.p.id].checkOnUpdate)&&(Z(g).data("disabled",!1),"_empty"!==u.p.savedData[u.p.id+"_id"]))for(var a in u.p.savedData)u.p.savedData.hasOwnProperty(a)&&h[a]&&(u.p.savedData[a]=h[a]);$[u.p.id].processing=!1;try{Z(":input:visible",g)[0].focus()}catch(e){}}},Z.jgrid.ajaxOptions,$[u.p.id].ajaxEditOptions);p.url||$[u.p.id].useDataProxy||(Z.jgrid.isFunction(u.p.dataProxy)?$[u.p.id].useDataProxy=!0:(s[0]=!1,s[1]+=" "+b.nourl)),s[0]&&($[u.p.id].useDataProxy?!1===(a=void 0===(a=u.p.dataProxy.call(u,p,"set_"+u.p.id))?[!0,""]:a)[0]?(s[0]=!1,s[1]=a[1]||"Error processing the row!"):(p.data.oper===l.addoper&&$[u.p.id].closeAfterAdd&&Z.jgrid.hideModal("#"+Z.jgrid.jqID(v.themodal),{gb:"#gbox_"+Z.jgrid.jqID(f),jqm:Y.jqModal,onClose:$[u.p.id].onClose,removemodal:$[u.p.id].removemodal,formprop:!$[u.p.id].recreateForm,form:$[u.p.id].form}),p.data.oper===l.editoper&&$[u.p.id].closeAfterEdit&&Z.jgrid.hideModal("#"+Z.jgrid.jqID(v.themodal),{gb:"#gbox_"+Z.jgrid.jqID(f),jqm:Y.jqModal,onClose:$[u.p.id].onClose,removemodal:$[u.p.id].removemodal,formprop:!$[u.p.id].recreateForm,form:$[u.p.id].form})):"clientArray"===p.url?($[u.p.id].reloadAfterSubmit=!1,h=p.data,p.success(h,"",{status:200,statusText:""})):"storage"===p.url?h[o]===l.addoper?("_empty"===h[r]&&(h[r]=""),Z(u).jqGrid("addStorageRecord",h).then(function(e){"complete"===e.type&&p.success(h,"",{status:200,statusText:""})}).catch(function(e){Z.jgrid.info_dialog("Error",e.target.error.name+" : "+e.target.error.message,"Close")})):h[o]===l.editoper&&Z(u).jqGrid("updateStorageRecord",h).then(function(e){"complete"===e.type&&p.success(h,"",{status:200,statusText:""})}).catch(function(e){Z.jgrid.info_dialog("Error",e.target.error.name+" : "+e.target.error.message,"Close")}):Z.ajax(p))}!1===s[0]&&(Z(g).scrollTop(0),Z(".FormError",g).html(s[1]),Z(".FormError",g).show())}}function V(e,t){var i,a=!1;if(!(a=!(Z.isPlainObject(e)&&Z.isPlainObject(t)&&Object.getOwnPropertyNames(e).length===Object.getOwnPropertyNames(t).length)))for(i in t)if(t.hasOwnProperty(i)){if(!e.hasOwnProperty(i)){a=!0;break}if(e[i]!==t[i]){a=!0;break}}return a}function A(){var e=!0;return Z(".FormError",g).hide(),$[u.p.id].checkOnUpdate&&(h={},z(),V(h,u.p.savedData))&&(Z(g).data("disabled",!0),Z(".confirm","#"+v.themodal).show(),e=!1),e}function L(e,t){var i=t[1].length-1;0===e||void 0!==t[1][e-1]&&Z("#"+Z.jgrid.jqID(t[1][e-1])).hasClass(K.disabled)?Z("#pData",l).addClass(K.disabled):Z("#pData",l).removeClass(K.disabled),e===i||void 0!==t[1][e+1]&&Z("#"+Z.jgrid.jqID(t[1][e+1])).hasClass(K.disabled)?Z("#nData",l).addClass(K.disabled):Z("#nData",l).removeClass(K.disabled)}function W(){var e=Z(u).jqGrid("getDataIDs"),t=Z("#id_g",j).val();if(u.p.multiselect&&$[u.p.id].editselected){for(var i=[],a=0,d=e.length;a<d;a++)-1!==Z.inArray(e[a],u.p.selarrrow)&&i.push(e[a]);return[Z.inArray(t,i),i]}return[Z.inArray(t,e),e]}function Q(){if($[u.p.id].checkOnSubmit||$[u.p.id].checkOnUpdate){var e,t,i=[],a={},i=Z.map(u.p.savedData,function(e,t){return t});for(e in Z(".FormElement",w).each(function(){if(""!==Z.jgrid.trim(this.name)&&-1===i.indexOf(this.name)){var e=Z(this).val(),t=Z(this).get(0).type;if("checkbox"===t)Z(this).is(":checked")||(e=Z(this).attr("offval"));else if("select-multiple"===t)e=e.join(",");else if("radio"===t){if(a.hasOwnProperty(this.name))return!0;a[this.name]=void 0===Z(this).attr("offval")?"off":Z(this).attr("offval")}u.p.savedData[this.name]=e}}),a)a.hasOwnProperty(e)&&(t=Z('input[name="'+e+'"]:checked',w).val(),u.p.savedData[e]=void 0!==t?t:a[e])}}})},viewGridRow:function(R,T){var e=Z.jgrid.getRegional(this[0],"view"),t=this[0].p.styleUI,U=Z.jgrid.styleUI[t].formedit,N=Z.jgrid.styleUI[t].common;return T=Z.extend(!0,{top:0,left:0,width:500,datawidth:"auto",height:"auto",dataheight:"auto",modal:!1,overlay:30,drag:!0,resize:!0,jqModal:!0,closeOnEscape:!1,labelswidth:"auto",closeicon:[],navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,recreateForm:!1,removemodal:!0,form:"view",buttons:[]},e,T||{}),$[Z(this)[0].p.id]=T,this.each(function(){var r=this;if(r.grid&&R){var a=r.p.id,d="ViewGrid_"+Z.jgrid.jqID(a),n="ViewTbl_"+Z.jgrid.jqID(a),i="ViewGrid_"+a,e="ViewTbl_"+a,t={themodal:"viewmod"+a,modalhead:"viewhd"+a,modalcontent:"viewcnt"+a,scrollelm:d},o=!0,s=1,l=0,c=($[r.p.id].styleUI=r.p.styleUI||"jQueryUI",T.recreateForm||Z(r).data("viewProp")&&Z.extend($[Z(this)[0].p.id],Z(r).data("viewProp")),isNaN($[Z(this)[0].p.id].dataheight)?$[Z(this)[0].p.id].dataheight:$[Z(this)[0].p.id].dataheight+"px"),p=isNaN($[Z(this)[0].p.id].datawidth)?$[Z(this)[0].p.id].datawidth:$[Z(this)[0].p.id].datawidth+"px",p=Z("<form name='FormPost' id='"+i+"' class='FormGrid' style='width:"+p+";height:"+c+";'></form>"),u=Z("<table id='"+e+"' class='EditTable ViewTable'><tbody></tbody></table>");if(Z(r.p.colModel).each(function(){var e=this.formoptions;s=Math.max(s,e&&e.colpos||0),l=Math.max(l,e&&e.rowpos||0)}),Z(p).append(u),!1!==(o=(o=void 0===(o=Z(r).triggerHandler("jqGridViewRowBeforeInitData",[p]))?!0:o)&&Z.jgrid.isFunction($[r.p.id].beforeInitData)?$[r.p.id].beforeInitData.call(r,p):o)){for(var h,m,f,g,j,v,b,w,c=R,D=r,y=u,q=s,x=0,_="<td class='CaptionTD form-view-label "+N.content+"' width='"+T.labelswidth+"'></td><td class='DataTD form-view-data ui-helper-reset "+N.content+"'></td>",I="",M="<td class='CaptionTD form-view-label "+N.content+"'></td><td class='DataTD form-view-data "+N.content+"'></td>",B=["integer","number","currency"],k=0,C=0,F=1;F<=q;F++)I+=1===F?_:M;Z(D.p.colModel).each(function(){(m=(!this.editrules||!0!==this.editrules.edithidden)&&!0===this.hidden)||"right"!==this.align||(this.formatter&&-1!==Z.inArray(this.formatter,B)?k=Math.max(k,parseInt(this.width,10)):C=Math.max(C,parseInt(this.width,10)))}),v=0!==k?k:0!==C?C:0,j=Z(D).jqGrid("getInd",c),Z(D.p.colModel).each(function(e){var t,i,a,d;h=this.name,m=(!this.editrules||!0!==this.editrules.edithidden)&&!0===this.hidden,g=m?"style='display:none'":"",w="boolean"!=typeof this.viewable||this.viewable,"cb"!==h&&"subgrid"!==h&&"rn"!==h&&w&&"sc"!==h&&(w=!1===j?"":h===D.p.ExpandColumn&&!0===D.p.treeGrid?Z("td",D.rows[j]).eq(e).text():Z("td",D.rows[j]).eq(e).html(),b="right"===this.align&&0!==v,t=Z.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),i=parseInt(t.rowpos,10)||x+1,a=parseInt(2*(parseInt(t.colpos,10)||1),10),t.rowabove&&(d=Z("<tr><td class='contentinfo' colspan='"+2*q+"'>"+t.rowcontent+"</td></tr>"),Z(y).append(d),d[0].rp=i),0===(f=Z(y).find("tr[rowpos="+i+"]")).length&&(f=Z("<tr "+g+" rowpos='"+i+"'></tr>").addClass("FormData").attr("id","trv_"+h),Z(f).append(I),Z(y).append(f),f[0].rp=i),Z("td",f[0]).eq(a-2).html("<b>"+(void 0===t.label?D.p.colNames[e]:t.label)+"</b>"),Z("td",f[0]).eq(a-1).append("<span>"+w+"</span>").attr("id","v_"+h),b&&Z("td",f[0]).eq(a-1).find("span").css({"text-align":"right",width:v+"px"}),x,x++)}),0<x&&((c=Z("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(2*q-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+c+"'/></td></tr>"))[0].rp=x+99,Z(y).append(c));var G,e="rtl"===r.p.direction,o="<a id='"+(e?"nData":"pData")+"' class='fm-button "+N.button+"'><span class='"+N.icon_base+" "+U.icon_prev+"'></span></a>",c="<a id='"+(e?"pData":"nData")+"' class='fm-button "+N.button+"'><span class='"+N.icon_base+" "+U.icon_next+"'></span></a>",O="<a id='cData' class='fm-button "+N.button+"'>"+T.bClose+"</a>",O=Array.isArray($[r.p.id].buttons)?Z.jgrid.buildButtons($[r.p.id].buttons,O,N):O,p=(0<l&&(G=[],Z.each(Z(u)[0].rows,function(e,t){G[e]=t}),G.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),Z.each(G,function(e,t){Z("tbody",u).append(t)})),T.gbox="#gbox_"+Z.jgrid.jqID(a),Z("<div></div>").append(p).append("<table border='0' class='EditTable' id='"+n+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+T.labelswidth+"'>"+(e?c+o:o+c)+"</td><td class='EditButton'>"+O+"</td></tr></tbody></table>")),o=Z(".ui-jqgrid").css("font-size")||"11px",c=(Z.jgrid.createModal(t,p,$[Z(this)[0].p.id],"#gview_"+Z.jgrid.jqID(r.p.id),Z("#gview_"+Z.jgrid.jqID(r.p.id))[0],null,{"font-size":o}),e&&(Z("#pData, #nData","#"+n+"_2").css("float","right"),Z(".EditButton","#"+n+"_2").css("text-align","left")),T.viewPagerButtons||Z("#pData, #nData","#"+n+"_2").hide(),Z("#"+t.themodal).keydown(function(e){return 27===e.which?($[r.p.id].closeOnEscape&&Z.jgrid.hideModal("#"+Z.jgrid.jqID(t.themodal),{gb:T.gbox,jqm:T.jqModal,onClose:T.onClose,removemodal:$[r.p.id].removemodal,formprop:!$[r.p.id].recreateForm,form:$[r.p.id].form}),!1):!0===T.navkeys[0]?e.which===T.navkeys[1]?(Z("#pData","#"+n+"_2").trigger("click"),!1):e.which===T.navkeys[2]?(Z("#nData","#"+n+"_2").trigger("click"),!1):void 0:void 0}),T.closeicon=Z.extend([!0,"left",U.icon_close],T.closeicon),!0===T.closeicon[0]&&Z("#cData","#"+n+"_2").addClass("right"===T.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+N.icon_base+" "+T.closeicon[2]+"'></span>"),Z(r).triggerHandler("jqGridViewRowBeforeShowForm",[Z("#"+d)]),Z.jgrid.isFunction(T.beforeShowForm)&&T.beforeShowForm.call(r,Z("#"+d)),Z.jgrid.viewModal("#"+Z.jgrid.jqID(t.themodal),{gbox:"#gbox_"+Z.jgrid.jqID(a),jqm:T.jqModal,overlay:T.overlay,modal:T.modal,onHide:function(e){var t="rtl"===Z("#gbox_"+Z.jgrid.jqID(a)).attr("dir"),i=parseFloat(Z("#viewmod"+a)[0].style.width);Z(r).data("viewProp",{top:parseFloat(Z(e.w).css("top")),left:t?Z("#gbox_"+Z.jgrid.jqID(a)).outerWidth()-i-parseFloat(Z(e.w).css("left"))+12:parseFloat(Z(e.w).css("left")),width:Z(e.w).width(),height:Z(e.w).height(),dataheight:Z("#"+d).height(),datawidth:Z("#"+d).width()}),e.w.remove(),e.o&&e.o.remove()}}),Z(".fm-button:not(."+N.disabled+")","#"+n+"_2").hover(function(){Z(this).addClass(N.hover)},function(){Z(this).removeClass(N.hover)}),P(),Z("#cData","#"+n+"_2").click(function(){return Z.jgrid.hideModal("#"+Z.jgrid.jqID(t.themodal),{gb:"#gbox_"+Z.jgrid.jqID(a),jqm:T.jqModal,onClose:T.onClose,removemodal:$[r.p.id].removemodal,formprop:!$[r.p.id].recreateForm,form:$[r.p.id].form}),!1}),Z("#"+n+"_2").find("[data-index]").each(function(){var t=parseInt(Z(this).attr("data-index"),10);0<=t&&T.buttons[t].hasOwnProperty("click")&&Z(this).on("click",function(e){T.buttons[t].click.call(r,Z("#"+i)[0],$[r.p.id],e)})}),Z("#nData","#"+n+"_2").click(function(){Z("#FormError","#"+n).hide();var e=A();return e[0]=parseInt(e[0],10),-1!==e[0]&&e[1][e[0]+1]&&(Z(r).triggerHandler("jqGridViewRowClickPgButtons",["next",Z("#"+d),e[1][e[0]]]),Z.jgrid.isFunction(T.onclickPgButtons)&&T.onclickPgButtons.call(r,"next",Z("#"+d),e[1][e[0]]),S(e[1][e[0]+1],r),r.p.multiselect&&$[r.p.id].viewselected||Z(r).jqGrid("setSelection",e[1][e[0]+1]),Z(r).triggerHandler("jqGridViewRowAfterClickPgButtons",["next",Z("#"+d),e[1][e[0]+1]]),Z.jgrid.isFunction(T.afterclickPgButtons)&&T.afterclickPgButtons.call(r,"next",Z("#"+d),e[1][e[0]+1]),E(e[0]+1,e)),P(),!1}),Z("#pData","#"+n+"_2").click(function(){Z("#FormError","#"+n).hide();var e=A();return-1!==e[0]&&e[1][e[0]-1]&&(Z(r).triggerHandler("jqGridViewRowClickPgButtons",["prev",Z("#"+d),e[1][e[0]]]),Z.jgrid.isFunction(T.onclickPgButtons)&&T.onclickPgButtons.call(r,"prev",Z("#"+d),e[1][e[0]]),S(e[1][e[0]-1],r),r.p.multiselect&&$[r.p.id].viewselected||Z(r).jqGrid("setSelection",e[1][e[0]-1]),Z(r).triggerHandler("jqGridViewRowAfterClickPgButtons",["prev",Z("#"+d),e[1][e[0]-1]]),Z.jgrid.isFunction(T.afterclickPgButtons)&&T.afterclickPgButtons.call(r,"prev",Z("#"+d),e[1][e[0]-1]),E(e[0]-1,e)),P(),!1}),A());E(c[0],c),this.refreshViewForm=function(e,t){!(t=void 0===t?!1:t)&&R!==e||S(e,this),t&&(R=e)}}}function P(){!0!==$[r.p.id].closeOnEscape&&!0!==$[r.p.id].navkeys[0]||setTimeout(function(){Z(".ui-jqdialog-titlebar-close","#"+Z.jgrid.jqID(t.modalhead)).attr("tabindex","-1").focus()},0)}function S(e,t){var i,a,d,r=0,o=Z(t).jqGrid("getInd",e,!0);o&&(Z("td",o).each(function(e){i=t.p.colModel[e].name,a=(!t.p.colModel[e].editrules||!0!==t.p.colModel[e].editrules.edithidden)&&!0===t.p.colModel[e].hidden,"cb"!==i&&"subgrid"!==i&&"rn"!==i&&"sc"!==i&&(d=i===t.p.ExpandColumn&&!0===t.p.treeGrid?Z(this).text():Z(this).html(),i=Z.jgrid.jqID("v_"+i),Z("#"+i+" span","#"+n).html(d),a&&Z("#"+i,"#"+n).parents("tr").first().hide(),r++)}),0<r)&&Z("#id_g","#"+n).val(e)}function E(e,t){var i=t[1].length-1;0===e?Z("#pData","#"+n+"_2").addClass(N.disabled):void 0!==t[1][e-1]&&Z("#"+Z.jgrid.jqID(t[1][e-1])).hasClass(N.disabled)?Z("#pData",n+"_2").addClass(N.disabled):Z("#pData","#"+n+"_2").removeClass(N.disabled),e===i?Z("#nData","#"+n+"_2").addClass(N.disabled):void 0!==t[1][e+1]&&Z("#"+Z.jgrid.jqID(t[1][e+1])).hasClass(N.disabled)?Z("#nData",n+"_2").addClass(N.disabled):Z("#nData","#"+n+"_2").removeClass(N.disabled)}function A(){var e=Z(r).jqGrid("getDataIDs"),t=Z("#id_g","#"+n).val();if(r.p.multiselect&&$[r.p.id].viewselected){for(var i=[],a=0,d=e.length;a<d;a++)-1!==Z.inArray(e[a],r.p.selarrrow)&&i.push(e[a]);return[Z.inArray(t,i),i]}return[Z.inArray(t,e),e]}})},delGridRow:function(h,m){var e=Z.jgrid.getRegional(this[0],"del"),t=this[0].p.styleUI,f=Z.jgrid.styleUI[t].formedit,g=Z.jgrid.styleUI[t].common;return m=Z.extend(!0,{top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:!1,overlay:30,drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:!0,closeOnEscape:!1,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},e,m||{}),$[Z(this)[0].p.id]=m,this.each(function(){var n=this;if(n.grid&&h){var s,a,d,l=n.p.id,c={},e=!0,p="DelTbl_"+Z.jgrid.jqID(l),i="DelTbl_"+l,u={themodal:"delmod"+l,modalhead:"delhd"+l,modalcontent:"delcnt"+l,scrollelm:p};if($[n.p.id].styleUI=n.p.styleUI||"jQueryUI",Array.isArray(h)&&(h=h.join()),void 0!==Z("#"+Z.jgrid.jqID(u.themodal))[0]){if(!1===(e=(e=void 0===(e=Z(n).triggerHandler("jqGridDelRowBeforeInitData",[Z("#"+p)]))?!0:e)&&Z.jgrid.isFunction($[n.p.id].beforeInitData)?$[n.p.id].beforeInitData.call(n,Z("#"+p)):e))return;Z("#DelData>td","#"+p).text(h),Z("#DelError","#"+p).hide(),!0===$[n.p.id].processing&&($[n.p.id].processing=!1,Z("#dData","#"+p).removeClass(g.active))}else{var t=isNaN($[n.p.id].dataheight)?$[n.p.id].dataheight:$[n.p.id].dataheight+"px",r=isNaN(m.datawidth)?m.datawidth:m.datawidth+"px",r="<div id='"+i+"' class='formdata' style='width:"+r+";overflow:auto;position:relative;height:"+t+";'>",t=(r=(r=(r=r+"<table class='DelTable'><tbody>"+("<tr id='DelError' style='display:none'><td class='"+g.error+"'></td></tr>"))+("<tr id='DelData' style='display:none'><td >"+h+"</td></tr>"))+('<tr><td class="delmsg" style="white-space:pre;">'+$[n.p.id].msg+"</td></tr><tr><td >&#160;</td></tr>")+"</tbody></table></div>","<a id='dData' class='fm-button "+g.button+"'>"+m.bSubmit+"</a>"),o="<a id='eData' class='fm-button "+g.button+"'>"+m.bCancel+"</a>",t=Array.isArray($[n.p.id].buttons)?Z.jgrid.buildButtons($[n.p.id].buttons,t+o,g):t+o,o=Z(".ui-jqgrid").css("font-size")||"11px";if(r+="<table class='EditTable ui-common-table' id='"+p+"_2'><tbody><tr><td><hr class='"+g.content+"' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton'>"+t+"</td></tr></tbody></table>",m.gbox="#gbox_"+Z.jgrid.jqID(l),Z.jgrid.createModal(u,r,$[n.p.id],"#gview_"+Z.jgrid.jqID(n.p.id),Z("#gview_"+Z.jgrid.jqID(n.p.id))[0],null,{"font-size":o}),Z(".fm-button","#"+p+"_2").hover(function(){Z(this).addClass(g.hover)},function(){Z(this).removeClass(g.hover)}),m.delicon=Z.extend([!0,"left",f.icon_del],$[n.p.id].delicon),m.cancelicon=Z.extend([!0,"left",f.icon_cancel],$[n.p.id].cancelicon),!0===m.delicon[0]&&Z("#dData","#"+p+"_2").addClass("right"===m.delicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+g.icon_base+" "+m.delicon[2]+"'></span>"),!0===m.cancelicon[0]&&Z("#eData","#"+p+"_2").addClass("right"===m.cancelicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+g.icon_base+" "+m.cancelicon[2]+"'></span>"),Z("#dData","#"+p+"_2").click(function(){var e,r=[!0,""],o=Z("#DelData>td","#"+p).text();if(c={},void 0===(c=Z(n).triggerHandler("jqGridDelRowClickSubmit",[$[n.p.id],o]))&&Z.jgrid.isFunction($[n.p.id].onclickSubmit)&&(c=$[n.p.id].onclickSubmit.call(n,$[n.p.id],o)||{}),(r=(r=void 0===(r=Z(n).triggerHandler("jqGridDelRowBeforeSubmit",[o]))?[!0,"",""]:r)[0]&&Z.jgrid.isFunction($[n.p.id].beforeSubmit)?$[n.p.id].beforeSubmit.call(n,o):r)[0]&&!$[n.p.id].processing){if($[n.p.id].processing=!0,a=n.p.prmNames,s=Z.extend({},$[n.p.id].delData,c),d=a.oper,s[d]=a.deloper,d=a.id,!(o=String(o).split(",")).length)return!1;for(e in o)o.hasOwnProperty(e)&&(o[e]=Z.jgrid.stripPref(n.p.idPrefix,o[e]));s[d]=o.join(),Z(this).addClass(g.active);var t,i=Z.extend({url:$[n.p.id].url||Z(n).jqGrid("getGridParam","editurl"),type:$[n.p.id].mtype,data:Z.jgrid.isFunction($[n.p.id].serializeDelData)?$[n.p.id].serializeDelData.call(n,s):s,success:function(e,t,i){var a,d;if(Z("#dData","#"+p+"_2").removeClass(g.active),300<=i.status&&304!==i.status?(r[0]=!1,r[1]=Z(n).triggerHandler("jqGridDelRowErrorTextFormat",[i]),Z.jgrid.isFunction($[n.p.id].errorTextFormat)&&(r[1]=$[n.p.id].errorTextFormat.call(n,i)),void 0===r[1]&&(r[1]=t+" Status: '"+i.statusText+"'. Error code: "+i.status)):(r=void 0===(r=Z(n).triggerHandler("jqGridDelRowAfterSubmit",[i,s]))?[!0,"",""]:r)[0]&&Z.jgrid.isFunction($[n.p.id].afterSubmit)&&(r=$[n.p.id].afterSubmit.call(n,i,s)),!1===r[0])Z("#DelError>td","#"+p).html(r[1]),Z("#DelError","#"+p).show();else{if($[n.p.id].reloadAfterSubmit&&"local"!==n.p.datatype)Z(n).trigger("reloadGrid");else{if(!0===n.p.treeGrid)try{Z(n).jqGrid("delTreeNode",n.p.idPrefix+o[0],!0)}catch(e){}else for(a=0;a<o.length;a++)Z(n).jqGrid("delRowData",n.p.idPrefix+o[a]);n.p.selrow=null,n.p.selarrrow=[]}(Z.jgrid.isFunction($[n.p.id].afterComplete)||Object.prototype.hasOwnProperty.call(Z._data(Z(n)[0],"events"),"jqGridDelRowAfterComplete"))&&(d=i,setTimeout(function(){Z(n).triggerHandler("jqGridDelRowAfterComplete",[d,s]);try{$[n.p.id].afterComplete.call(n,d,s)}catch(e){}},500))}$[n.p.id].processing=!1,r[0]&&Z.jgrid.hideModal("#"+Z.jgrid.jqID(u.themodal),{gb:"#gbox_"+Z.jgrid.jqID(l),jqm:m.jqModal,onClose:$[n.p.id].onClose})}},Z.jgrid.ajaxOptions,$[n.p.id].ajaxDelOptions);i.url||$[n.p.id].useDataProxy||(Z.jgrid.isFunction(n.p.dataProxy)?$[n.p.id].useDataProxy=!0:(r[0]=!1,r[1]+=" "+Z.jgrid.getRegional(n,"errors.nourl"))),r[0]&&($[n.p.id].useDataProxy?!1===(t=void 0===(t=n.p.dataProxy.call(n,i,"del_"+n.p.id))?[!0,""]:t)[0]?(r[0]=!1,r[1]=t[1]||"Error deleting the selected row!"):Z.jgrid.hideModal("#"+Z.jgrid.jqID(u.themodal),{gb:"#gbox_"+Z.jgrid.jqID(l),jqm:m.jqModal,onClose:$[n.p.id].onClose}):"clientArray"===i.url?(s=i.data,i.success({status:200,statusText:""},"")):"storage"===i.url?Z(n).jqGrid("deleteStorageRecord",o).then(function(e){"complete"===e.type&&i.success(o,"",{status:200,statusText:""})}).catch(function(e){Z.jgrid.info_dialog("Error",e.target.error.name+" : "+e.target.error.message,"Close")}):Z.ajax(i))}return!1===r[0]&&(Z("#DelError>td","#"+p).html(r[1]),Z("#DelError","#"+p).show()),!1}),Z("#eData","#"+p+"_2").click(function(){return Z.jgrid.hideModal("#"+Z.jgrid.jqID(u.themodal),{gb:"#gbox_"+Z.jgrid.jqID(l),jqm:$[n.p.id].jqModal,onClose:$[n.p.id].onClose}),!1}),Z("#"+p+"_2").find("[data-index]").each(function(){var t=parseInt(Z(this).attr("data-index"),10);0<=t&&m.buttons[t].hasOwnProperty("click")&&Z(this).on("click",function(e){m.buttons[t].click.call(n,Z("#"+i)[0],$[n.p.id],e)})}),!1===(e=(e=void 0===(e=Z(n).triggerHandler("jqGridDelRowBeforeInitData",[Z("#"+p)]))?!0:e)&&Z.jgrid.isFunction($[n.p.id].beforeInitData)?$[n.p.id].beforeInitData.call(n,Z("#"+p)):e))return}Z(n).triggerHandler("jqGridDelRowBeforeShowForm",[Z("#"+p)]),Z.jgrid.isFunction($[n.p.id].beforeShowForm)&&$[n.p.id].beforeShowForm.call(n,Z("#"+p)),Z.jgrid.viewModal("#"+Z.jgrid.jqID(u.themodal),{gbox:"#gbox_"+Z.jgrid.jqID(l),jqm:$[n.p.id].jqModal,overlay:$[n.p.id].overlay,modal:$[n.p.id].modal}),Z(n).triggerHandler("jqGridDelRowAfterShowForm",[Z("#"+p)]),Z.jgrid.isFunction($[n.p.id].afterShowForm)&&$[n.p.id].afterShowForm.call(n,Z("#"+p)),!0===$[n.p.id].closeOnEscape&&setTimeout(function(){Z(".ui-jqdialog-titlebar-close","#"+Z.jgrid.jqID(u.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(m,f,g,j,v,b,w){var D=Z.jgrid.getRegional(this[0],"nav"),y=this[0].p.styleUI,e=Z.jgrid.styleUI[y].navigator,q=Z.jgrid.styleUI[y].common;return f=Z.extend({edit:!0,editicon:e.icon_edit_nav,add:!0,addicon:e.icon_add_nav,del:!0,delicon:e.icon_del_nav,search:!0,searchicon:e.icon_search_nav,refresh:!0,refreshicon:e.icon_refresh_nav,refreshstate:"firstpage",view:!1,viewicon:e.icon_view_nav,position:"left",closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,alertwidth:200,alertheight:"auto",alerttop:null,alertleft:null,alertzIndex:null,dropmenu:!1,navButtonText:""},D,f||{}),this.each(function(){if(!this.p.navGrid){var t,i=this;if(i.grid&&"string"==typeof m){Z(i).data("navGrid")||Z(i).data("navGrid",f),t=Z(i).data("navGrid"),(t=i.p.force_regional?Z.extend(t,D):t).alerttop||t.alertleft||((e=Z.jgrid.findPos(this))[0]=Math.round(e[0]),e[1]=Math.round(e[1]),0===(a=isNaN(this.p.height)?Z(i.grid.bDiv).height():this.p.height)&&(a=200),t.alertleft=e[0]+this.p.width/2-parseInt(t.alertwidth,10)/2,t.alerttop=e[1]+a/2-25);var e,a,d,r=function(){Z.jgrid.info_dialog(t.alertcap,"<div>"+t.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>","",{jqModal:!0,drag:!0,resize:!0,caption:t.alertcap,width:t.alertwidth,height:t.alertheight,top:t.alerttop,left:t.alertleft,closeOnEscape:t.closeOnEscape,styleUI:i.p.styleUI,zIndex:t.alertzIndex})},o=1,n=function(){Z(this).hasClass(q.disabled)||Z(this).addClass(q.hover)},s=function(){Z(this).removeClass(q.hover)};for(t.cloneToTop&&i.p.toppager&&(o=2),d=0;d<o;d++){var l,c,p,u=Z("<table class='ui-pg-table navtable ui-common-table'><tbody><tr></tr></tbody></table>"),h="<td class='ui-pg-button "+q.disabled+"' style='width:4px;'><span class='ui-separator'></span></td>";0===d?(0===(c=m).indexOf("#")&&(c=c.substring(1),c="#"+Z.jgrid.jqID(c)),p=i.p.id,c===i.p.toppager&&(p+="_top",o=1)):(c=i.p.toppager,p=i.p.id+"_top"),"rtl"===i.p.direction&&Z(u).attr("dir","rtl").css("float","right"),j=j||{},t.add&&(l=Z("<td class='ui-pg-button "+q.cornerall+"'></td>"),Z(l).append("<div class='ui-pg-div'><span class='"+q.icon_base+" "+t.addicon+"'></span>"+t.addtext+"</div>"),Z("tr",u).append(l),Z(l,u).attr({title:t.addtitle||"",id:j.id||"add_"+p}).click(function(){return Z(this).hasClass(q.disabled)||(Z.jgrid.setSelNavIndex(i,this),Z.jgrid.isFunction(t.addfunc)?t.addfunc.call(i):Z(i).jqGrid("editGridRow","new",j)),!1}).hover(n,s),l=null),g=g||{},t.edit&&(l=Z("<td class='ui-pg-button "+q.cornerall+"'></td>"),Z(l).append("<div class='ui-pg-div'><span class='"+q.icon_base+" "+t.editicon+"'></span>"+t.edittext+"</div>"),Z("tr",u).append(l),Z(l,u).attr({title:t.edittitle||"",id:g.id||"edit_"+p}).click(function(){var e;return Z(this).hasClass(q.disabled)||((e=i.p.selrow)?(Z.jgrid.setSelNavIndex(i,this),Z.jgrid.isFunction(t.editfunc)?t.editfunc.call(i,e):Z(i).jqGrid("editGridRow",e,g)):(r(),Z("#jqg_alrt").focus())),!1}).hover(n,s),l=null),w=w||{},t.view&&(l=Z("<td class='ui-pg-button "+q.cornerall+"'></td>"),Z(l).append("<div class='ui-pg-div'><span class='"+q.icon_base+" "+t.viewicon+"'></span>"+t.viewtext+"</div>"),Z("tr",u).append(l),Z(l,u).attr({title:t.viewtitle||"",id:w.id||"view_"+p}).click(function(){var e;return Z(this).hasClass(q.disabled)||((e=i.p.selrow)?(Z.jgrid.setSelNavIndex(i,this),Z.jgrid.isFunction(t.viewfunc)?t.viewfunc.call(i,e):Z(i).jqGrid("viewGridRow",e,w)):(r(),Z("#jqg_alrt").focus())),!1}).hover(n,s),l=null),v=v||{},t.del&&(l=Z("<td class='ui-pg-button "+q.cornerall+"'></td>"),Z(l).append("<div class='ui-pg-div'><span class='"+q.icon_base+" "+t.delicon+"'></span>"+t.deltext+"</div>"),Z("tr",u).append(l),Z(l,u).attr({title:t.deltitle||"",id:v.id||"del_"+p}).click(function(){var e;return Z(this).hasClass(q.disabled)||(i.p.multiselect?0===(e=i.p.selarrrow).length&&(e=null):e=i.p.selrow,e?(Z.jgrid.setSelNavIndex(i,this),Z.jgrid.isFunction(t.delfunc)?t.delfunc.call(i,e):Z(i).jqGrid("delGridRow",e,v)):r()),!1}).hover(n,s),l=null),(t.add||t.edit||t.del||t.view)&&Z("tr",u).append(h),b=b||{},t.search&&(l=Z("<td class='ui-pg-button "+q.cornerall+"'></td>"),Z(l).append("<div class='ui-pg-div'><span class='"+q.icon_base+" "+t.searchicon+"'></span>"+t.searchtext+"</div>"),Z("tr",u).append(l),Z(l,u).attr({title:t.searchtitle||"",id:b.id||"search_"+p}).click(function(){return Z(this).hasClass(q.disabled)||(Z.jgrid.setSelNavIndex(i,this),Z.jgrid.isFunction(t.searchfunc)?t.searchfunc.call(i,b):Z(i).jqGrid("searchGrid",b)),!1}).hover(n,s),b.showOnLoad&&!0===b.showOnLoad&&Z(l,u).click(),l=null),t.refresh&&(l=Z("<td class='ui-pg-button "+q.cornerall+"'></td>"),Z(l).append("<div class='ui-pg-div'><span class='"+q.icon_base+" "+t.refreshicon+"'></span>"+t.refreshtext+"</div>"),Z("tr",u).append(l),Z(l,u).attr({title:t.refreshtitle||"",id:"refresh_"+p}).click(function(){if(!Z(this).hasClass(q.disabled)){Z.jgrid.isFunction(t.beforeRefresh)&&t.beforeRefresh.call(i),i.p.search=!1,i.p.resetsearch=!0;try{if("currentfilter"!==t.refreshstate){var e=i.p.id;i.p.postData.filters="";try{Z("#fbox_"+Z.jgrid.jqID(e)).jqFilter("resetFilter")}catch(e){}Z.jgrid.isFunction(i.clearToolbar)&&i.clearToolbar.call(i,!1)}}catch(e){}switch(t.refreshstate){case"firstpage":Z(i).trigger("reloadGrid",[{page:1}]);break;case"current":case"currentfilter":Z(i).trigger("reloadGrid",[{current:!0}])}Z.jgrid.isFunction(t.afterRefresh)&&t.afterRefresh.call(i),Z.jgrid.setSelNavIndex(i,this)}return!1}).hover(n,s),l=null),h=Z(".ui-jqgrid").css("font-size")||"11px",Z("body").append("<div id='testpg2' class='ui-jqgrid "+Z.jgrid.styleUI[y].base.entrieBox+"' style='font-size:"+h+";visibility:hidden;' ></div>"),h=Z(u).clone().appendTo("#testpg2").width(),Z("#testpg2").remove(),i.p._nvtd&&(t.dropmenu?(u=null,Z(i).jqGrid("_buildNavMenu",c,p,Z.extend(f,{ainfo:r}),g,j,v,b,w)):h>i.p._nvtd[0]?(i.p.responsive?(u=null,Z(i).jqGrid("_buildNavMenu",c,p,Z.extend(f,{ainfo:r}),g,j,v,b,w)):Z(c+"_"+t.position,c).append(u).width(h),i.p._nvtd[0]=h):Z(c+"_"+t.position,c).append(u),i.p._nvtd[1]=h),i.p.navGrid=!0}i.p.storeNavOptions&&(i.p.navOptions=t,i.p.editOptions=g,i.p.addOptions=j,i.p.delOptions=v,i.p.searchOptions=b,i.p.viewOptions=w,i.p.navButtons=[])}}})},navButtonAdd:function(s,l){var c=this[0].p.styleUI,e=Z.jgrid.styleUI[c].navigator;return l=Z.extend({caption:"newButton",title:"",buttonicon:e.icon_newbutton_nav,onClickButton:null,position:"last",cursor:"pointer",internal:!1},l||{}),this.each(function(){var t,i,e,a,d,r,o,n;this.grid&&"string"==typeof s&&(0===s.indexOf("#")&&(s=s.substring(1)),s="#"+Z.jgrid.jqID(s),n=Z(".navtable",s)[0],i=Z.jgrid.styleUI[c].common.disabled,e=Z.jgrid.styleUI[c].common.hover,a=Z.jgrid.styleUI[c].common.cornerall,r=Z.jgrid.styleUI[c].common.icon_base,(t=this).p.storeNavOptions&&!l.internal&&t.p.navButtons.push([s,l]),n?l.id&&void 0!==Z("#"+Z.jgrid.jqID(l.id),n)[0]||(o=Z("<td></td>"),"NONE"===l.buttonicon.toString().toUpperCase()?Z(o).addClass("ui-pg-button "+a).append("<div class='ui-pg-div'>"+l.caption+"</div>"):Z(o).addClass("ui-pg-button "+a).append("<div class='ui-pg-div'><span class='"+r+" "+l.buttonicon+"'></span>"+l.caption+"</div>"),l.id&&Z(o).attr("id",l.id),"first"!==l.position||0===n.rows[0].cells.length?Z("tr",n).append(o):Z("tr td",n).eq(0).before(o),Z(o,n).attr("title",l.title||"").click(function(e){return Z(this).hasClass(i)||(Z.jgrid.setSelNavIndex(t,this),Z.jgrid.isFunction(l.onClickButton)&&l.onClickButton.call(t,e)),!1}).hover(function(){Z(this).hasClass(i)||Z(this).addClass(e)},function(){Z(this).removeClass(e)})):(n=Z(".dropdownmenu",s)[0])&&(d=Z(n).val(),r=l.id||Z.jgrid.randId(),o=Z('<li class="ui-menu-item" role="presentation"><a class="'+a+' g-menu-item" tabindex="0" role="menuitem" id="'+r+'">'+(l.caption||l.title)+"</a></li>"),d)&&("first"===l.position?Z("#"+d).prepend(o):Z("#"+d).append(o),Z(o).on("click",function(e){return Z(this).hasClass(i)||(Z("#"+d).hide(),Z.jgrid.isFunction(l.onClickButton)&&l.onClickButton.call(t,e)),!1}).find("a").hover(function(){Z(this).hasClass(i)||Z(this).addClass(e)},function(){Z(this).removeClass(e)})))})},navSeparatorAdd:function(i,a){var e=this[0].p.styleUI,d=Z.jgrid.styleUI[e].common;return a=Z.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},a||{}),this.each(function(){var e,t;this.grid&&("string"==typeof i&&0!==i.indexOf("#")&&(i="#"+Z.jgrid.jqID(i)),t=Z(".navtable",i)[0],this.p.storeNavOptions&&this.p.navButtons.push([i,a]),t?(e="<td class='ui-pg-button "+d.disabled+"' style='width:4px;'><span class='"+a.sepclass+"'></span>"+a.sepcontent+"</td>","first"!==a.position||0===t.rows[0].cells.length?Z("tr",t).append(e):Z("tr td",t).eq(0).before(e)):(t=Z(".dropdownmenu",i)[0],e="<li class='ui-menu-item "+d.disabled+"' style='width:100%' role='presentation'><hr class='ui-separator-li'></li>",t&&(t=Z(t).val())&&("first"===a.position?Z("#"+t).prepend(e):Z("#"+t).append(e))))})},_buildNavMenu:function(l,c,p,u,h,m,f,g){return this.each(function(){var e,t,i,a=this,d=Z.jgrid.getRegional(a,"nav"),r=a.p.styleUI,o=Z.jgrid.styleUI[r].filter,n=Z.jgrid.styleUI[r].common,s="form_menu_"+Z.jgrid.randId(),r=p.navButtonText||d.selectcaption||"Actions",d="<button class='dropdownmenu "+n.button+"' value='"+s+"'>"+r+"</button>";Z(l+"_"+p.position,l).append(d);r=Z(".ui-jqgrid").css("font-size")||"11px",i=Z('<ul id="'+s+'" class="ui-nav-menu modal-content ui-menu column-menu jqgrid-column-menu '+n.shadow+'" role="menu" tabindex="0" style="display:none;font-size:'+r+'"></ul>'),p.add&&(e=(h=h||{}).id||"add_"+c,t=Z('<li class="ui-menu-item" role="presentation"><a class="'+n.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+e+'">'+(p.addtext.trim()||p.addtitle)+"</a></li>").click(function(){return Z(this).hasClass(n.disabled)||(Z.jgrid.isFunction(p.addfunc)?p.addfunc.call(a):Z(a).jqGrid("editGridRow","new",h),Z(i).hide()),!1}),Z(i).append(t)),p.edit&&(e=(u=u||{}).id||"edit_"+c,t=Z('<li class="ui-menu-item" role="presentation"><a class="'+n.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+e+'">'+(p.edittext.trim()||p.edittitle)+"</a></li>").click(function(){var e;return Z(this).hasClass(n.disabled)||((e=a.p.selrow)?Z.jgrid.isFunction(p.editfunc)?p.editfunc.call(a,e):Z(a).jqGrid("editGridRow",e,u):(p.ainfo(),Z("#jqg_alrt").focus()),Z(i).hide()),!1}),Z(i).append(t)),p.view&&(e=(g=g||{}).id||"view_"+c,t=Z('<li class="ui-menu-item" role="presentation"><a class="'+n.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+e+'">'+(p.viewtext.trim()||p.viewtitle)+"</a></li>").click(function(){var e;return Z(this).hasClass(n.disabled)||((e=a.p.selrow)?Z.jgrid.isFunction(p.editfunc)?p.viewfunc.call(a,e):Z(a).jqGrid("viewGridRow",e,g):(p.ainfo(),Z("#jqg_alrt").focus()),Z(i).hide()),!1}),Z(i).append(t)),p.del&&(e=(m=m||{}).id||"del_"+c,t=Z('<li class="ui-menu-item" role="presentation"><a class="'+n.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+e+'">'+(p.deltext.trim()||p.deltitle)+"</a></li>").click(function(){var e;return Z(this).hasClass(n.disabled)||(a.p.multiselect?0===(e=a.p.selarrrow).length&&(e=null):e=a.p.selrow,e?Z.jgrid.isFunction(p.delfunc)?p.delfunc.call(a,e):Z(a).jqGrid("delGridRow",e,m):p.ainfo(),Z(i).hide()),!1}),Z(i).append(t)),(p.add||p.edit||p.del||p.view)&&Z(i).append("<li class='ui-menu-item "+n.disabled+"' style='width:100%' role='presentation'><hr class='ui-separator-li'></li>"),p.search&&(e=(f=f||{}).id||"search_"+c,t=Z('<li class="ui-menu-item" role="presentation"><a class="'+n.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+e+'">'+(p.searchtext.trim()||p.searchtitle)+"</a></li>").click(function(){return Z(this).hasClass(n.disabled)||(Z.jgrid.isFunction(p.searchfunc)?p.searchfunc.call(a,f):Z(a).jqGrid("searchGrid",f),Z(i).hide()),!1}),Z(i).append(t),f.showOnLoad)&&!0===f.showOnLoad&&Z(t).click(),p.refresh&&(e=f.id||"search_"+c,t=Z('<li class="ui-menu-item" role="presentation"><a class="'+n.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+e+'">'+(p.refreshtext||p.refreshtitle)+"</a></li>").click(function(){if(!Z(this).hasClass(n.disabled)){Z.jgrid.isFunction(p.beforeRefresh)&&p.beforeRefresh.call(a),a.p.search=!1,a.p.resetsearch=!0;try{if("currentfilter"!==p.refreshstate){var e=a.p.id;a.p.postData.filters="";try{Z("#fbox_"+Z.jgrid.jqID(e)).jqFilter("resetFilter")}catch(e){}Z.jgrid.isFunction(a.clearToolbar)&&a.clearToolbar.call(a,!1)}}catch(e){}switch(p.refreshstate){case"firstpage":Z(a).trigger("reloadGrid",[{page:1}]);break;case"current":case"currentfilter":Z(a).trigger("reloadGrid",[{current:!0}])}Z.jgrid.isFunction(p.afterRefresh)&&p.afterRefresh.call(a),Z(i).hide()}return!1}),Z(i).append(t)),Z(i).hide(),Z("body").append(i),Z("#"+s).addClass("ui-menu "+o.menu_widget),Z("#"+s+" > li > a").hover(function(){Z(this).addClass(n.hover)},function(){Z(this).removeClass(n.hover)}),Z(".dropdownmenu",l+"_"+p.position).on("click",function(e){var t=Z(this).offset(),i=t.left,t=parseInt(t.top),a=Z(this).val();Z("#"+a).show().css({top:t-(Z("#"+a).height()+35)+"px",left:i+"px"}),e.stopPropagation()}),Z("body").on("click",function(e){Z(e.target).hasClass("dropdownmenu")||Z("#"+s).hide()})})},GridToForm:function(a,d){return this.each(function(){var e,t=this;if(t.grid){var i=Z(t).jqGrid("getRowData",a);if(i)for(e in i)i.hasOwnProperty(e)&&(Z("[name="+Z.jgrid.jqID(e)+"]",d).is("input:radio")||Z("[name="+Z.jgrid.jqID(e)+"]",d).is("input:checkbox")?Z("[name="+Z.jgrid.jqID(e)+"]",d).each(function(){Z(this).val()==i[e]?Z(this)[t.p.useProp?"prop":"attr"]("checked",!0):Z(this)[t.p.useProp?"prop":"attr"]("checked",!1)}):Z("[name="+Z.jgrid.jqID(e)+"]",d).val(i[e]))}})},FormToGrid:function(t,a,d,r){return this.each(function(){var e,i;this.grid&&(d=d||"set",r=r||"first",e=Z(a).serializeArray(),i={},Z.each(e,function(e,t){i[t.name]=t.value}),"add"===d?Z(this).jqGrid("addRowData",t,i,r):"set"===d&&Z(this).jqGrid("setRowData",t,i))})}})});