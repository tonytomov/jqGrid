(e=>{"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.utils"],e):e(jQuery)})(function(te){te.jgrid=te.jgrid||{},te.extend(te.jgrid,{formatCell:function(e,t,r,l,o,a,n,d){var i=e;return void 0===n&&(n=!0),void 0===d&&(d=!0),void 0!==l.formatter&&(t={rowId:"",colModel:l,gid:o.p.id,pos:t,styleUI:"",isExported:!0,exporttype:a},te.jgrid.isFunction(l.formatter)?d&&(i=l.formatter.call(o,e,t,r)):te.fmatter&&n&&(i=te.fn.fmatter.call(o,l.formatter,e,t,r))),null==i?"":i},formatCellCsv:function(t,e){t=null==t?"":String(t);try{t=te.jgrid.stripHtml(t.replace(e._regexsep,e.separatorReplace).replace(/\r\n/g,e.replaceNewLine).replace(/\n/g,e.replaceNewLine))}catch(e){t=""}return t=-1!==(t=e.escquote?t.replace(e._regexquot,e.escquote+e.quote):t).indexOf(e.separator)&&-1!==t.indexOf(e.qoute)?t:e.quote+t+e.quote},excelCellPos:function(e){for(var t="A".charCodeAt(0),r="Z".charCodeAt(0)-t+1,l="";0<=e;)l=String.fromCharCode(e%r+t)+l,e=Math.floor(e/r)-1;return l},makeNode:function(e,t,r){var l=e.createElement(t);return r&&(r.attr&&te(l).attr(r.attr),r.children&&te.each(r.children,function(e,t){l.appendChild(t)}),r.hasOwnProperty("text"))&&l.appendChild(e.createTextNode(r.text)),l},xmlToString:function(e){return"undefined"!=typeof XMLSerializer?(new window.XMLSerializer).serializeToString(e):e.xml},xmlToZip:function(o,e){var a,n,d,i,p,s=this,m=new XMLSerializer,f=-1===m.serializeToString(te.parseXML(te.jgrid.excelStrings["xl/worksheets/sheet1.xml"])).indexOf("xmlns:r"),c=[];te.each(e,function(e,t){if(te.isPlainObject(t))p=o.folder(e),s.xmlToZip(p,t);else{if(f){for(a=t.childNodes[0],n=a.attributes.length-1;0<=n;n--){var r=a.attributes[n].nodeName,l=a.attributes[n].nodeValue;-1!==r.indexOf(":")&&(c.push({name:r,value:l}),a.removeAttribute(r))}for(n=0,d=c.length;n<d;n++)(i=t.createAttribute(c[n].name.replace(":","_dt_b_namespace_token_"))).value=c[n].value,a.setAttributeNode(i)}p=m.serializeToString(t),p=(p=f?(p=-1===p.indexOf("<?xml")?'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+p:p).replace(/_dt_b_namespace_token_/g,":"):p).replace(/<row xmlns="" /g,"<row ").replace(/<cols xmlns="">/g,"<cols>").replace(/<mergeCells xmlns="" /g,"<mergeCells ").replace(/<numFmt xmlns="" /g,"<numFmt ").replace(/<xf xmlns="" /g,"<xf "),o.file(e,p)}})},excelStrings:{"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/></Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Default Extension="jpeg" ContentType="image/jpeg" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /></Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/><workbookPr showInkAnnotation="0" autoCompressPictures="0"/><bookViews><workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/></bookViews><sheets><sheet name="Sheet1" sheetId="1" r:id="rId1"/></sheets></workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><sheetData/></worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><numFmts count="7"><numFmt numFmtId="164" formatCode="#,##0.00_- [$$-45C]"/><numFmt numFmtId="165" formatCode="&quot;£&quot;#,##0.00"/><numFmt numFmtId="166" formatCode="[$€-2] #,##0.00"/><numFmt numFmtId="167" formatCode="0.0%"/><numFmt numFmtId="168" formatCode="#,##0;(#,##0)"/><numFmt numFmtId="169" formatCode="#,##0.00;(#,##0.00)"/><numFmt numFmtId="170" formatCode="yyyy/mm/dd;@"/></numFmts><fonts count="5" x14ac:knownFonts="1"><font><sz val="11" /><name val="Calibri" /></font><font><sz val="11" /><name val="Calibri" /><color rgb="FFFFFFFF" /></font><font><sz val="11" /><name val="Calibri" /><b /></font><font><sz val="11" /><name val="Calibri" /><i /></font><font><sz val="11" /><name val="Calibri" /><u /></font></fonts><fills count="6"><fill><patternFill patternType="none" /></fill><fill/><fill><patternFill patternType="solid"><fgColor rgb="FFD9D9D9" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD99795" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6efce" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6cfef" /><bgColor indexed="64" /></patternFill></fill></fills><borders count="2"><border><left /><right /><top /><bottom /><diagonal /></border><border diagonalUp="false" diagonalDown="false"><left style="thin"><color auto="1" /></left><right style="thin"><color auto="1" /></right><top style="thin"><color auto="1" /></top><bottom style="thin"><color auto="1" /></bottom><diagonal /></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" /></cellStyleXfs><cellXfs count="69"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="left"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="center"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="right"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="fill"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment textRotation="90"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment wrapText="1"/></xf><xf numFmtId="9"   fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="164" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="165" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="166" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="167" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="168" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="169" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="3" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="4" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="1" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="2" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="170" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="49" fontId="0" fillId="0" borderId="0" xfId="0" applyNumberFormat="1"/></cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0" /></cellStyles><dxfs count="0" /><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4" /></styleSheet>'},excelParsers:[{match:/^\-?\d+\.\d%$/,style:60,fmt:function(e){return e/100}},{match:/^\-?\d+\.?\d*%$/,style:56,fmt:function(e){return e/100}},{match:/^\-?\$[\d,]+.?\d*$/,style:57},{match:/^\-?£[\d,]+.?\d*$/,style:58},{match:/^\-?€[\d,]+.?\d*$/,style:59},{match:/^\-?\d+$/,style:65},{match:/^\-?\d+\.\d{2}$/,style:66},{match:/^\([\d,]+\)$/,style:61,fmt:function(e){return-1*e.replace(/[\(\)]/g,"")}},{match:/^\([\d,]+\.\d{2}\)$/,style:62,fmt:function(e){return-1*e.replace(/[\(\)]/g,"")}},{match:/^\-?[\d,]+$/,style:63},{match:/^\-?[\d,]+\.\d{2}$/,style:64},{match:/^\d{4}\-\d{2}\-\d{2}$/,style:67},{match:/(https?:\/\/(?:www\.|(?!www))[^\s\.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/gi,style:4}],addExcelStyle:function(e,t,r,l){t=te.extend({numFmtId:"0",fontId:"0",fillId:"0",borderId:"0",applyFont:"1",applyFill:"1",applyBorder:"1",xfId:"0",applyNumberFormat:"0",applyAlignment:"0"},t||{}),r=te.extend({horizontal:"left",indent:"0",shrinkToFit:"1",textRotation:"0",vertical:"center",wrapText:"0"},r||{}),te.isEmptyObject(e)&&(e.excel_parsers=!0);var o,a,n,d,i,p=!0,s=(null==l&&(o=te.jgrid.excelStrings,l=te.parseXML(o["xl/styles.xml"]),p=!1),l.getElementsByTagName("numFmts")[0]),m=l.getElementsByTagName("cellXfs")[0],f=null,c=null;for(a in e)e.hasOwnProperty(a)&&(-1!==a.indexOf("format")&&(f=a),-1!==a.indexOf("style"))&&(c=a);return c&&!e[c]&&(n=i=0,f&&e[f]&&(d=te(s.getElementsByTagName("numFmt")),te.each(d,function(e,t){i++,n=Math.max(n,parseInt(te(t).attr("numFmtId"),10))}),d=te.jgrid.makeNode(l,"numFmt",{attr:{numFmtId:n+1,formatCode:e[f]}}),s.appendChild(d),te(s).attr("count",i+1)),s=0!==n?n+1+"":"0",i=0,t.numFmtId=s,d="1"===t.applyAlignment?te.jgrid.makeNode(l,"xf",{attr:t,children:[te.jgrid.makeNode(l,"alignment",{attr:r})]}):te.jgrid.makeNode(l,"xf",{attr:t}),m.appendChild(d),i=te("cellXfs xf",l).length,te(m).attr("count",i),e[c]=i-1,p||(o["xl/styles.xml"]=te.jgrid.xmlToString(l))),e},newExcelStyle:function(e,t){t=te.extend(!0,{font:{size:11,name:"Calibri",options:""},color:{patternType:"solid",fgColor:"FFFFFFF",bgColor:64},border:0},t||{});var e=e.xl["styles.xml"],r=te("cellXfs xf",e).length-1,l=te("fonts font",e).length-1,o=te("fills fill",e).length-1,a=te("borders border",e).length-1,n='<font><sz val="'+t.font.size+'" /><name val="'+t.font.name+'" />'+t.font.options+"</font>",n=(e.childNodes[0].childNodes[1].innerHTML+=n,"rgb ="),n=(0<=parseInt(t.color.bgColor,10)&&(n="indexed ="),n+='"'+t.color.bgColor+'"','<fill><patternFill patternType="'+t.color.patternType+'"><fgColor rgb="'+t.color.fgColor+'" /><bgColor '+n+" /></patternFill></fill>"),d=(e.childNodes[0].childNodes[2].innerHTML+=n,te.isPlainObject(t.border)?(t.border=te.extend({leftStyle:"none",rightStyle:"none",topStyle:"none",bottomStyle:"none",color:"auto"},t.border||{}),"auto"===t.border.color?d='auto="1"':te.fmatter.isNumber(t.border.color)?d='indexed="'+t.border.color+'"':te.fmatter.isString(t.border.color)&&(d='rgb="'+t.border.color+'"'),n='<border diagonalUp="false" diagonalDown="false"><left style="'+t.border.leftStyle+'"><color '+d+' /></left><right style="'+t.border.rightStyle+'"><color '+d+' /></right><top style="'+t.border.topStyle+'"><color '+d+' /></top><bottom style="'+t.border.bottomStyle+'"><color '+d+" /></bottom><diagonal /></border>",e.childNodes[0].childNodes[3].innerHTML+=n):a=parseInt(t.border,10)-1,'<xf numFmtId="0" fontId="'+(1+l)+'" fillId="'+(1+o)+'" borderId="'+(a+1)+'" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"></xf>');return e.childNodes[0].childNodes[5].innerHTML+=d,1+r}}),te.jgrid.extend({exportToCsv:function(k){k=te.extend(!0,{separator:",",separatorReplace:" ",quote:'"',escquote:'"',newLine:"\r\n",replaceNewLine:" ",includeCaption:!0,includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,includeHeader:!0,fileName:"jqGridExport.csv",mimetype:"text/csv;charset=utf-8",returnAsString:!1,onBeforeExport:null,treeindent:" ",visibleTreeNodes:!1,loadIndicator:!0,applyDefFmt:!0,applyCustFmt:!0},k||{});var N="";return this.each(function(){k._regexsep=new RegExp(k.separator,"g"),k._regexquot=new RegExp(k.quote,"g");var e,t,j=this,r=j.p.treeGrid?te(j).jqGrid("getRowData",null,!0,k.treeindent,k.visibleTreeNodes):j.addLocalData(!0),l=r.length,o=j.p.colModel,a=o.length,n=j.p.colNames,d=0,i="",p="",s="",m="",f="",c=[],u="";function g(s,m){var f="",c=j.p.groupingView,u=[],g=c.groupField.length,y=j.p.colModel,h=y.length,x=0;function I(e,t,r,l){for(var o,a,n=((e,t,r)=>{var l,o=!1;if(0===t)o=r[e];else{var a=r[e].idx;if(0===a)o=r[e];else for(l=e;0<=l;l--)if(r[l].idx===a-t){o=r[l];break}}return o})(e,t,r),d=n.cnt,i=new Array(m.collen),p=0,s=l;s<h;s++)y[s]._expcol&&(a="{0}",te.each(n.summary,function(){if(this.nm===y[s].name){y[s].summaryTpl&&(a=y[s].summaryTpl),o=this.v,"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?o=this.v/this.vd:this.v&&0<d&&(o=this.v/d));try{this.groupCount=n.cnt,this.groupIndex=n.dataIndex,this.groupValue=n.value,o=j.formatter("",o,s,this)}catch(e){o=this.v}return i[p]=te.jgrid.formatCellCsv(te.jgrid.stripHtml(te.jgrid.template(a,o)),m),!1}}),p++);return i}te.each(y,function(e,t){for(var r=0;r<g;r++)if(c.groupField[r]===t.name){u[r]=e;break}});var F,b,v=te.makeArray(c.groupSummary);if(v.reverse(),"local"===j.p.datatype&&!j.p.loadonce){te(j).jqGrid("groupingSetup");for(var e=te.jgrid.getMethod("groupingPrepare"),t=0;t<l;t++)e.call(te(j),r[t],t)}return te.each(c.groups,function(e,t){x++;try{F=Array.isArray(c.formatDisplayField)&&te.jgrid.isFunction(c.formatDisplayField[t.idx])?c.formatDisplayField[t.idx].call(j,t.displayValue,t.value,j.p.colModel[u[t.idx]],t.idx,c):j.formatter("",t.displayValue,u[t.idx],t.value)}catch(e){F=t.displayValue}var r,l="";if("string"!=typeof(l=te.jgrid.isFunction(c.groupText[t.idx])?c.groupText[t.idx].call(j,F,t.cnt,t.summary):te.jgrid.template(c.groupText[t.idx],F,t.cnt,t.summary))&&"number"!=typeof l&&(l=F),(r="header"===c.groupSummaryPos[t.idx]?I(e,0,c.groups,0):new Array(m.collen))[0]=te.jgrid.formatCellCsv(te.jgrid.stripHtml(l),m),f+=r.join(m.separator)+m.newLine,g-1===t.idx){for(var o,a,n,d=c.groups[e+1],l=t.startRow,i=void 0!==d?d.startRow:c.groups[e].startRow+c.groups[e].cnt,p=l;p<i&&s[+p];p++){for(a=s[+p],o=b=0;o<y.length;o++)y[o]._expcol&&(r[b]=te.jgrid.formatCellCsv(te.jgrid.formatCell(te.jgrid.getAccessor(a,y[o].name),o,a,y[o],j,"csv",m.applyDefFmt,m.applyCustFmt),m),b++);f+=r.join(m.separator)+m.newLine}if("header"!==c.groupSummaryPos[t.idx]){if(void 0!==d){for(n=0;n<c.groupField.length&&d.dataIndex!==c.groupField[n];n++);x=c.groupField.length-n}for(o=0;o<x;o++)v[o]&&(r=I(e,o,c.groups,0),f+=r.join(m.separator)+m.newLine);x=n}}}),f}te.jgrid.isFunction(k.loadIndicator)?k.loadIndicator.call(j,"show"):k.loadIndicator&&te(j).jqGrid("progressBar",{method:"show",loadtype:j.p.loadui,htmlcontent:te.jgrid.getRegional(j,"defaults.loadtext")});var y,h,x=[];if(te.each(o,function(e,t){t._expcol=!0,void 0===t.exportcol?t.hidden&&(t._expcol=!1):t._expcol=t.exportcol,"cb"!==t.name&&"rn"!==t.name&&"subgrid"!==t.name&&"sc"!==t.name||(t._expcol=!1),t._expcol&&(c.push(te.jgrid.formatCellCsv(n[e],k)),x.push(t.name))}),k.includeLabels&&(f=c.join(k.separator)+k.newLine),k.collen=c.length,j.p.grouping){var I=!!j.p.groupingView._locgr;j.p.groupingView._locgr=!1,i+=g(r,k),j.p.groupingView._locgr=I}else for(;d<l;){for(e=r[d],w=[],b=t=0;b<a;b++)o[b]._expcol&&(w[t]=te.jgrid.formatCellCsv(te.jgrid.formatCell(te.jgrid.getAccessor(e,o[b].name),b,e,o[b],j,"csv",k.applyDefFmt,k.applyCustFmt),k),t++);i+=w.join(k.separator)+k.newLine,d++}if(r=null,w=new Array(k.collen),k.includeCaption&&j.p.caption){for(d=k.collen;--d;)w[d]="";w[0]=te.jgrid.formatCellCsv(j.p.caption,k),p+=w.join(k.separator)+k.newLine}if(k.includeGroupHeader&&te(j).jqGrid("isGroupHeaderOn"))for(var F=j.p.groupHeader,b=0;b<F.length;b++){for(var v=F[b].groupHeaders,d=0,w=[],C=0;C<x.length;C++){for(w[d]="",t=0;t<v.length;t++)v[t].startColumnName===x[C]&&(w[d]=te.jgrid.formatCellCsv(v[t].titleText,k));d++}s+=w.join(k.separator)+k.newLine}if(k.includeFooter&&j.p.footerrow)for(var _,B,T=te(j).jqGrid("footerData","getlength"),S=0;S<T;S++){for(_=te(j).jqGrid("footerData","get",null,!1,S,!1),b=0,w=[];b<k.collen;)_.hasOwnProperty(B=x[b])&&w.push(te.jgrid.formatCellCsv(te.jgrid.stripHtml(_[B]),k)),b++;m+=w.join(k.separator)+k.newLine}if(k.includeHeader&&j.p.headerrow)for(T=te(j).jqGrid("headerData","getlength"),S=0;S<T;S++){for(y=te(j).jqGrid("headerData","get",null,!1,S,!1),b=0,w=[];b<k.collen;)y.hasOwnProperty(h=x[b])&&w.push(te.jgrid.formatCellCsv(te.jgrid.stripHtml(y[h]),k)),b++;u+=w.join(k.separator)+k.newLine}if(N=p+s+f+u+i+m,te.jgrid.isFunction(k.loadIndicator)?k.loadIndicator.call(j,"hide"):k.loadIndicator&&te(j).jqGrid("progressBar",{method:"hide",loadtype:j.p.loadui}),te.jgrid.isFunction(k.onBeforeExport)&&!(N=k.onBeforeExport.call(j,N)))throw"Before export does not return data!";k.returnAsString||(-1!==k.mimetype.toUpperCase().indexOf("UTF-8")&&(N="\ufeff"+N),te.jgrid.saveAs(N,k.fileName,{type:k.mimetype}))}),N},exportToExcel:function(ee){ee=te.extend(!0,{includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,includeHeader:!0,fileName:"jqGridExport.xlsx",mimetype:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",maxlength:40,onBeforeExport:null,customizeData:null,replaceStr:null,treeindent:" ",visibleTreeNodes:!1,loadIndicator:!0,applyDefFmt:!0,applyCustFmt:!0},ee||{}),this.each(function(){for(var e,t,I=this,r=te.jgrid.excelStrings,y=0,h=te.parseXML(r["xl/worksheets/sheet1.xml"]),G=h.getElementsByTagName("sheetData")[0],l=te.parseXML(r["xl/styles.xml"]),r={_rels:{".rels":te.parseXML(r["_rels/.rels"])},xl:{_rels:{"workbook.xml.rels":te.parseXML(r["xl/_rels/workbook.xml.rels"])},"workbook.xml":te.parseXML(r["xl/workbook.xml"]),"styles.xml":l,worksheets:{"sheet1.xml":h}},"[Content_Types].xml":te.parseXML(r["[Content_Types].xml"])},F=I.p.colModel,o=0,b={body:I.p.treeGrid?te(I).jqGrid("getRowData",null,!0,ee.treeindent,ee.visibleTreeNodes):I.addLocalData(!0),header:[],footer:[],width:[],map:[],parser:[],labels:[],hidden:[],mergecell:[]},L=te.jgrid.addExcelStyle({excel_header_style:""},{fontId:"2",applyAlignment:"1"},{horizontal:"center",vertical:"center"},l).excel_header_style,a=0,n=F.length;a<n;a++)F[a]._expcol=!0,void 0===F[a].exportcol?F[a].hidden&&(F[a]._expcol=!1):F[a]._expcol=F[a].exportcol,void 0===F[a]._colspancell&&(F[a]._colspancell=!1),te.jgrid.isServiceCol(F[a].name)||!F[a]._expcol?b.hidden.push(F[a].name):(b.header[o]=F[a].name,b.width[o]=5,b.map[o]=a,b.labels[o]=I.p.colNames[a],F[a].hasOwnProperty("exportoptions")?(e={},t={},F[a].exportoptions.excel_format&&(e=te.jgrid.addExcelStyle({excel_format:F[a].exportoptions.excel_format,excel_style:F[a].exportoptions.excel_style||""},{},{},l)),F[a].exportoptions.excel_header_format&&(t=te.jgrid.addExcelStyle({excel_header_format:F[a].exportoptions.excel_header_format,excel_header_style:F[a].exportoptions.excel_header_style||""},{fontId:"2",applyAlignment:"1"},{horizontal:"center"},l)),b.parser[a]=te.extend(e,t),F[a].exportoptions.replace_format&&(b.parser[a].replace_format=F[a].exportoptions.replace_format),F[a].exportoptions.replace_header_format&&(b.parser[a].replace_header_format=F[a].exportoptions.replace_header_format)):b.parser[a]={excel_parsers:!0},o++);if(ee.includeFooter||I.p.footerrow)for(var d,P=te(I).jqGrid("footerData","getlength"),O=0;O<P;O++){for(o in d=te(I).jqGrid("footerData","get",null,!1,O,!1))d.hasOwnProperty(o)&&(d[o]=te.jgrid.stripHtml(d[o]));b.footer.push(d)}function x(e,t){return te.jgrid.makeNode(h,"c",{attr:e,children:[te.jgrid.makeNode(h,"v",{text:t})]})}function v(e,t,r){return te.jgrid.makeNode(h,"c",{attr:{t:"inlineStr",r:e,s:r=void 0===r?68:r},children:{row:te.jgrid.makeNode(h,"is",{children:{row:te.jgrid.makeNode(h,"t",{text:t})}})}})}te.jgrid.isFunction(ee.customizeData)&&ee.customizeData.call(I,b);var E,j,M=te.jgrid.isFunction(ee.replaceStr)?ee.replaceStr:function(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,"")},w=function(e,t,r,l){void 0===r&&(r=!1),void 0===l&&(l=!1),E=y+1,j=te.jgrid.makeNode(h,"row",{attr:{r:E}});for(var o,a,n=0;n<b.header.length;n++){var d,i,p=te.jgrid.excelCellPos(n)+""+E,s=(null==(g=Array.isArray(e)&&t?b.labels[n]:te.jgrid.getAccessor(e,b.header[n]))&&(g=""),t||(g=0===n&&l||l&&""===g?g:te.jgrid.formatCell(g,b.map[n],e,F[b.map[n]],I,"excel",ee.applyDefFmt,ee.applyCustFmt))&&("&nbsp;"===g||"&#160;"===g||1===g.length&&160===g.charCodeAt(0))&&(g=""),b.width[n]=Math.max(b.width[n],Math.min(parseInt(g.toString().length,10),ee.maxlength)),d=null,b.parser[b.map[n]]);if(t&&r)s.replace_header_format&&(g=s.replace_header_format(g)),d=void 0!==s.excel_header_style?"text"===s.excel_header_style?v(p,g):s.excel_header_style<=55?v(p,g,s.excel_header_style):x({r:p,s:s.excel_header_style},g):v(p,g,L),j.appendChild(d);else if(!0!==s.excel_parsers||d)void 0===s.excel_style||t||d||(s.replace_format&&(g=s.replace_format(g)),d="text"===s.excel_style?v(p,g):s.excel_style<=55?v(p,g,s.excel_style):x({r:p,s:s.excel_style},g),j.appendChild(d));else for(var m=0,f=te.jgrid.excelParsers.length;m<f;m++){var c=te.jgrid.excelParsers[m];if(g.match&&!g.match(/^0\d+/)&&g.match(c.match)){var u=g,g=g.replace(/[^\d\.\-]/g,"");if(c.fmt&&(g=c.fmt(g)),67===c.style)d=x({t:"d",r:p,s:c.style},g);else if(4===c.style)o=u,a=void 0,(a=document.createElement("div")).innerHTML=o,d=(g="A"===(o=a.firstChild).nodeName?[o.href,o.text]:"#text"===o.nodeName&&[o.textContent,o.textContent])?(a={t:"str",r:p,s:c.style},o='HYPERLINK("'+g[0]+'","'+g[1]+'")',te.jgrid.makeNode(h,"c",{attr:a,children:[te.jgrid.makeNode(h,"f",{text:o})]})):v(p,u);else{if(te.inArray(c.style,["63","64","65","66"])&&15<g.toString().length){d=v(p,u.replace?M(u):u),j.appendChild(d);break}d=x({r:p,s:c.style},g)}j.appendChild(d);break}}d||(g.match&&(i=g.match(/^-?([1-9]\d+)(\.(\d+))?$/)),d="number"==typeof g&&g.toString().length<=15||i&&i[1].length+(i[2]?i[3].length:0)<=15?x({t:"n",r:p},g):v(p,g.replace?M(g):g),j.appendChild(d))}G.appendChild(j),y++};function V(p){var s=I.p.groupingView,m=[],f=s.groupField.length,c=F.length,u=0;function g(e,t,r,l){for(var o,a,n=((e,t,r)=>{var l,o=!1;if(0===t)o=r[e];else{var a=r[e].idx;if(0===a)o=r[e];else for(l=e;0<=l;l--)if(r[l].idx===a-t){o=r[l];break}}return o})(e,t,r),d=n.cnt,i=y(b.header),p=l;p<c;p++)F[p]._expcol&&(a="{0}",te.each(n.summary,function(){if(this.nm===F[p].name){F[p].summaryTpl&&(a=F[p].summaryTpl),o=this.v,"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?o=this.v/this.vd:this.v&&0<d&&(o=this.v/d));try{this.groupCount=n.cnt,this.groupIndex=n.dataIndex,this.groupValue=n.value}catch(e){o=this.v}return i[this.nm]=te.jgrid.stripHtml(te.jgrid.template(a,o)),!1}}));return i}function y(e){for(var t={},r=0;r<e.length;r++)t[e[r]]="";return t}te.each(F,function(e,t){for(var r=0;r<f;r++)if(s.groupField[r]===t.name){m[r]=e;break}});var h,x=te.makeArray(s.groupSummary);if(x.reverse(),"local"===I.p.datatype&&!I.p.loadonce){te(I).jqGrid("groupingSetup");for(var e=te.jgrid.getMethod("groupingPrepare"),t=0;t<b.body.length;t++)e.call(te(I),b.body[t],t)}te.each(s.groups,function(e,t){u++;try{h=Array.isArray(s.formatDisplayField)&&te.jgrid.isFunction(s.formatDisplayField[t.idx])?s.formatDisplayField[t.idx].call(I,t.displayValue,t.value,I.p.colModel[m[t.idx]],t.idx,s):I.formatter("",t.displayValue,m[t.idx],t.value)}catch(e){h=t.displayValue}var r="",l=("string"!=typeof(r=te.jgrid.isFunction(s.groupText[t.idx])?s.groupText[t.idx].call(I,h,t.cnt,t.summary):te.jgrid.template(s.groupText[t.idx],h,t.cnt,t.summary))&&"number"!=typeof r&&(r=h),"header"===s.groupSummaryPos[t.idx]?g(e,0,s.groups,0):y(b.header));if(l[Object.keys(l)[0]]=te.jgrid.stripHtml(new Array(5*t.idx).join(" ")+r),w(l,!1,!1,!0),f-1===t.idx){for(var o,a,n=s.groups[e+1],r=t.startRow,d=void 0!==n?n.startRow:s.groups[e].startRow+s.groups[e].cnt,i=r;i<d&&p[+i];i++)w(p[+i],!1);if("header"!==s.groupSummaryPos[t.idx]){if(void 0!==n){for(a=0;a<s.groupField.length&&n.dataIndex!==s.groupField[a];a++);u=s.groupField.length-a}for(o=0;o<u;o++)x[o]&&(l=g(e,o,s.groups,0),w(l,!1,!1,!0));u=a}}})}te.jgrid.isFunction(ee.loadIndicator)?ee.loadIndicator.call(I,"show"):ee.loadIndicator&&te(I).jqGrid("progressBar",{method:"show",loadtype:I.p.loadui,htmlcontent:te.jgrid.getRegional(I,"defaults.loadtext")}),te("sheets sheet",r.xl["workbook.xml"]).attr("name",ee.sheetName);var i,p,s,m,f,c,u=0,g=[],C={};if(ee.includeGroupHeader&&te(I).jqGrid("isGroupHeaderOn"))for(i=I.p.groupHeader,s=0;s<i.length;s++){var _,B,T,S,k=i[s].groupHeaders,R=i[s].useColSpanStyle&&1===i.length,z=[],X=[],$=[];if(u++,R)for(_=0;_<k.length;_++)for(p=k[_].startColumnName,B=k[_].numberOfColumns,S=T=te.jgrid.getElemByAttrVal(F,"name",p,!0);S<T+k[_].numberOfColumns;S++)$[F[S].name]=p,-1!==(m=b.header.indexOf(F[S].name))&&z.push(m);for(a=0;a<b.header.length;a++){for(C[p=b.header[a]]=R?b.labels[a]:"",c=f=-1,_=0;_<k.length;_++)if(k[_].startColumnName===p){for(X.push(p),C[p]=k[_].titleText,B=k[_].numberOfColumns,S=T=te.jgrid.getElemByAttrVal(F,"name",p,!0);S<T+k[_].numberOfColumns;S++)!0===F[S].hidden&&B--;f=te.jgrid.excelCellPos(a)+u,c=te.jgrid.excelCellPos(a+B-1)+u,g.push({ref:f+":"+c})}-1===f&&-1===c&&R&&-1===z.indexOf(a)&&(f=te.jgrid.excelCellPos(a)+u,c=te.jgrid.excelCellPos(a)+(u+1),g.push({ref:f+":"+c}))}if(X.length<k.length)for(_=0;_<b.hidden.length;_++){var N=te.jgrid.inColumnHeader(b.hidden[_],k);if(0<=N)for(var A in p=b.hidden[_],$)if($[A]===p&&C[A]){for(C[A]=k[N].titleText,m=b.header.indexOf(A),B=k[N].numberOfColumns,S=T=te.jgrid.getElemByAttrVal(F,"name",p,!0);S<T+k[N].numberOfColumns;S++)!0===F[S].hidden&&B--;f=te.jgrid.excelCellPos(m)+u,c=te.jgrid.excelCellPos(m+B-1)+u,g.push({ref:f+":"+c});break}}w(C,!0,!0)}if(ee.includeLabels)if(I.p.colSpanHeader.length){for(u++,i=I.p.colSpanHeader,C={},a=0;a<b.header.length;a++)for(C[p=b.header[a]]=b.labels[a],s=0;s<i.length;s++)(k=i[s]).startColumnName===p&&(C[p]=k.titleText,f=te.jgrid.excelCellPos(a)+u,c=te.jgrid.excelCellPos(a+k.numberOfColumns-1)+u,g.push({ref:f+":"+c}));w(C,!0,!0)}else w(b.header,!0,!0);if((g=b.mergecell.length?g.concat(b.mergecell):g).length){var U=te.jgrid.makeNode(h,"mergeCells",{attr:{count:g.length}});for(te("worksheet",h).append(U),o=0;o<g.length;o++)U.appendChild(te.jgrid.makeNode(h,"mergeCell",{attr:g[o]}))}if(ee.includeHeader||I.p.headerrow)for(var D,Z=te(I).jqGrid("headerData","getlength"),W=0;W<Z;W++){for(o in D=te(I).jqGrid("headerData","get",null,!1,W,!1))D.hasOwnProperty(o)&&(D[o]=te.jgrid.stripHtml(D[o]));te.isEmptyObject(D)||(w(D,!0),te("row",h).last().find("c").attr("s","2"))}if(I.p.grouping){var J=!!I.p.groupingView._locgr;I.p.groupingView._locgr=!1,V(b.body),I.p.groupingView._locgr=J}else for(var H=0,K=b.body.length;H<K;H++)w(b.body[H],!1);if((ee.includeFooter||I.p.footerrow)&&!te.isEmptyObject(b.footer))if(Array.isArray(b.footer))for(H=0;H<b.footer.length;H++)w(b.footer[H],!0),te("row",h).last().find("c").attr("s","2");else w(b.footer,!0),te("row",h).last().find("c").attr("s","2");var Q=te.jgrid.makeNode(h,"cols");for(te("worksheet",h).prepend(Q),o=0,n=b.width.length;o<n;o++)Q.appendChild(te.jgrid.makeNode(h,"col",{attr:{min:o+1,max:o+1,width:b.width[o],customWidth:1}}));te.jgrid.isFunction(ee.onBeforeExport)&&ee.onBeforeExport.call(I,r,y),b=null;try{var q=new JSZip,Y={type:"blob",mimeType:ee.mimetype};te.jgrid.xmlToZip(q,r),q.generateAsync?q.generateAsync(Y).then(function(e){te.jgrid.saveAs(e,ee.fileName,{type:ee.mimetype})}):te.jgrid.saveAs(q.generate(Y),ee.fileName,{type:ee.mimetype})}catch(e){throw e}finally{te.jgrid.isFunction(ee.loadIndicator)?ee.loadIndicator.call(I,"hide"):ee.loadIndicator&&te(I).jqGrid("progressBar",{method:"hide",loadtype:I.p.loadui})}})},exportToPdf:function(k){return k=te.extend(!0,{title:null,orientation:"portrait",pageSize:"A4",description:null,onBeforeExport:null,download:"download",includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,includeHeader:!0,fileName:"jqGridExport.pdf",mimetype:"application/pdf",treeindent:"-",visibleTreeNodes:!1,centerTableOnPage:!1,loadIndicator:!0,applyDefFmt:!0,applyCustFmt:!0},k||{}),this.each(function(){var e,t,r,b=this,v=[],l=b.p.colModel,d={},i=b.p.treeGrid?te(b).jqGrid("getRowData",null,!0,k.treeindent,k.visibleTreeNodes):b.addLocalData(!0),j=[],w=0,C=[],o=[],a=[],_={};function n(p){var s=b.p.groupingView,m=[],f=s.groupField.length,c=b.p.colModel,u=c.length,g=0;function y(e,t,r){var l,o=0,a=[];void 0===r&&(r=!1);for(var n=0;n<j.length;n++)l=e[j[n]],d={text:t&&!(0===n&&r)?te.jgrid.formatCell(l+"",C[o],i[w],c[C[o]],b,"pdf",k.applyDefFmt,k.applyCustFmt):l,alignment:_[n],style:"tableBody"},a.push(d),o++;return a}function h(e,t,r,l){for(var o,a,n=((e,t,r)=>{var l,o=!1;if(0===t)o=r[e];else{var a=r[e].idx;if(0===a)o=r[e];else for(l=e;0<=l;l--)if(r[l].idx===a-t){o=r[l];break}}return o})(e,t,r),d=n.cnt,i=x(j),p=l;p<u;p++)c[p]._expcol&&(a="{0}",te.each(n.summary,function(){if(this.nm===c[p].name){c[p].summaryTpl&&(a=c[p].summaryTpl),o=this.v,"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?o=this.v/this.vd:this.v&&0<d&&(o=this.v/d));try{this.groupCount=n.cnt,this.groupIndex=n.dataIndex,this.groupValue=n.value}catch(e){o=this.v}return i[this.nm]=te.jgrid.stripHtml(te.jgrid.template(a,o)),!1}}));return i}function x(e){for(var t={},r=0;r<e.length;r++)t[e[r]]="";return t}te.each(c,function(e,t){for(var r=0;r<f;r++)if(s.groupField[r]===t.name){m[r]=e;break}});var I,F=te.makeArray(s.groupSummary);if(F.reverse(),"local"===b.p.datatype&&!b.p.loadonce){te(b).jqGrid("groupingSetup");for(var e=te.jgrid.getMethod("groupingPrepare"),t=0;t<i.length;t++)e.call(te(b),i[t],t)}te.each(s.groups,function(e,t){g++;try{I=Array.isArray(s.formatDisplayField)&&te.jgrid.isFunction(s.formatDisplayField[t.idx])?s.formatDisplayField[t.idx].call(b,t.displayValue,t.value,b.p.colModel[m[t.idx]],t.idx,s):b.formatter("",t.displayValue,m[t.idx],t.value)}catch(e){I=t.displayValue}var r="",l=("string"!=typeof(r=te.jgrid.isFunction(s.groupText[t.idx])?s.groupText[t.idx].call(b,I,t.cnt,t.summary):te.jgrid.template(s.groupText[t.idx],I,t.cnt,t.summary))&&"number"!=typeof r&&(r=I),"header"===s.groupSummaryPos[t.idx]?h(e,0,s.groups,0):x(j));if(l[Object.keys(l)[0]]=te.jgrid.stripHtml(new Array(5*t.idx).join(" ")+r),v.push(y(l,!0,!0)),f-1===t.idx){for(var o,a,n=s.groups[e+1],r=t.startRow,d=void 0!==n?n.startRow:s.groups[e].startRow+s.groups[e].cnt,i=r;i<d&&p[+i];i++)v.push(y(p[+i],!0));if("header"!==s.groupSummaryPos[t.idx]){if(void 0!==n){for(a=0;a<s.groupField.length&&n.dataIndex!==s.groupField[a];a++);g=s.groupField.length-a}for(o=0;o<g;o++)F[o]&&(l=h(e,o,s.groups,0),v.push(y(l,!0,!0)));g=a}}})}for(te.jgrid.isFunction(k.loadIndicator)?k.loadIndicator.call(b,"show"):k.loadIndicator&&te(b).jqGrid("progressBar",{method:"show",loadtype:b.p.loadui,htmlcontent:te.jgrid.getRegional(b,"defaults.loadtext")}),e=0,B=l.length;e<B;e++)l[e]._expcol=!0,void 0===l[e].exportcol?l[e].hidden&&(l[e]._expcol=!1):l[e]._expcol=l[e].exportcol,!te.jgrid.isServiceCol(l[e].name)&&l[e]._expcol&&(d={text:b.p.colNames[e],style:"tableHeader"},o.push(d),j[w]=l[e].name,C[w]=e,a.push(l[e].width),_[l[e].name]=l[e].align||"left",w++);if(k.includeGroupHeader&&te(b).jqGrid("isGroupHeaderOn"))for(r=b.p.groupHeader,w=0;w<r.length;w++){for(var p=[],s=r[w].groupHeaders,m=r[w].useColSpanStyle,f=0;f<l.length;f++){var c=!0;for(te.jgrid.isServiceCol(l[f].name)||!l[f]._expcol?c=!1:d=m?{text:b.p.colNames[f],style:"tableHeader",rowSpan:2,verticalAlign:"center"}:{text:"",style:"tableHeader"},t=0;t<s.length;t++)if(s[t].startColumnName===l[f].name){for(var u=s[t].numberOfColumns,g=f;g<f+s[t].numberOfColumns;g++)!0===l[g].hidden&&u--;!(d={text:s[t].titleText,colSpan:u,style:"tableHeader"})===c&&0<u&&(c=!0,f+=s[t].numberOfColumns-u)}c&&p.push(d)}v.push(p)}if(k.includeLabels)if(b.p.colSpanHeader.length){for(r=b.p.colSpanHeader,p=[],f=0;f<j.length;f++){for(d={text:b.p.colNames[f],style:"tableHeader",verticalAlign:"center"},t=0;t<r.length;t++)r[t].startColumnName===j[f]&&(d={text:r[t].titleText,colSpan:r[t].numberOfColumns,style:"tableHeader"});p.push(d),e++}v.push(p)}else v.push(o);if(k.includeHeader&&b.p.headerrow)for(var y,h=te(b).jqGrid("headerData","getlength"),x=0;x<h;x++){for(y=te(b).jqGrid("headerData","get",null,!1,x,!1),o=[],f=0;f<j.length;f++)d={text:te.jgrid.stripHtml(te.jgrid.getAccessor(y,j[f])),style:"tableFooter",alignment:_[j[f]]},o.push(d);v.push(o)}if(b.p.grouping){var I=!!b.p.groupingView._locgr;b.p.groupingView._locgr=!1,n(i),b.p.groupingView._locgr=I}else for(var F,w=0,B=i.length;w<B;w++){for(o=[],F=i[w],f=t=0;f<j.length;f++)d={text:te.jgrid.stripHtml(te.jgrid.formatCell(te.jgrid.getAccessor(F,j[f])+"",C[t],i[w],l[C[t]],b,"pdf",k.applyDefFmt,k.applyCustFmt)),alignment:_[j[f]],style:"tableBody"},o.push(d),t++;v.push(o)}if(k.includeFooter&&b.p.footerrow)for(h=te(b).jqGrid("footerData","getlength"),x=0;x<h;x++){var T=te(b).jqGrid("footerData","get",null,!1,x,!1),o=[];for(f=0;f<j.length;f++)d={text:te.jgrid.stripHtml(te.jgrid.getAccessor(T,j[f])),style:"tableFooter",alignment:_[j[f]]},o.push(d);v.push(o)}I={style:"tableExample",widths:a,table:{headerRows:null!=r?0:1,body:v}},k.centerTableOnPage&&(I={columns:[{width:"*",text:""},{style:"tableExample",width:"auto",widths:a,table:{headerRows:null!=r?0:1,body:v},alignment:"center"},{width:"*",text:""}]}),I={pageSize:k.pageSize,pageOrientation:k.orientation,content:[I],styles:{tableHeader:{bold:!0,fontSize:11,color:"#2e6e9e",fillColor:"#dfeffc",alignment:"center"},tableBody:{fontSize:10},tableFooter:{bold:!0,fontSize:11,color:"#2e6e9e",fillColor:"#dfeffc"},title:{alignment:"center",fontSize:15},description:{}},defaultStyle:{fontSize:10}};k.description&&I.content.unshift({text:k.description,style:"description",margin:[0,0,0,12]}),k.title&&I.content.unshift({text:k.title,style:"title",margin:[0,0,0,12]}),te.jgrid.isFunction(k.onBeforeExport)&&k.onBeforeExport.call(b,I);try{var S=pdfMake.createPdf(I);S.getDataUrl(function(e){te.jgrid.isFunction(k.loadIndicator)?k.loadIndicator.call(b,"hide"):k.loadIndicator&&te(b).jqGrid("progressBar",{method:"hide",loadtype:b.p.loadui})}),"open"===k.download?S.open():S.getBuffer(function(e){te.jgrid.saveAs(e,k.fileName,{type:k.mimetype})})}catch(e){throw e}})},exportToHtml:function(c){var u;return c=te.extend(!0,{title:"",onBeforeExport:null,includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,includeHeader:!0,tableClass:"jqgridprint",autoPrint:!1,topText:"",bottomText:"",returnAsString:!1,treeindent:"&nbsp;",visibleTreeNodes:!1,loadIndicator:!0,applyDefFmt:!0,applyCustFmt:!0},c||{}),this.each(function(){for(var b=this,v=b.p.colModel,e=0,j={body:b.p.treeGrid?te(b).jqGrid("getRowData",null,!0,c.treeindent,c.visibleTreeNodes):b.addLocalData(!0),header:[],footer:[],width:[],map:[],align:[]},t=0,r=v.length;t<r;t++)v[t]._expcol=!0,void 0===v[t].exportcol?v[t].hidden&&(v[t]._expcol=!1):v[t]._expcol=v[t].exportcol,"cb"!==v[t].name&&"rn"!==v[t].name&&"subgrid"!==v[t].name&&"sc"!==v[t].name&&v[t]._expcol&&(j.header[e]=v[t].name,j.width[e]=v[t].width,j.map[e]=t,j.align[e]=v[t].align||"left",e++);var l=document.createElement("a"),o=function(e){l.href=e;e=l.host;return-1===e.indexOf("/")&&0!==l.pathname.indexOf("/")&&(e+="/"),l.protocol+"//"+e+l.pathname+l.search},w=function(e,t,r,l,o){for(var a,n,d="<tr>",i=0,p=j.header.length;i<p&&(n=o?' colspan= "'+j.header.length+'" style=text-align:left':!0===l?" style=width:"+j.width[i]+"px;text-align:"+j.align[i]+";":" style=text-align:"+j.align[i]+";",a=j.header[i],e.hasOwnProperty(a)&&(d+="<"+t+n+">"+(r?te.jgrid.formatCell(te.jgrid.getAccessor(e,a),j.map[i],e,v[j.map[i]],b,"html",c.applyDefFmt,c.applyCustFmt):e[a])+"</"+t+">"),!o);i++);return d+"</tr>"};function a(m){var f=b.p.groupingView,c=[],u=f.groupField.length,s=v.length,g=0,y="";function h(e,t,r,l){for(var o,a,n=((e,t,r)=>{var l,o=!1;if(0===t)o=r[e];else{var a=r[e].idx;if(0===a)o=r[e];else for(l=e;0<=l;l--)if(r[l].idx===a-t){o=r[l];break}}return o})(e,t,r),d=n.cnt,i=x(j.header),p=l;p<s;p++)v[p]._expcol&&(a="{0}",te.each(n.summary,function(){if(this.nm===v[p].name){v[p].summaryTpl&&(a=v[p].summaryTpl),o=this.v,"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?o=this.v/this.vd:this.v&&0<d&&(o=this.v/d));try{this.groupCount=n.cnt,this.groupIndex=n.dataIndex,this.groupValue=n.value}catch(e){o=this.v}return i[this.nm]=te.jgrid.stripHtml(te.jgrid.template(a,o)),!1}}));return i}function x(e){for(var t={},r=0;r<e.length;r++)t[e[r]]="";return t}te.each(v,function(e,t){for(var r=0;r<u;r++)if(f.groupField[r]===t.name){c[r]=e;break}});var I,F=te.makeArray(f.groupSummary);if(F.reverse(),"local"===b.p.datatype&&!b.p.loadonce){te(b).jqGrid("groupingSetup");for(var e=te.jgrid.getMethod("groupingPrepare"),t=0;t<j.body.length;t++)e.call(te(b),j.body[t],t)}return te.each(f.groups,function(e,t){g++;try{I=Array.isArray(f.formatDisplayField)&&te.jgrid.isFunction(f.formatDisplayField[t.idx])?f.formatDisplayField[t.idx].call(b,t.displayValue,t.value,b.p.colModel[c[t.idx]],t.idx,f):b.formatter("",t.displayValue,c[t.idx],t.value)}catch(e){I=t.displayValue}var r="";"string"!=typeof(r=te.jgrid.isFunction(f.groupText[t.idx])?f.groupText[t.idx].call(b,I,t.cnt,t.summary):te.jgrid.template(f.groupText[t.idx],I,t.cnt,t.summary))&&"number"!=typeof r&&(r=I);var l,o=!1,a=("header"===f.groupSummaryPos[t.idx]?l=h(e,0,f.groups,0):(l=x(j.header),o=!0),Object.keys(l));if(l[a[0]]=new Array(5*t.idx).join(" ")+r,y+=w(l,"td",!0,1===g,o),u-1===t.idx){for(var n,d,i=f.groups[e+1],a=t.startRow,p=void 0!==i?i.startRow:f.groups[e].startRow+f.groups[e].cnt,s=a;s<p&&m[+s];s++)y+=w(m[+s],"td",!0);if("header"!==f.groupSummaryPos[t.idx]){if(void 0!==i){for(d=0;d<f.groupField.length&&i.dataIndex!==f.groupField[d];d++);g=f.groupField.length-d}for(n=0;n<g;n++)F[n]&&(l=h(e,n,f.groups,0),y+=w(l,"td",!0));g=d}}}),y}te.jgrid.isFunction(c.loadIndicator)?c.loadIndicator.call(b,"show"):c.loadIndicator&&te(b).jqGrid("progressBar",{method:"show",loadtype:b.p.loadui,htmlcontent:te.jgrid.getRegional(b,"defaults.loadtext")});var n='<table class="'+c.tableClass+'">';if(c.includeLabels&&(n+="<thead>"+((e,t,r)=>{for(var l="<tr>",o=0,a=e.length;o<a;o++)l+="<"+t+(!0===r?" style=width:"+j.width[o]+"px;":"")+">"+b.p.colNames[j.map[o]]+"</"+t+">";return l+"</tr>"})(j.header,"th",!0)+"</thead>"),n+="<tbody>",c.includeHeader&&b.p.headerrow)for(var d,i=te(b).jqGrid("footerData","getlength"),p=0;p<i;p++)for(p=0;p<i;p++)d=te(b).jqGrid("headerData","get",null,!1,p,!1),n+=w(d,"td",!1);if(b.p.grouping){var s=!!b.p.groupingView._locgr;b.p.groupingView._locgr=!1,n+=a(j.body),b.p.groupingView._locgr=s}else for(e=0,r=j.body.length;e<r;e++)n+=w(j.body[e],"td",!0,0===e);if(c.includeFooter&&b.p.footerrow)for(i=te(b).jqGrid("footerData","getlength"),p=0;p<i;p++)j.footer[p]=te(b).jqGrid("footerData","get",null,!1,p,!1),n+=w(j.footer[p],"td",!1);if(n=n+"</tbody>"+"</table>",c.returnAsString)u=n;else{var m=window.open("",""),f=(m.document.close(),c.title?"<title>"+c.title+"</title>":"");te("style, link").each(function(){f+=(e=>("link"===(e=te(e).clone()[0]).nodeName.toLowerCase()&&(e.href=o(e.href)),e.outerHTML))(this)});try{m.document.head.innerHTML=f}catch(e){te(m.document.head).html(f)}m.document.body.innerHTML=(c.title?"<h1>"+c.title+"</h1>":"")+"<div>"+(c.topText||"")+"</div>"+n+"<div>"+(c.bottomText||"")+"</div>",te(m.document.body).addClass("html-view"),te("img",m.document.body).each(function(e,t){t.setAttribute("src",o(t.getAttribute("src")))}),te.jgrid.isFunction(c.onBeforeExport)&&c.onBeforeExport.call(b,m),Boolean(m.chrome)?c.autoPrint&&(m.print(),m.close()):setTimeout(function(){c.autoPrint&&(m.print(),m.close())},1e3)}te.jgrid.isFunction(c.loadIndicator)?c.loadIndicator.call(b,"hide"):c.loadIndicator&&te(b).jqGrid("progressBar",{method:"hide",loadtype:b.p.loadui})}),u}})});