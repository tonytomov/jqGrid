(function(b){"function"===typeof define&&define.amd?define("jquery ./grid.base jquery-ui/dialog jquery-ui/draggable jquery-ui/droppable jquery-ui/resizable jquery-ui/sortable".split(" "),b):"object"===typeof exports?b(require("jquery")):b(jQuery)})(function(b){var l=b.jgrid,t=l.jqID,k=null!=b.ui?b.ui.multiselect:null;l.msie&&8===l.msiever()&&(b.expr[":"].hidden=function(b){return 0===b.offsetWidth||0===b.offsetHeight||"none"===b.style.display});l._multiselect=!1;if(k){if(k.prototype._setSelected){var B=
k.prototype._setSelected;k.prototype._setSelected=function(a,g){var e=this,d=B.call(e,a,g);if(g&&e.selectedList){var f=e.element;e.selectedList.find("li").each(function(){b(e).data("optionLink")&&b(e).data("optionLink").remove().appendTo(f)})}return d}}k.prototype.destroy&&(k.prototype.destroy=function(){this.element.show();this.container.remove();void 0===b.Widget?b.widget.prototype.destroy.apply(this,arguments):b.Widget.prototype.destroy.apply(this,arguments)});l._multiselect=!0}l.extend({sortableColumns:function(a){return this.each(function(){function g(){d.disableClick=
!0}var e=this,d=e.p,f=t(d.id),f={tolerance:"pointer",axis:"x",scrollSensitivity:"1",items:">th:not(:has(#jqgh_"+f+"_cb,#jqgh_"+f+"_rn,#jqgh_"+f+"_subgrid),:hidden)",placeholder:{element:function(a){return b(document.createElement(a[0].nodeName)).addClass(a[0].className+" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0]},update:function(b,a){a.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||
0,10));a.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10))}},update:function(a,h){var c=b(">th",b(h.item).parent()),f=d.id+"_",g=[];c.each(function(){var a=b(">div",this).get(0).id.replace(/^jqgh_/,"").replace(f,""),a=d.iColByName[a];void 0!==a&&g.push(a)});b(e).jqGrid("remapColumns",g,!0,!0);b.isFunction(d.sortable.update)&&d.sortable.update(g);setTimeout(function(){d.disableClick=!1},50)}};d.sortable.options?b.extend(f,
d.sortable.options):b.isFunction(d.sortable)&&(d.sortable={update:d.sortable});if(f.start){var h=f.start;f.start=function(b,a){g();h.call(this,b,a)}}else f.start=g;d.sortable.exclude&&(f.items+=":not("+d.sortable.exclude+")");f=a.sortable(f);f=f.data("sortable")||f.data("uiSortable")||f.data("ui-sortable");null!=f&&(f.floating=!0)})},columnChooser:function(a){function g(a,c){a&&("string"===typeof a?b.fn[a]&&b.fn[a].apply(c,b.makeArray(arguments).slice(2)):b.isFunction(a)&&a.apply(c,b.makeArray(arguments).slice(2)))}
var e=this,d=e[0].p,f,h,u={},y=[],c,p,n=d.colModel;c=n.length;p=d.colNames;var z=function(b){return k&&k.prototype&&b.data(k.prototype.widgetFullName||k.prototype.widgetName)||b.data("ui-multiselect")||b.data("multiselect")};if(!b("#colchooser_"+t(d.id)).length){f=b('<div id="colchooser_'+d.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>');h=b("select",f);a=b.extend({width:400,height:240,classname:null,done:function(b){b&&null==d.groupHeader&&
e.jqGrid("remapColumns",b,!0)},msel:"multiselect",dlog:"dialog",dialog_opts:{minWidth:470,dialogClass:"ui-jqdialog"},dlog_opts:function(a){var c={};c[a.bSubmit]=function(){a.apply_perm();a.cleanup(!1)};c[a.bCancel]=function(){a.cleanup(!0)};return b.extend(!0,{buttons:c,close:function(){a.cleanup(!0)},modal:a.modal||!1,resizable:a.resizable||!0,width:a.width+70,resize:function(){var b=z(h),a=b.container.closest(".ui-dialog-content");0<a.length&&"object"===typeof a[0].style?a[0].style.width="":a.css("width",
"");b.selectedList.height(Math.max(b.selectedContainer.height()-b.selectedActions.outerHeight()-1,1));b.availableList.height(Math.max(b.availableContainer.height()-b.availableActions.outerHeight()-1,1))}},a.dialog_opts||{})},apply_perm:function(){var c=[];b("option",h).each(function(){b(this).is(":selected")?e.jqGrid("showCol",n[this.value].name):e.jqGrid("hideCol",n[this.value].name)});b("option",h).filter(":selected").each(function(){c.push(parseInt(this.value,10))});b.each(c,function(){delete u[n[parseInt(this,
10)].name]});b.each(u,function(){var b=parseInt(this,10);var a=c,h=b,e,d;0<=h?(e=a.slice(),d=e.splice(h,Math.max(a.length-h,h)),h>a.length&&(h=a.length),e[h]=b,c=e.concat(d)):c=a});a.done&&a.done.call(e,c);e.jqGrid("setGridWidth",d.autowidth||void 0!==d.widthOrg&&"auto"!==d.widthOrg&&"100%"!==d.widthOrg?d.width:d.tblwidth,d.shrinkToFit)},cleanup:function(b){g(a.dlog,f,"destroy");g(a.msel,h,"destroy");f.remove();b&&a.done&&a.done.call(e)},msel_opts:{}},e.jqGrid("getGridRes","col"),l.col,a||{});if(b.ui&&
k&&k.defaults){if(!l._multiselect){alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");return}a.msel_opts=b.extend(k.defaults,a.msel_opts)}a.caption&&f.attr("title",a.caption);a.classname&&(f.addClass(a.classname),h.addClass(a.classname));a.width&&(b(">div",f).css({width:a.width,margin:"0 auto"}),h.css("width",a.width));a.height&&(b(">div",f).css("height",a.height),h.css("height",a.height-10));h.empty();var x=d.groupHeader,r={},q,v,A,m,w;if(null!=x&&null!=x.groupHeaders)for(q=
0,A=x.groupHeaders.length;q<A;q++)for(w=x.groupHeaders[q],v=0;v<w.numberOfColumns;v++)m=d.iColByName[w.startColumnName]+v,r[m]=b.isFunction(a.buildItemText)?a.buildItemText.call(e[0],{iCol:m,cm:n[m],cmName:n[m].name,colName:p[m],groupTitleText:w.titleText}):b.jgrid.stripHtml(w.titleText)+": "+b.jgrid.stripHtml(""===p[m]?n[m].name:p[m]);for(m=0;m<c;m++)void 0===r[m]&&(r[m]=b.isFunction(a.buildItemText)?a.buildItemText.call(e[0],{iCol:m,cm:n[m],cmName:n[m].name,colName:p[m],groupTitleText:null}):b.jgrid.stripHtml(p[m]));
b.each(n,function(b){u[this.name]=b;this.hidedlg?this.hidden||y.push(b):h.append("<option value='"+b+"'"+(d.headertitles||this.headerTitle?" title='"+l.stripHtml("string"===typeof this.headerTitle?this.headerTitle:r[b])+"'":"")+(this.hidden?"":" selected='selected'")+">"+r[b]+"</option>")});c=b.isFunction(a.dlog_opts)?a.dlog_opts.call(e,a):a.dlog_opts;g(a.dlog,f,c);c=b.isFunction(a.msel_opts)?a.msel_opts.call(e,a):a.msel_opts;g(a.msel,h,c);c=b("#colchooser_"+t(d.id));c.css({margin:"auto"});c.find(">div").css({width:"100%",
height:"100%",margin:"auto"});if(c=z(h))c.container.css({width:"100%",height:"100%",margin:"auto"}),c.selectedContainer.css({width:100*c.options.dividerLocation+"%",height:"100%",margin:"auto",boxSizing:"border-box"}),c.availableContainer.css({width:100-100*c.options.dividerLocation+"%",height:"100%",margin:"auto",boxSizing:"border-box"}),c.selectedList.css("height","auto"),c.availableList.css("height","auto"),p=Math.max(c.selectedList.height(),c.availableList.height()),p=Math.min(p,b(window).height()),
c.selectedList.css("height",p),c.availableList.css("height",p)}},sortableRows:function(a){return this.each(function(){var g=this,e=g.grid,d=g.p;e&&!d.treeGrid&&b.fn.sortable&&(a=b.extend({cursor:"move",axis:"y",items:">.jqgrow"},a||{}),a.start&&b.isFunction(a.start)?(a._start_=a.start,delete a.start):a._start_=!1,a.update&&b.isFunction(a.update)?(a._update_=a.update,delete a.update):a._update_=!1,a.start=function(f,h){b(h.item).css("border-width","0");b("td",h.item).each(function(b){this.style.width=
e.cols[b].style.width});if(d.subGrid){var u=b(h.item).attr("id");try{b(g).jqGrid("collapseSubGridRow",u)}catch(y){}}a._start_&&a._start_.apply(this,[f,h])},a.update=function(e,h){b(h.item).css("border-width","");!0===d.rownumbers&&b("td.jqgrid-rownum",g.rows).each(function(a){b(this).html(a+1+(parseInt(d.page,10)-1)*parseInt(d.rowNum,10))});a._update_&&a._update_.apply(this,[e,h])},b(g.tBodies[0]).sortable(a),b.isFunction(b.fn.disableSelection)&&b(g.tBodies[0]).children("tr.jqgrow").disableSelection())})},
gridDnD:function(a){return this.each(function(){function g(){var a=b.data(e,"dnd");b("tr.jqgrow:not(.ui-draggable)",e).draggable(b.isFunction(a.drag)?a.drag.call(b(e),a):a.drag)}var e=this,d,f;if(e.grid&&!e.p.treeGrid&&b.fn.draggable&&b.fn.droppable)if(void 0===b("#jqgrid_dnd")[0]&&b("body").append("<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>"),"string"===typeof a&&"updateDnD"===a&&!0===e.p.jqgdnd)g();else if(a=b.extend({drag:function(a){return b.extend({start:function(d,f){var c;if(e.p.subGrid){c=
b(f.helper).attr("id");try{b(e).jqGrid("collapseSubGridRow",c)}catch(g){}}for(c=0;c<b.data(e,"dnd").connectWith.length;c++)0===b(b.data(e,"dnd").connectWith[c]).jqGrid("getGridParam","reccount")&&b(b.data(e,"dnd").connectWith[c]).jqGrid("addRowData","jqg_empty_row",{});f.helper.addClass("ui-state-highlight");b("td",f.helper).each(function(b){this.style.width=e.grid.headers[b].width+"px"});a.onstart&&b.isFunction(a.onstart)&&a.onstart.call(b(e),d,f)},stop:function(d,f){var c;f.helper.dropped&&!a.dragcopy&&
(c=b(f.helper).attr("id"),void 0===c&&(c=b(this).attr("id")),b(e).jqGrid("delRowData",c));for(c=0;c<b.data(e,"dnd").connectWith.length;c++)b(b.data(e,"dnd").connectWith[c]).jqGrid("delRowData","jqg_empty_row");a.onstop&&b.isFunction(a.onstop)&&a.onstop.call(b(e),d,f)}},a.drag_opts||{})},drop:function(a){return b.extend({accept:function(a){if(!b(a).hasClass("jqgrow"))return a;a=b(a).closest("table.ui-jqgrid-btable");return 0<a.length&&void 0!==b.data(a[0],"dnd")?(a=b.data(a[0],"dnd").connectWith,-1!==
b.inArray("#"+t(this.id),a)?!0:!1):!1},drop:function(d,f){if(b(f.draggable).hasClass("jqgrow")){var c=b(f.draggable).attr("id"),c=f.draggable.parent().parent().jqGrid("getRowData",c);if(!a.dropbyname){var g=0,n={},k,l,r=b("#"+t(this.id)).jqGrid("getGridParam","colModel");try{for(l in c)c.hasOwnProperty(l)&&(k=r[g].name,"cb"!==k&&"rn"!==k&&"subgrid"!==k&&c.hasOwnProperty(l)&&r[g]&&(n[k]=c[l]),g++);c=n}catch(v){}}f.helper.dropped=!0;a.beforedrop&&b.isFunction(a.beforedrop)&&(k=a.beforedrop.call(this,
d,f,c,b("#"+t(e.p.id)),b(this)),void 0!==k&&null!==k&&"object"===typeof k&&(c=k));if(f.helper.dropped){var q;a.autoid&&(b.isFunction(a.autoid)?q=a.autoid.call(this,c):(q=Math.ceil(1E3*Math.random()),q=a.autoidprefix+q));b("#"+t(this.id)).jqGrid("addRowData",q,c,a.droppos);c[e.p.localReader.id]=q}a.ondrop&&b.isFunction(a.ondrop)&&a.ondrop.call(this,d,f,c)}}},a.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{},drag_opts:{revert:"invalid",helper:"clone",cursor:"move",
appendTo:"#jqgrid_dnd",zIndex:5E3},dragcopy:!1,dropbyname:!1,droppos:"first",autoid:!0,autoidprefix:"dnd_"},a||{}),a.connectWith)for(a.connectWith=a.connectWith.split(","),a.connectWith=b.map(a.connectWith,function(a){return b.trim(a)}),b.data(e,"dnd",a),0===e.p.reccount||e.p.jqgdnd||g(),e.p.jqgdnd=!0,d=0;d<a.connectWith.length;d++)f=a.connectWith[d],b(f).droppable(b.isFunction(a.drop)?a.drop.call(b(e),a):a.drop)})},gridResize:function(a){return this.each(function(){var g=this,e=g.grid,d=g.p,f=d.gView+
">.ui-jqgrid-bdiv",h=!1,k,l=d.height;if(e&&b.fn.resizable){a=b.extend({},a||{});a.alsoResize?(a._alsoResize_=a.alsoResize,delete a.alsoResize):a._alsoResize_=!1;a.stop&&b.isFunction(a.stop)?(a._stop_=a.stop,delete a.stop):a._stop_=!1;a.stop=function(c,n){b(g).jqGrid("setGridWidth",n.size.width,a.shrinkToFit);b(d.gView+">.ui-jqgrid-titlebar").css("width","");h?(b(k).each(function(){b(this).css("height","")}),"auto"!==l&&"100%"!==l||b(e.bDiv).css("height",l)):b(g).jqGrid("setGridParam",{height:b(f).height()});
g.fixScrollOffsetAndhBoxPadding&&g.fixScrollOffsetAndhBoxPadding();a._stop_&&a._stop_.call(g,c,n)};k=f;"auto"!==l&&"100%"!==l||void 0!==a.handles||(a.handles="e,w");if(a.handles){var c=b.map(String(a.handles).split(","),function(a){return b.trim(a)});2===c.length&&("e"===c[0]&&"w"===c[1]||"e"===c[1]&&"w"===c[1])&&(k=d.gView+">div:not(.frozen-div)",h=!0,d.pager&&(k+=","+d.pager))}a.alsoResize=a._alsoResize_?k+","+a._alsoResize_:k;delete a._alsoResize_;b(d.gBox).resizable(a)}})}})});
/*
//# sourceMappingURL=grid.jqueryui.map
*/